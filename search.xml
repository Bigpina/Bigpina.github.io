<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SolidWorks操作技巧</title>
      <link href="/posts/a38fa471.html"/>
      <url>/posts/a38fa471.html</url>
      
        <content type="html"><![CDATA[<h4 id="命令1"><a href="#命令1" class="headerlink" title="命令1"></a>命令1</h4><p>插入 →  特征 →  移动&#x2F;复制</p><p>说明：使用该命令可快速创建相同镜像或旋转阵列特征，并应用到其他位置。</p><h4 id="命令2"><a href="#命令2" class="headerlink" title="命令2"></a>命令2</h4><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 机械设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>材料的屈服、拉伸和抗弯强度</title>
      <link href="/posts/3a635be.html"/>
      <url>/posts/3a635be.html</url>
      
        <content type="html"><![CDATA[<h4 id="1-屈服强度："><a href="#1-屈服强度：" class="headerlink" title="1. 屈服强度："></a>1. <strong>屈服强度：</strong></h4><p>指材料开始发生明显塑性变形时的应力值。对于大多数金属材料，这是设计中的关键指标之一，因为一旦超过这个点，材料将不会产生弹性恢复。</p><h4 id="2-拉伸强度："><a href="#2-拉伸强度：" class="headerlink" title="2. 拉伸强度："></a>2. <strong>拉伸强度</strong>：</h4><p>也称为抗拉强度或极限强度，是材料在断裂前能承受的最大拉力对应的应力值。它反映了材料的终极承载能力。</p><h4 id="3-抗弯强度："><a href="#3-抗弯强度：" class="headerlink" title="3. 抗弯强度："></a>3. <strong>抗弯强度</strong>：</h4><p>又称弯曲强度，表示材料在受弯曲载荷时抵抗破坏的能力。这与材料的韧性有关，通常通过三点或四点弯曲试验来测定。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 机械设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机械设计经验</title>
      <link href="/posts/a9c1ab3.html"/>
      <url>/posts/a9c1ab3.html</url>
      
        <content type="html"><![CDATA[<p>1）画图时尽可能中心对称。如圆，方形。等<br>2）设计图纸一定要和加工联系到一起。（比如，车，铣，一定只切除不用拉伸，零件不是焊接的不用拉伸，钣金的一定用钣金命令画）<br>3）能设计成左右对称的一定设计成对称的。<br>4）所有尺寸一定固定死，不出现活动尺寸<br>5）所有孔一定用异形孔向导，只有比较大的孔才用切除的办法。所有孔一定靠尺寸定位。非关联定位。<br>6）所有关键尺寸标上公差，调整标注尺寸，为出工程图做准备。<br>7）所有配合都采用孔配合，和实际装配工况完全一致。<br>8）设计时考虑设计基准，到关键件的尺寸装配人员有测量基准。<br>9）在装配体中，设计螺丝及销子大小。修改任何一个螺丝孔，及销子马上修改对应零件，包括工程图。<br>10）边设计边进行理论计算。修改设备整体布局。身边必须有卡尺，及卷尺。随时对零件尺寸进行预估。（新人比较重要）<br>11）先设计关键结构，尽量做到小而精，预留扩展空间（很重要，优秀的设计师，就是能把将来所有可能性都预估出来，没有达到预期时有方案进行随时调整，以满足设备要求）.<br>12）关键机构出来后，进行外围设计。增添辅助功能。<br>13）然后外围框架设计。优化美观程度。<br>14）设计线槽，气管。等其他外围设计。<br>15）进行设备优化，对每个装配体进行装配体干涉检测。螺丝孔干涉检查。整体设备干涉检查。<br>16）细化工程图。快速出图。不检查是否少尺寸，只是对视图，比例，长宽高，孔的位置，进行出图。一般简单图直接用3D里面的尺寸（模型项目），之前在设计时已经考虑了如何出图。位置已经调整好，关键尺寸的公差在3D中已经标好。<br>17）细化每张工程图。1：工艺检查，加工性检查.2：材料检查，热处理，表面处理检查。3：长宽高，标注检查。孔位置检查。4：关键尺寸精度检查，表面粗糙的，位置度，垂直度检查。<br>18）交给其他工程师审图。（不能自己检查，前面自己查了一遍了，再自己查图效率太低）<br>19）出BOM 分出 加工件，标准件。（写在属性中，导出后整理一下，发给采购。）<br>20）来件装配。设计进行技术指导。<br>21）修改细化不理想的设计。<br>22）达到设计预期，交付客户。<br>23）项目关闭。 </p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 机械设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PLC程序编写问题总结</title>
      <link href="/posts/bbcbbfd9.html"/>
      <url>/posts/bbcbbfd9.html</url>
      
        <content type="html"><![CDATA[<h2 id="1-先判断，后输出"><a href="#1-先判断，后输出" class="headerlink" title="1. 先判断，后输出"></a>1. 先判断，后输出</h2><p>根据PLC扫描和执行程序的特点，在多数场景下适用，例如一键启停程序，使用中间M点进行辅助，若先输出，会发生置位的一瞬间复位的情况。</p><p><img src="http://yunrun.com.cn/upload/202410/27/202410272338054532.png" alt="使用辅助点实现一键启停程序2"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 工控 </tag>
            
            <tag> PLC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MVVM Pattern Made Simple</title>
      <link href="/posts/dfb46107.html"/>
      <url>/posts/dfb46107.html</url>
      
        <content type="html"><![CDATA[<p>原文链接</p><p>[]:<a href="https://www.codeproject.com/Articles/278901/MVVM">https://www.codeproject.com/Articles/278901/MVVM</a></p><h1 id="重要提示"><a href="#重要提示" class="headerlink" title="重要提示"></a>重要提示</h1><p>朋友们，如果你能在评论区留下几行评论，说明如何提高这篇文章，以及你希望我的文章讨论MVVM其他主题，我将不胜感激。</p><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><h1 id="MVVM概述"><a href="#MVVM概述" class="headerlink" title="MVVM概述"></a>MVVM概述</h1><p>Model是一组代表来自服务和数据库的数据的类</p><p>View是代码以对应数据可视化的方式被用户看到或交互</p><p>ViewModel是View和Model的粘合剂。它从Model中包装数据并且使数据便于展示和被View修改。ViewModel同时控制View与应用程序剩余部分的交互（包括任何其他视图）。</p><p><img src="https://www.codeproject.com/KB/WPF/MVVMMadeSimple/MVVMParts.jpg" alt="img"></p><p>ViewModel代码能（并且应该）参考Model，但是Model类（如果从ViewModel分离）不应该被ViewModel知道。View应该被ViewModel知道，但是ViewModel不应该被View知道。在上面的图中，箭头表明了MVVM部分应该被谁知道。</p><p>与传统模式类似，MVVM模式中的模型是来自于服务或数据库的普通数据。很多时候，Model能被构建成ViewModel的一部分。因此，在我们的例子中，我们将跳过模型并且优先专注于ViewModel、View和它们之间的交互。</p><h1 id="与MVVM模式相关的WPF概念"><a href="#与MVVM模式相关的WPF概念" class="headerlink" title="与MVVM模式相关的WPF概念"></a>与MVVM模式相关的WPF概念</h1><h1 id="View和ViewModel之间的通信"><a href="#View和ViewModel之间的通信" class="headerlink" title="View和ViewModel之间的通信"></a>View和ViewModel之间的通信</h1><p>由于以下几个新概念成为WPF（以及后来的Silverlight）的一部分，MVVM模式成为可能。</p><ul><li>WPF Bindings</li></ul><p><img src="F:\typora_Picture\ViewVMCommunications.jpg" alt="ViewVMCommunications"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实战：英语学习网站</title>
      <link href="/posts/bec8f9f1.html"/>
      <url>/posts/bec8f9f1.html</url>
      
        <content type="html"><![CDATA[<h1 id="10-英语学习网站"><a href="#10-英语学习网站" class="headerlink" title="10 英语学习网站"></a>10 英语学习网站</h1><h2 id="10-1-需求说明和项目演示"><a href="#10-1-需求说明和项目演示" class="headerlink" title="10.1 需求说明和项目演示"></a>10.1 需求说明和项目演示</h2><p>微服务的拆分和治理</p><p>治理：服务的注册、服务的发现</p><h3 id="10-1-1-需求说明"><a href="#10-1-1-需求说明" class="headerlink" title="10.1.1 需求说明"></a>10.1.1 需求说明</h3><p>1.听力练习</p><p>2.业务概念：类别、专辑、片段</p><p>3.听力原文字幕文件查看</p><p>4.网站后台允许资源的CRUD</p><p>5.其他格式的音频的追踪在部分浏览器上有问题，统一用M4A</p><p>6.音频文件放到单独的文件服务器上</p><p>7.原文的搜索</p><p>类库项目使用程序集需要添加</p><FrameworkReference include="Microsoft.AspNetCore.App"/><h3 id="10-1-4-环境搭建"><a href="#10-1-4-环境搭建" class="headerlink" title="10.1.4 环境搭建"></a>10.1.4 环境搭建</h3><p>nginx、Elastic Search</p><p>sslPort：https端口</p><p>在launchSetting中修改端口号（开发环境）</p><p>nginx反向代理</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在Nginx的nginx.conf文件中的server节点下添加</span><br><span class="line">location/IdentityService/&#123;</span><br><span class="line">proxy_pass http://localhost:50402/;</span><br><span class="line">将部分信息放在报文头中进行zhuan</span><br><span class="line">proxy_header Host $host;</span><br><span class="line">proxy_header X-Real-IP $remote addr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-2-文件服务的开发"><a href="#10-2-文件服务的开发" class="headerlink" title="10.2 文件服务的开发"></a>10.2 文件服务的开发</h2><h3 id="10-2-1-领域层"><a href="#10-2-1-领域层" class="headerlink" title="10.2.1 领域层"></a>10.2.1 领域层</h3><p>散列算法：相同内容计算出的散列值相同，证明是同一个内容。</p><h3 id="10-2-2-基础设施"><a href="#10-2-2-基础设施" class="headerlink" title="10.2.2 基础设施"></a>10.2.2 基础设施</h3><p>因为SQLServer对于Guid主键默认创建聚集索引，因此会造成每次插入新数据，都会数据库重排，因此我们取消主键的默认的聚集索引</p><p>网站优化万金油：缓存</p><p>数据库优化万金油：索引</p><h2 id="10-3-听力服务"><a href="#10-3-听力服务" class="headerlink" title="10.3 听力服务"></a>10.3 听力服务</h2><p>独立聚合根：实体会被其他地方引用</p><p>无论时间是否被用到，尽量publish</p><p>构建合法对象：</p><p>1.使用init</p><p>2.使用build</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Episode <span class="title">Build</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id == Guid.Empty)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(<span class="keyword">nameof</span>(id));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(name));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (albumId == Guid.Empty)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(<span class="keyword">nameof</span>(albumId));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (audioUrl == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(audioUrl));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (durationInSecond &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(<span class="keyword">nameof</span>(durationInSecond));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (subtitle == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(subtitle));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (subtitleType == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(subtitleType));</span><br><span class="line">    &#125;</span><br><span class="line">    Episode e = <span class="keyword">new</span> Episode();</span><br><span class="line">    e.Id = id;</span><br><span class="line">    e.SequenceNumber = sequenceNumber;</span><br><span class="line">    e.Name = name;</span><br><span class="line">    e.AlbumId = albumId;</span><br><span class="line">    e.AudioUrl = audioUrl;</span><br><span class="line">    e.DurationInSecond = durationInSecond;</span><br><span class="line">    e.Subtitle = subtitle;</span><br><span class="line">    e.SubtitleType = subtitleType;</span><br><span class="line">    e.IsVisible = <span class="literal">true</span>;</span><br><span class="line">    e.AddDomainEvent(<span class="keyword">new</span> EpisodeCreatedEvent(e));</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>嵌套类型</p><p>展示页面使用缓存保存数据，提高数据加载性能，memoryCache</p><h2 id="10-搜索服务"><a href="#10-搜索服务" class="headerlink" title="10. 搜索服务"></a>10. 搜索服务</h2><p>把搜索和日常数据管理分开</p><p>专门全文检索服务器：Elastic Search</p><p>封装好的Nuget包:Nest</p><p>结束语：</p><p>不同微服务应该有不同的数据库</p><p>尽量避免业务层面跨数据表的联合查询</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9 DDD实战</title>
      <link href="/posts/9df090a5.html"/>
      <url>/posts/9df090a5.html</url>
      
        <content type="html"><![CDATA[<h2 id="9-1-架构设计的术与道"><a href="#9-1-架构设计的术与道" class="headerlink" title="9.1 架构设计的术与道"></a>9.1 架构设计的术与道</h2><h2 id="9-3-DDD的技术落地"><a href="#9-3-DDD的技术落地" class="headerlink" title="9.3 DDD的技术落地"></a>9.3 DDD的技术落地</h2><h3 id="9-3-1-贫血模型和充血模型"><a href="#9-3-1-贫血模型和充血模型" class="headerlink" title="9.3.1 贫血模型和充血模型"></a>9.3.1 贫血模型和充血模型</h3><p>贫血：只有属性和成员变量。</p><p>充血：有属性、成员变量和方法。</p><h3 id="9-3-2-EF-Core对实体类属性操作的秘密"><a href="#9-3-2-EF-Core对实体类属性操作的秘密" class="headerlink" title="9.3.2 EF Core对实体类属性操作的秘密"></a>9.3.2 EF Core对实体类属性操作的秘密</h3><h3 id="9-3-3-在EF-Core中实现充血模型"><a href="#9-3-3-在EF-Core中实现充血模型" class="headerlink" title="9.3.3 在EF Core中实现充血模型"></a>9.3.3 在EF Core中实现充血模型</h3><p>需求：</p><h4 id="1-属性只读，只能被内部代码修改"><a href="#1-属性只读，只能被内部代码修改" class="headerlink" title="1.属性只读，只能被内部代码修改"></a>1.属性只读，只能被内部代码修改</h4><h4 id="2-定义了有参构造方法（要求属性名与参数名一致）"><a href="#2-定义了有参构造方法（要求属性名与参数名一致）" class="headerlink" title="2.定义了有参构造方法（要求属性名与参数名一致）"></a>2.定义了有参构造方法（要求属性名与参数名一致）</h4><h4 id="3-私有成员变量映射到数据表中的列-builder-Property-“成员变量名”"><a href="#3-私有成员变量映射到数据表中的列-builder-Property-“成员变量名”" class="headerlink" title="3.私有成员变量映射到数据表中的列[builder.Property(“成员变量名”)]"></a>3.私有成员变量映射到数据表中的列[builder.Property(“成员变量名”)]</h4><h4 id="4-只读属性，只能读取，不能修改-HadField-“成员变量名”"><a href="#4-只读属性，只能读取，不能修改-HadField-“成员变量名”" class="headerlink" title="4.只读属性，只能读取，不能修改(HadField(“成员变量名”))"></a>4.只读属性，只能读取，不能修改(HadField(“成员变量名”))</h4><h4 id="5-不映射，只在运行时使用【Ignore-】"><a href="#5-不映射，只在运行时使用【Ignore-】" class="headerlink" title="5.不映射，只在运行时使用【Ignore()】"></a>5.不映射，只在运行时使用【Ignore()】</h4><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//特征1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CreatDateTime &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment">//特征3</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? passwordHash;</span><br><span class="line"><span class="comment">//特征4，Remark返回值，无需get,set方法</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? remark;</span><br><span class="line">    <span class="comment">//特征4</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Remark</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; remark;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//特征5</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Tag &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment">//特征2，提供给EFCore使用</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">User</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//特征2，提供给业务使用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Name = name;</span><br><span class="line">        <span class="keyword">this</span>.CreatDateTime = System.DateTime.Now.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangeName</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePassword</span>(<span class="params"><span class="built_in">string</span> password</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.passwordHash = ComputeSha256Hash(password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ComputeSha256Hash</span>(<span class="params"><span class="built_in">string</span> rawData</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (SHA256 sha256Hash = SHA256.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] bytes = sha256Hash.ComputeHash(Encoding.UTF8.GetBytes(rawData));</span><br><span class="line">            StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; bytes.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                builder.Append(bytes[i].ToString(<span class="string">&quot;x2&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> builder.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-4-EF-Core中实现值对象"><a href="#9-3-4-EF-Core中实现值对象" class="headerlink" title="9.3.4 EF Core中实现值对象"></a>9.3.4 EF Core中实现值对象</h3><p>特点：值类型没有标识符</p><p>值类型 ≠ 值对象</p><p>从属实体类型的实现：（对没有标识符的值对象进行映射）</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在配置中添加</span></span><br><span class="line">builder.OwnsOne(e=&gt;e.从属实体类)</span><br></pre></td></tr></table></figure><h3 id="9-3-5-构建表达式树，简化值对象比较"><a href="#9-3-5-构建表达式树，简化值对象比较" class="headerlink" title="9.3.5 构建表达式树，简化值对象比较"></a>9.3.5 构建表达式树，简化值对象比较</h3><p>nuget包：Zack.Infrastructure中提供MakeEqual方法</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">ctx.Cities.Where(MakeEqual((Region c)=&gt; c.Name,<span class="keyword">new</span> MultilingualString(<span class="string">&quot;北京&quot;</span>,<span class="string">&quot;BeiJing&quot;</span>)));</span><br></pre></td></tr></table></figure><h3 id="9-3-6-不要面向数据库建模"><a href="#9-3-6-不要面向数据库建模" class="headerlink" title="9.3.6 不要面向数据库建模"></a>9.3.6 不要面向数据库建模</h3><h3 id="9-3-7-DDD聚合在-NET中的实现"><a href="#9-3-7-DDD聚合在-NET中的实现" class="headerlink" title="9.3.7 DDD聚合在.NET中的实现"></a>9.3.7 DDD聚合在.NET中的实现</h3><p>高内聚，低耦合</p><p>1.在聚合根实体中定义访问聚合内其他实体类的方法</p><p>2.在DbContext中只为聚合根设置DbSet</p><h4 id="区分聚合根实体和其他实体：定义标识接口，例如IAggregateRoot。-x2F-x2F-自定义接口"><a href="#区分聚合根实体和其他实体：定义标识接口，例如IAggregateRoot。-x2F-x2F-自定义接口" class="headerlink" title="区分聚合根实体和其他实体：定义标识接口，例如IAggregateRoot。&#x2F;&#x2F;自定义接口"></a>区分聚合根实体和其他实体：定义标识接口，例如IAggregateRoot。&#x2F;&#x2F;自定义接口</h4><h4 id="跨聚合实体引用，只能引用根实体和ID，不能引用对象。-x2F-x2F-便于拆分"><a href="#跨聚合实体引用，只能引用根实体和ID，不能引用对象。-x2F-x2F-便于拆分" class="headerlink" title="跨聚合实体引用，只能引用根实体和ID，不能引用对象。&#x2F;&#x2F;便于拆分"></a>跨聚合实体引用，只能引用根实体和ID，不能引用对象。&#x2F;&#x2F;便于拆分</h4><p>跨聚合操作，使用冗余字段(在实体类中定义其他实体类的字属性)，提高性能</p><h4 id="强类型ID"><a href="#强类型ID" class="headerlink" title="强类型ID"></a>强类型ID</h4><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">OrderID</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">long</span> <span class="built_in">int</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-8-用MediatR实现领域事件"><a href="#9-3-8-用MediatR实现领域事件" class="headerlink" title="9.3.8 用MediatR实现领域事件"></a>9.3.8 用MediatR实现领域事件</h3><h3 id="9-3-9-EFCore发布领域事件的合适时机"><a href="#9-3-9-EFCore发布领域事件的合适时机" class="headerlink" title="9.3.9 EFCore发布领域事件的合适时机"></a>9.3.9 EFCore发布领域事件的合适时机</h3><h3 id="9-3-10-RabbitQ的基本使用"><a href="#9-3-10-RabbitQ的基本使用" class="headerlink" title="9.3.10 RabbitQ的基本使用"></a>9.3.10 RabbitQ的基本使用</h3><p>集成事件：在微服务间进行事件的传递</p><p>信道：</p><p>队列：</p><p>交换机：</p><p>Declare：有就使用，没有就创建。</p><h3 id="9-3-11-RabbitMQ框架"><a href="#9-3-11-RabbitMQ框架" class="headerlink" title="9.3.11 RabbitMQ框架"></a>9.3.11 RabbitMQ框架</h3><p>Zack.EventBus、CAP</p><h3 id="9-3-12-Zack-EventBus源码讲解"><a href="#9-3-12-Zack-EventBus源码讲解" class="headerlink" title="9.3.12 Zack.EventBus源码讲解"></a>9.3.12 Zack.EventBus源码讲解</h3><h3 id="9-3-13-整洁架构：洋葱架构"><a href="#9-3-13-整洁架构：洋葱架构" class="headerlink" title="9.3.13 整洁架构：洋葱架构"></a>9.3.13 整洁架构：洋葱架构</h3><p>传统三层架构：高内聚，低耦合。</p><img src="F:\typora_Picture\v2-fd014bc785c107ec17f489448dc3935f_1440w.png" alt="洋葱架构" style="zoom:50%;" /><p>内层是抽象，外层是实现</p><h2 id="9-4-DDD案例：用户登录和管理"><a href="#9-4-DDD案例：用户登录和管理" class="headerlink" title="9.4 DDD案例：用户登录和管理"></a>9.4 DDD案例：用户登录和管理</h2><h3 id="9-4-1"><a href="#9-4-1" class="headerlink" title="9.4.1"></a>9.4.1</h3><p>操作日志：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="9-4-5-工作单元的实现"><a href="#9-4-5-工作单元的实现" class="headerlink" title="9.4.5 工作单元的实现"></a>9.4.5 工作单元的实现</h3><p>不在Repositories里调用SaveChanges()，在应用服务层确定。</p><h3 id="9-4-6-应用层的实现"><a href="#9-4-6-应用层的实现" class="headerlink" title="9.4.6 应用层的实现"></a>9.4.6 应用层的实现</h3><p>数据校验、请求数据的获取、领域服务返回值显示等</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">LoginCotroller.cs</span><br><span class="line"></span><br><span class="line">LoginByPhoneNumberRequest.cs</span><br><span class="line"></span><br><span class="line">CRUDController.cs</span><br></pre></td></tr></table></figure><h3 id="9-4-7-使用强类型ID"><a href="#9-4-7-使用强类型ID" class="headerlink" title="9.4.7 使用强类型ID"></a>9.4.7 使用强类型ID</h3><p>杨中科开源项目</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis命令</title>
      <link href="/posts/52a6c19b.html"/>
      <url>/posts/52a6c19b.html</url>
      
        <content type="html"><![CDATA[<h3 id="使用GitHub上的Redis-Windows端口"><a href="#使用GitHub上的Redis-Windows端口" class="headerlink" title="使用GitHub上的Redis Windows端口"></a>使用GitHub上的Redis Windows端口</h3><ol><li><p><strong>下载Redis</strong>：</p><ul><li>访问<a href="https://github.com/tporadowski/redis/releases">tporadowski&#x2F;redis</a>的GitHub页面，这里提供了适用于Windows的Redis版本。</li><li>下载适合您系统的Redis压缩包（例如<code>Redis-x64-5.0.14.1.zip</code>）。</li></ul></li><li><p><strong>解压文件</strong>：</p><ul><li>将下载的压缩包解压到一个目录中，比如<code>C:\Redis</code>。</li></ul></li><li><p><strong>启动Redis服务</strong>：</p><ul><li>打开命令提示符（cmd），切换到Redis的安装目录，然后运行以下命令以启动Redis服务：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server.exe redis.windows.conf</span><br></pre></td></tr></table></figure></li><li>如果一切正常，你应该能看到Redis服务器启动的信息。</li></ul></li><li><p><strong>设置为Windows服务（可选）</strong>：</p><ul><li>如果希望Redis随系统启动而自动启动，可以将其注册为Windows服务：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server --service-install redis.windows.conf --loglevel verbose</span><br></pre></td></tr></table></figure></li><li>然后启动该服务：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server --service-start</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>测试连接</strong>：</p><ul><li>在另一个命令提示符窗口中，运行以下命令来测试是否能够成功连接到Redis服务器：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-cli ping</span><br></pre></td></tr></table></figure></li><li>如果返回”PONG”则表示连接成功。</li></ul></li></ol><h3 id="使用Memurai作为替代方案"><a href="#使用Memurai作为替代方案" class="headerlink" title="使用Memurai作为替代方案"></a>使用Memurai作为替代方案</h3><p>由于Redis官方已经停止了对Windows的支持，如果您需要一个更加稳定且长期维护的解决方案，可以考虑使用Memurai，它是一个兼容Redis协议的高性能数据存储解决方案，专为Windows设计。</p><ol><li><p><strong>访问Memurai官网</strong>：</p><ul><li>前往<a href="https://www.memurai.com/">Memurai官网</a>下载适合您系统的版本。</li></ul></li><li><p><strong>安装Memurai</strong>：</p><ul><li>按照安装向导的指示完成Memurai的安装过程。安装过程中可以选择是否将Memurai配置为开机自启的服务。</li></ul></li><li><p><strong>启动和管理Memurai</strong>：</p><ul><li>安装完成后，可以通过Memurai自带的图形界面或命令行工具来管理和监控您的Redis实例。</li></ul></li></ol><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li><strong>环境变量</strong>：为了方便使用Redis命令，您可以将Redis的安装路径添加到系统的环境变量PATH中。</li><li><strong>安全性</strong>：确保您的Redis服务器配置文件中的<code>bind</code>参数正确设置，仅允许受信任的IP地址访问，并考虑启用密码保护以增加安全性。</li><li><strong>持久化选项</strong>：根据您的需求调整RDB快照和AOF日志等持久化选项，以确保数据的安全性。</li></ul><p>通过上述步骤，您应该能够在Windows平台上成功部署并运行Redis服务器。如果在部署过程中遇到问题，请参考具体的错误信息进行排查。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8 ASP.NET Core 高级组件</title>
      <link href="/posts/597bf4c6.html"/>
      <url>/posts/597bf4c6.html</url>
      
        <content type="html"><![CDATA[<h1 id="8-ASP-NET-Core-高级组件"><a href="#8-ASP-NET-Core-高级组件" class="headerlink" title="8 ASP.NET Core 高级组件"></a>8 ASP.NET Core 高级组件</h1><h2 id="8-1-Authentication和Ahthorization"><a href="#8-1-Authentication和Ahthorization" class="headerlink" title="8.1 Authentication和Ahthorization"></a>8.1 Authentication和Ahthorization</h2><p>鉴权、验证（用户）</p><p>授权（角色）</p><h3 id="8-1-1-标识框架"><a href="#8-1-1-标识框架" class="headerlink" title="8.1.1 标识框架"></a>8.1.1 标识框架</h3><p>Identity框架：基于角色的访问控制</p><blockquote><p>[!WARNING]</p><p>Unable to create a ‘DbContext’ of type ‘RuntimeType’. The exception ‘Unable to resolve service for type ‘Microsoft.EntityFrameworkCore.DbContextOptions&#96;1[ASP.NETCore高级组件.MyDbContext]’ while attempting to activate ‘ASP.NETCore高级组件.MyDbContext’.’ was thrown while attempting to create an instance. For the different patterns supported at design time, see <a href="https://go.microsoft.com/fwlink/?linkid=851728">https://go.microsoft.com/fwlink/?linkid=851728</a></p></blockquote><p>新建一个DbContextDesignTimeFactory.cs，写入以下代码</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DbContextDesignTimeFactory</span> : <span class="title">IDesignTimeDbContextFactory</span>&lt;<span class="title">MyDbContext</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> MyDbContext <span class="title">CreateDbContext</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        DbContextOptionsBuilder&lt;MyDbContext&gt; dbContextOptionsBuilder = <span class="keyword">new</span> DbContextOptionsBuilder&lt;MyDbContext&gt;();</span><br><span class="line">        dbContextOptionsBuilder.UseSqlServer(<span class="string">&quot;Server=.;Database=idtest1;Trusted_Connection=true;TrustServerCertificate=True;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyDbContext(dbContextOptionsBuilder.Options);</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>[!WARNING]</p><p>provider: SSL Provider, error: 0 - 证书链是由不受信任的颁发机构颁发的。</p></blockquote><p>在连接字符串添加：<strong>TrustServerCertificate&#x3D;True;</strong></p><p>处理用户登录请求</p><h3 id="8-1-2-实现密码的重置"><a href="#8-1-2-实现密码的重置" class="headerlink" title="8.1.2 实现密码的重置"></a>8.1.2 实现密码的重置</h3><p> 更新数据使用[HttpPut]</p><p>调用GeneratePasswordResetTokenAsync方法生成令牌</p><h3 id="8-1-3-代替Session的JWT"><a href="#8-1-3-代替Session的JWT" class="headerlink" title="8.1.3 代替Session的JWT"></a>8.1.3 代替Session的JWT</h3><p>JWT：</p><p>登录信息保存在客户端</p><p>令牌的签名处理，签名密钥存在服务器</p><h3 id="8-1-4-生成和解析JWT字符串"><a href="#8-1-4-生成和解析JWT字符串" class="headerlink" title="8.1.4 生成和解析JWT字符串"></a>8.1.4 生成和解析JWT字符串</h3><blockquote><p>[!NOTE]</p><p>JWT的基本原理，了解即可</p></blockquote><p>Nuget包：System.IdentityModel.Tokens.Jwt</p><p>Claim可以重复</p><p>JwtSecurityTokenHandler类解码JWT</p><p>负载中的内容明文保存，不把不能让客户端知道的信息放在JWT中</p><p>ValidateToken方法，校验密钥</p><h3 id="8-1-5-ASP-NET-Core对于JWT的封装"><a href="#8-1-5-ASP-NET-Core对于JWT的封装" class="headerlink" title="8.1.5 ASP.NET Core对于JWT的封装"></a>8.1.5 ASP.NET Core对于JWT的封装</h3><h3 id="8-1-6-Swagger中带JWT请求"><a href="#8-1-6-Swagger中带JWT请求" class="headerlink" title="8.1.6 Swagger中带JWT请求"></a>8.1.6 Swagger中带JWT请求</h3><h3 id="8-1-7-解决JWT无法提前撤回"><a href="#8-1-7-解决JWT无法提前撤回" class="headerlink" title="8.1.7 解决JWT无法提前撤回"></a>8.1.7 解决JWT无法提前撤回</h3><h2 id="8-2-托管服务"><a href="#8-2-托管服务" class="headerlink" title="8.2 托管服务"></a>8.2 托管服务</h2><h3 id="8-2-1-托管服务基本使用"><a href="#8-2-1-托管服务基本使用" class="headerlink" title="8.2.1 托管服务基本使用"></a>8.2.1 托管服务基本使用</h3><p>IHostService接口，BackgroundService</p><p>注册服务</p><p>builder.Services.AddHostedService<BackgroundServiceDemo>();</p><p>net6以后： 托管服务发生异常，程序自动停止并退出。</p><h3 id="8-2-2-案例：定时导出的托管服务"><a href="#8-2-2-案例：定时导出的托管服务" class="headerlink" title="8.2.2 案例：定时导出的托管服务"></a>8.2.2 案例：定时导出的托管服务</h3><p>推荐框架：Hangfire</p><h2 id="8-3-请求数据的校验"><a href="#8-3-请求数据的校验" class="headerlink" title="8.3 请求数据的校验"></a>8.3 请求数据的校验</h2><h3 id="8-3-1-NET-Core-内置数据校验的不足"><a href="#8-3-1-NET-Core-内置数据校验的不足" class="headerlink" title="8.3.1 .NET Core 内置数据校验的不足"></a>8.3.1 .NET Core 内置数据校验的不足</h3><ol><li><p>违反单一职责原则</p></li><li><p>.NET校验规则不够多</p></li></ol><h3 id="8-3-2-FluentValidation的基本使用"><a href="#8-3-2-FluentValidation的基本使用" class="headerlink" title="8.3.2 FluentValidation的基本使用"></a>8.3.2 FluentValidation的基本使用</h3><h3 id="8-3-3-FluentValidation注入服务"><a href="#8-3-3-FluentValidation注入服务" class="headerlink" title="8.3.3 FluentValidation注入服务"></a>8.3.3 FluentValidation注入服务</h3><p>通过构造函数注入服务</p><h2 id="8-4-SignalR服务器端消息推送"><a href="#8-4-SignalR服务器端消息推送" class="headerlink" title="8.4 SignalR服务器端消息推送"></a>8.4 SignalR服务器端消息推送</h2><h3 id="8-4-1-SignalR基本使用"><a href="#8-4-1-SignalR基本使用" class="headerlink" title="8.4.1 SignalR基本使用"></a>8.4.1 SignalR基本使用</h3><p>websocket独立于HTTP协议，一般仍然把WebSocket服务器端部署到Web服务器上，可以借助HTTP协议完成初始的握手(可选)，并且共享HTTP服务器的端口(主要)。</p><p>核心：集线器（hub）</p><p>代码：服务器端、客户端</p><p>PublicMsgReceived是前端监听的方法，一旦后端的这个SendPublicMsg在前端被触发了，那Send这个方法就执行了，而监听了Public的方法也就得到了信息</p><p>yarn create @vitejs&#x2F;app SignalRClient</p><p>npm install @microsoft&#x2F;signalr</p><h3 id="8-4-2-协议协商"><a href="#8-4-2-协议协商" class="headerlink" title="8.4.2 协议协商"></a>8.4.2 协议协商</h3><p>粘性会话和禁用协商</p><p>粘性会话：配置负载均衡服务器，扩容自适应性不强。</p><h3 id="8-4-3-SignalR分布式部署"><a href="#8-4-3-SignalR分布式部署" class="headerlink" title="8.4.3 SignalR分布式部署"></a>8.4.3 SignalR分布式部署</h3><p>前提，启用粘性会话和禁用协商。</p><p>Redis backplane</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">builder.Services.AddSignalR().AddStackExchangeRedis(<span class="string">&quot;127.0.0.1&quot;</span>,option=&gt;&#123;</span><br><span class="line">    options.Configration.ChannelPrefix=<span class="string">&quot;Test1_SignalR&quot;</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="8-4-4-SignalR身份认证"><a href="#8-4-4-SignalR身份认证" class="headerlink" title="8.4.4 SignalR身份认证"></a>8.4.4 SignalR身份认证</h3><p>使用标识框架，Authentication和Ahthorization</p><h3 id="8-4-5-针对部分客户端的消息推送"><a href="#8-4-5-针对部分客户端的消息推送" class="headerlink" title="8.4.5 针对部分客户端的消息推送"></a>8.4.5 针对部分客户端的消息推送</h3><h3 id="8-4-6-在外部向集线器推送消息"><a href="#8-4-6-在外部向集线器推送消息" class="headerlink" title="8.4.6 在外部向集线器推送消息"></a>8.4.6 在外部向集线器推送消息</h3><p>注入IHubContext<THub>获取对集线器进行操作的服务。</p><h3 id="8-4-7-导入英汉词典到数据库并显示进度"><a href="#8-4-7-导入英汉词典到数据库并显示进度" class="headerlink" title="8.4.7 导入英汉词典到数据库并显示进度"></a>8.4.7 导入英汉词典到数据库并显示进度</h3><p>弃元符号</p><p>在vue中禁用协商需要添加以下代码</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//添加禁用协商选项</span></span><br><span class="line">  <span class="keyword">const</span> options = &#123; skipNegotiation: <span class="literal">true</span>, transport: signalR.HttpTransportType.WebSockets &#125;;</span><br><span class="line"></span><br><span class="line">   connection = <span class="keyword">new</span> signalR.HubConnectionBuilder()</span><br><span class="line"></span><br><span class="line">​    .withUrl(<span class="string">&#x27;https://localhost:7005/MyHub&#x27;</span>, options)</span><br><span class="line"></span><br><span class="line">​    .withAutomaticReconnect()</span><br><span class="line"></span><br><span class="line">​    .build();</span><br></pre></td></tr></table></figure><h2 id="8-5-ASP-NET-CORE系统的部署"><a href="#8-5-ASP-NET-CORE系统的部署" class="headerlink" title="8.5 ASP.NET CORE系统的部署"></a>8.5 ASP.NET CORE系统的部署</h2><h3 id="8-5-1-网站的发布"><a href="#8-5-1-网站的发布" class="headerlink" title="8.5.1 网站的发布"></a>8.5.1 网站的发布</h3><p>SendBox 微软官方虚拟机</p><p>部署模式优先选择独立。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7 ASP.NET Core 基础组件</title>
      <link href="/posts/b4f6e857.html"/>
      <url>/posts/b4f6e857.html</url>
      
        <content type="html"><![CDATA[<h1 id="7-ASP-NET-Core-基础组件"><a href="#7-ASP-NET-Core-基础组件" class="headerlink" title="7 ASP.NET Core 基础组件"></a>7 ASP.NET Core 基础组件</h1><h2 id="7-1-依赖注入"><a href="#7-1-依赖注入" class="headerlink" title="7.1 依赖注入"></a>7.1 依赖注入</h2><p>1. </p><h3 id="7-1-3-注册框架"><a href="#7-1-3-注册框架" class="headerlink" title="7.1.3 注册框架"></a>7.1.3 注册框架</h3><p>类库自己负责自己服务的注册</p><p>1.安装Zack.Commus。</p><p>2.创建接口的实现类ModuleInitializer（.cs文件）。</p><p>3.初始化DI容器。</p><h2 id="7-4-程序优化万金油：缓存"><a href="#7-4-程序优化万金油：缓存" class="headerlink" title="7.4 程序优化万金油：缓存"></a>7.4 程序优化万金油：缓存</h2><h3 id="7-4-1-缓存"><a href="#7-4-1-缓存" class="headerlink" title="7.4.1 缓存"></a>7.4.1 缓存</h3><p>cache-control 响应报文头</p><p>[ResponseCache(Duration&#x3D;60)]</p><h3 id="7-4-2-服务器端响应缓存（缓存中间件）"><a href="#7-4-2-服务器端响应缓存（缓存中间件）" class="headerlink" title="7.4.2 服务器端响应缓存（缓存中间件）"></a>7.4.2 服务器端响应缓存（缓存中间件）</h3><p> cache-control: no-cache</p><blockquote><p>[!WARNING]</p><p>鸡肋，限制很多：采用内存缓存、分布式缓存等</p></blockquote><h3 id="7-4-3-内式缓存"><a href="#7-4-3-内式缓存" class="headerlink" title="7.4.3 内式缓存"></a>7.4.3 内式缓存</h3><h4 id="7-4-3-1-使用内存缓存"><a href="#7-4-3-1-使用内存缓存" class="headerlink" title="7.4.3.1 使用内存缓存"></a>7.4.3.1 使用内存缓存</h4><p>注册：API项目中需要在  builder.Build前添加build.Services.AddMemoryCache</p><p>注入：在控制器中添加private readonly IMemoryCache memCache</p><p>在控制器参数中添加IMemoryCache memCache</p><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>GetOrCreate和GetOrCreateAsync：获取键为key的缓存值，返回值为缓存值，没有则从数据源获取值作为返回值。</p><h4 id="7-4-3-2-缓存过期时间的策略"><a href="#7-4-3-2-缓存过期时间的策略" class="headerlink" title="7.4.3.2 缓存过期时间的策略"></a>7.4.3.2 缓存过期时间的策略</h4><p>1.绝对过期时间</p><p>AbsoluteExpirationRelativeToNow</p><p>2.滑动过期时间</p><p>SlidingExpiration </p><p>3.混合使用：</p><h3 id="7-4-4-缓存穿透问题"><a href="#7-4-4-缓存穿透问题" class="headerlink" title="7.4.4 缓存穿透问题"></a>7.4.4 缓存穿透问题</h3><p>原因：查询不到的数据用null表示</p><p>方法：使用GetOrCreateAsync</p><h3 id="7-4-5-缓存雪崩问题、缓存数据混乱问题"><a href="#7-4-5-缓存雪崩问题、缓存数据混乱问题" class="headerlink" title="7.4.5 缓存雪崩问题、缓存数据混乱问题"></a>7.4.5 缓存雪崩问题、缓存数据混乱问题</h3><p>缓存雪崩：再加一个随机过期时间。</p><p>Random的Shared方法</p><p>数据混乱：缓存的key设计不合理</p><h3 id="7-4-6-封装内存缓存操作的帮助类"><a href="#7-4-6-封装内存缓存操作的帮助类" class="headerlink" title="7.4.6 封装内存缓存操作的帮助类"></a>7.4.6 封装内存缓存操作的帮助类</h3><p>IQueryable和IEnumerable存在延迟加载的问题。</p><p>最好转换成List<T>数组类型。</p><p>IMemoryCacheHelper(nuget包，Zack.ASPNETCORE)</p><h3 id="7-4-7-分布式缓存"><a href="#7-4-7-分布式缓存" class="headerlink" title="7.4.7 分布式缓存"></a>7.4.7 分布式缓存</h3><p>Redis（推荐）、Memcached</p><p>缓存值为byte[]，需要进行类型转换。</p><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p>1.安装Microsoft.Extensions.Caching.StackExchangeRedis</p><ol start="2"><li></li></ol><h3 id="7-4-8-ASP-NET-Core与配置系统的集成"><a href="#7-4-8-ASP-NET-Core与配置系统的集成" class="headerlink" title="7.4.8 ASP.NET Core与配置系统的集成"></a>7.4.8 ASP.NET Core与配置系统的集成</h3><h4 id="7-4-8-1-默认配置提供者"><a href="#7-4-8-1-默认配置提供者" class="headerlink" title="7.4.8.1 默认配置提供者"></a>7.4.8.1 默认配置提供者</h4><p>ASP.NET CORE默认添加的配置提供者</p><p>1)加载现有的IConfiguration。</p><p>2)加载项自根目求下的appsettings.json.</p><p>3)加载项目根目录下的appsettingsbEnvironmentyjson.</p><p>4)当程序运行在开发环境下，程序会加载“用户机密”配置。</p><p>5)加载环境变量中的配置</p><p>6)加载命令行中的配置。</p><h4 id="7-4-8-2-ASP-NET-Core防止机密信息泄漏到github"><a href="#7-4-8-2-ASP-NET-Core防止机密信息泄漏到github" class="headerlink" title="7.4.8.2 ASP.NET Core防止机密信息泄漏到github"></a>7.4.8.2 ASP.NET Core防止机密信息泄漏到github</h4><p>1.右键菜单&gt;管理用户机密</p><p>2.使用配置服务器</p><h4 id="7-4-8-3-配置系统综合案例"><a href="#7-4-8-3-配置系统综合案例" class="headerlink" title="7.4.8.3 配置系统综合案例"></a>7.4.8.3 配置系统综合案例</h4><img src="C:\Users\LiYB\AppData\Roaming\Typora\typora-user-images\image-20241121213400355.png" alt="image-20241121213400355" style="zoom:50%;" /><h2 id="7-5-EFCore-与ASP-NET-Core集成"><a href="#7-5-EFCore-与ASP-NET-Core集成" class="headerlink" title="7.5 EFCore 与ASP.NET Core集成"></a>7.5 EFCore 与ASP.NET Core集成</h2><p>主要内容在分层项目文件中</p><h3 id="7-5-1-分层项目中使用EF-Core"><a href="#7-5-1-分层项目中使用EF-Core" class="headerlink" title="7.5.1 分层项目中使用EF Core"></a>7.5.1 分层项目中使用EF Core</h3><h4 id="1-项目分层及问题解决"><a href="#1-项目分层及问题解决" class="headerlink" title="1.项目分层及问题解决"></a>1.项目分层及问题解决</h4><h3 id="7-5-3-批量注册上下文"><a href="#7-5-3-批量注册上下文" class="headerlink" title="7.5.3 批量注册上下文"></a>7.5.3 批量注册上下文</h3><p>多个DBContext连接同一个数据库</p><h2 id="7-6-筛选器"><a href="#7-6-筛选器" class="headerlink" title="7.6 筛选器"></a>7.6 筛选器</h2><p>切面编程机制</p><h3 id="7-6-1-EXCEPTION-FILTER：异常筛选器"><a href="#7-6-1-EXCEPTION-FILTER：异常筛选器" class="headerlink" title="7.6.1 EXCEPTION FILTER：异常筛选器"></a>7.6.1 EXCEPTION FILTER：异常筛选器</h3><p>多个需要注意注册顺序 </p><h3 id="7-6-2-ACTIONFILTER：操作筛选器"><a href="#7-6-2-ACTIONFILTER：操作筛选器" class="headerlink" title="7.6.2 ACTIONFILTER：操作筛选器"></a>7.6.2 ACTIONFILTER：操作筛选器</h3><img src="F:\typora_Picture\image-20241202230647576.png" alt="image-20241202230647576" style="zoom:50%;" /><h3 id="7-6-3-自动启用事务的操作筛选器"><a href="#7-6-3-自动启用事务的操作筛选器" class="headerlink" title="7.6.3 自动启用事务的操作筛选器"></a>7.6.3 自动启用事务的操作筛选器</h3><h3 id="7-6-4-自动限流器"><a href="#7-6-4-自动限流器" class="headerlink" title="7.6.4 自动限流器"></a>7.6.4 自动限流器</h3><p>memorycache实现，</p><h2 id="7-7-中间件"><a href="#7-7-中间件" class="headerlink" title="7.7 中间件"></a>7.7 中间件</h2><p>ASP.NET核心组件</p><h3 id="7-7-1-基础概念"><a href="#7-7-1-基础概念" class="headerlink" title="7.7.1 基础概念"></a>7.7.1 基础概念</h3><img src="F:\typora_Picture\image-20241204225245332.png" alt="image-20241204225245332" style="zoom:50%;" /><p>Map：决定处理那些请求</p><p>Use：引入中间件</p><p>Run：核心应用逻辑</p><h3 id="7-2-2-中间件的使用"><a href="#7-2-2-中间件的使用" class="headerlink" title="7.2.2 中间件的使用"></a>7.2.2 中间件的使用</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">app.Map(<span class="string">&quot;/test&quot;</span>, <span class="keyword">async</span> (appBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    appBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">       context.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    appBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    appBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;run&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><h3 id="7-2-3-中间件类"><a href="#7-2-3-中间件类" class="headerlink" title="7.2.3 中间件类"></a>7.2.3 中间件类</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CheckMiddleware</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">readonly</span> RequestDelegate requestDelegate;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CheckMiddleware</span>(<span class="params">RequestDelegate requestDelegate</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.requestDelegate = requestDelegate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">InvokeAsync</span>(<span class="params">HttpContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> password = context.Request.Query[<span class="string">&quot;password&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span> (password == <span class="string">&quot;123&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (context.Request.HasJsonContentType())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> stream = context.Request.BodyReader.AsStream();</span><br><span class="line">                <span class="built_in">dynamic</span>? obj = DJson.Parse(stream);</span><br><span class="line">                context.Items[<span class="string">&quot;BodyJson&quot;</span>] = obj;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> requestDelegate(context);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            context.Response.StatusCode = <span class="number">401</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在Program.cs中添加“appBuilder.UseMiddleware<CheckMiddleware>();”</p><h3 id="7-2-4-MarkDown转换器中间件"><a href="#7-2-4-MarkDown转换器中间件" class="headerlink" title="7.2.4 MarkDown转换器中间件"></a>7.2.4 MarkDown转换器中间件</h3><p>Ude.NetStandard：探测文件编码</p><p>MarkDownSharp：MD转HTML</p><h3 id="7-2-5-中间件和Filter"><a href="#7-2-5-中间件和Filter" class="headerlink" title="7.2.5 中间件和Filter"></a>7.2.5 中间件和Filter</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6 ASP.NET Core Web API基础</title>
      <link href="/posts/cc427f2c.html"/>
      <url>/posts/cc427f2c.html</url>
      
        <content type="html"><![CDATA[<h1 id="6-ASP-NET-Core-Web-API基础"><a href="#6-ASP-NET-Core-Web-API基础" class="headerlink" title="6 ASP.NET Core Web API基础"></a>6 ASP.NET Core Web API基础</h1><h2 id="6-1-C-新知识"><a href="#6-1-C-新知识" class="headerlink" title="6.1 C#新知识"></a>6.1 C#新知识</h2><h3 id="6-1-1-顶级语句"><a href="#6-1-1-顶级语句" class="headerlink" title="6.1.1 顶级语句"></a>6.1.1 顶级语句</h3><ol><li><p>文件支持经典写法和顶级语句</p></li><li><p>只能有1个顶级语句</p></li><li><p>可以直接使用await语法和声明函数</p></li></ol><h3 id="6-1-2-全局USING指令"><a href="#6-1-2-全局USING指令" class="headerlink" title="6.1.2 全局USING指令"></a>6.1.2 全局USING指令</h3><p>global修饰符</p><ol><li>创建一个专门文件编写全局using。</li><li><ImplicitUsings>enable</ImplicitUsings>将常用的命名空间自动引入</li></ol><h3 id="6-1-3-USING资源管理"><a href="#6-1-3-USING资源管理" class="headerlink" title="6.1.3 USING资源管理"></a>6.1.3 USING资源管理</h3><p> 前置知识：IDisposible需要使用using进行管理</p><p>using声明：直接在变量声明前加using，代码离开变量作用域时，对象会被释放。</p><h3 id="6-1-4-文件范围的命名空间声明"><a href="#6-1-4-文件范围的命名空间声明" class="headerlink" title="6.1.4 文件范围的命名空间声明"></a>6.1.4 文件范围的命名空间声明</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Program1</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可写成</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Program1</span>;</span><br></pre></td></tr></table></figure><h3 id="6-1-5-可空引用类型"><a href="#6-1-5-可空引用类型" class="headerlink" title="6.1.5 可空引用类型"></a>6.1.5 可空引用类型</h3><p>规避引用类型为null警告，</p><p>在引用类型后添加 ’？‘</p><p>’！‘ 抑制null警告，尽量不用</p><h3 id="6-1-6-record类型基础"><a href="#6-1-6-record类型基础" class="headerlink" title="6.1.6 record类型基础"></a>6.1.6 record类型基础</h3><p>tips:private set和init可设置只读类型</p><p>record类型自动重写ToString方法，内容一样时比较结果为true</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//本质也是一种类</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">internal</span> <span class="keyword">record</span> <span class="title">Person</span>(<span class="params"><span class="built_in">int</span> ID, <span class="built_in">string</span> Name, <span class="built_in">int</span> Age</span>)</span>;</span><br><span class="line"></span><br><span class="line">Person p1 = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">&quot;person1&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">Person p1 = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">&quot;person1&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">Person p1 = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">&quot;person1&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(p1.ToString());</span><br><span class="line"></span><br><span class="line">Console.WriteLine(p1==p2);</span><br></pre></td></tr></table></figure><p>尽量只使用只读属性。可通过单独设置属性，实现可读可写。</p><p>通过额外的构造函数，写独特的构造逻辑，实现创建副本时可以修改。</p><p>record类型创建副本,使用with语法</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Person p2 = p1 <span class="keyword">with</span> &#123; &#125;</span><br></pre></td></tr></table></figure><h2 id="6-2-ASP-NET-Corw入门"><a href="#6-2-ASP-NET-Corw入门" class="headerlink" title="6.2 ASP.NET Corw入门"></a>6.2 ASP.NET Corw入门</h2><h3 id="6-2-1-MVC项目"><a href="#6-2-1-MVC项目" class="headerlink" title="6.2.1 MVC项目"></a>6.2.1 MVC项目</h3><p>模型、视图（拓展名一般为.cshtml）、控制器</p><p>渲染：Render</p><h3 id="6-2-2-HOTRELOAD：热重载"><a href="#6-2-2-HOTRELOAD：热重载" class="headerlink" title="6.2.2 HOTRELOAD：热重载"></a>6.2.2 HOTRELOAD：热重载</h3><p>调试-无断点-热重载：</p><p>不调试-断点-重启程序：删除方法或修改了方法参数</p><h3 id="6-2-3-ASP-NET-Core开发Web-API"><a href="#6-2-3-ASP-NET-Core开发Web-API" class="headerlink" title="6.2.3 ASP.NET Core开发Web API"></a>6.2.3 ASP.NET Core开发Web API</h3><h2 id="6-3-Restful"><a href="#6-3-Restful" class="headerlink" title="6.3 Restful"></a>6.3 Restful</h2><p>面向过程（RPC），面向REST（REST）。</p><p>REST：按照HTTP语义使用HTTP。</p><ol><li><p>URL资源定位：&#x2F;user&#x2F;888&#x2F;orders</p></li><li><table><thead><tr><th>GET</th><th>获取资源</th><th>幂等</th><th>可缓存</th></tr></thead><tbody><tr><td>POST</td><td>新增资源</td><td>不幂等</td><td>不可缓存</td></tr><tr><td>PUT</td><td>整体更新资源</td><td>幂等</td><td>不可缓存</td></tr><tr><td>DELETE</td><td>删除资源</td><td>幂等</td><td>不可缓存</td></tr></tbody></table></li><li><p>通过状态码反应资源获取结果。</p></li></ol><blockquote><p>[!NOTE]</p><p>两种技术没有用绝对的好坏</p></blockquote><h3 id="6-3-3-Restful如何传递参数"><a href="#6-3-3-Restful如何传递参数" class="headerlink" title="6.3.3 Restful如何传递参数"></a>6.3.3 Restful如何传递参数</h3><table><thead><tr><th>方式</th><th>灵活性</th><th>长度</th><th>备注</th></tr></thead><tbody><tr><td>URL</td><td>适合定位</td><td>长度限制</td><td></td></tr><tr><td>QueryString</td><td>灵活</td><td>长度限制</td><td></td></tr><tr><td>请求报文体</td><td>灵活</td><td>长度不限制</td><td>不支持GET、DELETE</td></tr></tbody></table><h3 id="6-3-4-返回错误码"><a href="#6-3-4-返回错误码" class="headerlink" title="6.3.4 返回错误码"></a>6.3.4 返回错误码</h3><p>400派和200派。</p><p>不存在最好的选择，适合自己的就是最好的。</p><h3 id="6-3-5-Restful实现指南"><a href="#6-3-5-Restful实现指南" class="headerlink" title="6.3.5 Restful实现指南"></a>6.3.5 Restful实现指南</h3><p>如果没有条件实现完美的REST，</p><ol><li>控制器上 [Route(“[controller]&#x2F;[action]”)]。</li><li>强制要求控制器中不同的操作用不同的方法名。</li><li>把[HttpGet] [HttpPost] [HttpDelete] [HttpPut]等添加到对应的操作方法上。</li></ol><h2 id="6-4-Web-Api各种技术及选择"><a href="#6-4-Web-Api各种技术及选择" class="headerlink" title="6.4 Web Api各种技术及选择"></a>6.4 Web Api各种技术及选择</h2><h3 id="6-4-1-控制器及返回值"><a href="#6-4-1-控制器及返回值" class="headerlink" title="6.4.1 控制器及返回值"></a>6.4.1 控制器及返回值</h3><p>控制器类继承于ControllerBase</p><p>WebAPI方法可以是异步或同步，不直接调用方法，可以不加Async</p><p>IActionResult:不建议直接使用，使用ActionResult<T>类，实例如下：</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">AddPerson</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;id错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>&gt;&gt; AddPerson2(<span class="built_in">int</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;id错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-4-2-操作方法的参数"><a href="#6-4-2-操作方法的参数" class="headerlink" title="6.4.2 操作方法的参数"></a>6.4.2 操作方法的参数</h3><h4 id="6-4-2-1-GET和DELETE请求，尽量从URL和QueryString中获取参数"><a href="#6-4-2-1-GET和DELETE请求，尽量从URL和QueryString中获取参数" class="headerlink" title="6.4.2.1 GET和DELETE请求，尽量从URL和QueryString中获取参数"></a>6.4.2.1 GET和DELETE请求，尽量从URL和QueryString中获取参数</h4><ol><li>使用占位符捕捉路径中的内容，进行参数匹配</li></ol><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">    [<span class="meta">HttpGet(<span class="string">&quot;&#123;i1&#125;/&#123;i2&#125;&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Multi</span>(<span class="params"><span class="built_in">int</span> i1, <span class="built_in">int</span> i2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> i1 + i2;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//参数和获取名字不一致时，使用[FromRoute(Name=&quot;参数名&quot;)]</span></span><br></pre></td></tr></table></figure><ol start="2"><li><p>混合模式</p><p>使用[FromQuery]获取值</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">HttpGet(<span class="string">&quot;student/school/&#123;schoolName&#125;/class/&#123;classNo&#125;&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">GetAll</span>(<span class="params"><span class="built_in">string</span> schoolName, [FromQuery(Name =<span class="string">&quot;classNo&quot;</span></span>)]<span class="built_in">int</span> classNum)</span></span><br><span class="line"><span class="function"><span class="comment">//参数和获取名字一致时</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">GetAll</span>(<span class="params"><span class="built_in">string</span> schoolName, [FromQuery]<span class="built_in">int</span> classNum</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> pageSize+i3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="6-4-2-2-POST和PUT请求，尽量通过JSON格式的报文体获取数据"><a href="#6-4-2-2-POST和PUT请求，尽量通过JSON格式的报文体获取数据" class="headerlink" title="6.4.2.2 POST和PUT请求，尽量通过JSON格式的报文体获取数据"></a>6.4.2.2 POST和PUT请求，尽量通过JSON格式的报文体获取数据</h4><ol><li>使用模型类作为参数</li></ol><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">AddNew</span>(<span class="params">Student s</span>)</span></span><br></pre></td></tr></table></figure><ol><li>混合使用</li></ol><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">HttpPost(<span class="string">&quot;classID/&#123;classID&#125;&quot;</span>)</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult&lt;<span class="built_in">long</span>&gt; <span class="title">AddNew</span>(<span class="params"><span class="built_in">int</span> classID, newStudent s</span>)</span></span><br></pre></td></tr></table></figure><h2 id="6-5-前后端分离"><a href="#6-5-前后端分离" class="headerlink" title="6.5 前后端分离"></a>6.5 前后端分离</h2><h3 id="6-5-1"><a href="#6-5-1" class="headerlink" title="6.5.1"></a>6.5.1</h3><h3 id="6-5-3-搭建前端开发环境"><a href="#6-5-3-搭建前端开发环境" class="headerlink" title="6.5.3 搭建前端开发环境"></a>6.5.3 搭建前端开发环境</h3><h4 id="6-5-3-1-Vue"><a href="#6-5-3-1-Vue" class="headerlink" title="6.5.3.1 Vue"></a>6.5.3.1 Vue</h4><p>搭建环境</p><ol><li><p>安装node.js</p></li><li><p>安装yarn</p></li><li><p>创建Vue项目：</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">yarn create vite frontDemo</span><br></pre></td></tr></table></figure></li><li><p>按照提示运行项目</p></li></ol><p>进入项目文件夹</p><p>在cmd输入</p><p>yarn</p><p>yarn dev</p><h3 id="6-5-4-前后端分离开发"><a href="#6-5-4-前后端分离开发" class="headerlink" title="6.5.4 前后端分离开发"></a>6.5.4 前后端分离开发</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5 EF Core高级技术</title>
      <link href="/posts/446b56e0.html"/>
      <url>/posts/446b56e0.html</url>
      
        <content type="html"><![CDATA[<h1 id="5-EF-Core高级技术"><a href="#5-EF-Core高级技术" class="headerlink" title="5 EF Core高级技术"></a>5 EF Core高级技术</h1><h2 id="5-1-原理揭秘"><a href="#5-1-原理揭秘" class="headerlink" title="5.1 原理揭秘"></a>5.1 原理揭秘</h2><h3 id="5-1-1-IQueryable和IEnumerable"><a href="#5-1-1-IQueryable和IEnumerable" class="headerlink" title="5.1.1 IQueryable和IEnumerable"></a>5.1.1 IQueryable和IEnumerable</h3><p>IQueryable：服务器评估</p><p>在数据库上完成数据筛选</p><p>IEnumerable：客户端评估</p><p>将数据拉入到内存中操作</p><h3 id="5-1-2-IQueryable延迟执行"><a href="#5-1-2-IQueryable延迟执行" class="headerlink" title="5.1.2 IQueryable延迟执行"></a>5.1.2 IQueryable延迟执行</h3><p>如果返回值是IQueryable，一般为非立即执行方法</p><p>立即执行方法：ToArray、ToList、Min、Max、Count等</p><p>非立即执行方法：GroupBy、OrderBy、Include、Skip、Take等</p><p>延迟执行目的：用于拼接复杂的查询条件：定义一个方法，使用bool类型参数判断查询条件。</p><h3 id="5-1-3-IQueryable的复用"><a href="#5-1-3-IQueryable的复用" class="headerlink" title="5.1.3 IQueryable的复用"></a>5.1.3 IQueryable的复用</h3><p>IQueryable是待查询逻辑，可以被重复使用</p><h3 id="5-1-4-分页查询"><a href="#5-1-4-分页查询" class="headerlink" title="5.1.4 分页查询"></a>5.1.4 分页查询</h3><p>方法：Skip和Take、LongCount和Count</p><p>Math.Ceiling天花板函数，1.1取2</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OutputPage</span>(<span class="params"><span class="built_in">int</span> pageIndex, <span class="built_in">int</span> pageSize</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">using</span> TestDbContext ctx = <span class="keyword">new</span> TestDbContext();</span><br><span class="line">    IQueryable&lt;Book&gt; books = ctx.Books;</span><br><span class="line">    <span class="built_in">long</span> count = books.LongCount();</span><br><span class="line">    <span class="built_in">long</span> pageCount = (<span class="built_in">long</span>)Math.Ceiling(count * <span class="number">1.0</span> / pageSize);</span><br><span class="line">    Console.Writeline(<span class="string">&quot;总页数&quot;</span> + pageCount);</span><br><span class="line">    <span class="keyword">var</span> pagedBooks = books.Skip((pageIndex<span class="number">-1</span>) * pageSize).Take(pageSize);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">var</span> item <span class="keyword">in</span> pagedBooks)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Writeline(item.Id + <span class="string">&quot;,&quot;</span> + item.Title);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-5-IQueryable的底层运行"><a href="#5-1-5-IQueryable的底层运行" class="headerlink" title="5.1.5 IQueryable的底层运行"></a>5.1.5 IQueryable的底层运行</h3><p>DataReader和DataTable</p><p>DataReader：内存占用小，连接时间长。</p><p>DataTable：内存占用大，节省连接。</p><p>IQueryable读取数据使用DataReader，调用ToArray、ToList、ToArrayAsync、ToListAsync方法可以一次性读取所有数据。</p><p>使用DataTable的场景：</p><ol><li><p>数据处理过程很耗时。</p></li><li><p>需要在方法内返回查询结果，而上下文会在方法内销毁。</p><p>using（）方法在使用完后会销毁对象。 </p></li><li><p>多个IQueryable的遍历嵌套。SQL Sever可以通过设置MultiActiveResultSets，其他可以通过调用ToArray、ToList、ToArrayAsync、ToListAsync方法。</p></li></ol><h3 id="5-1-6-EF-Core中的异步方法"><a href="#5-1-6-EF-Core中的异步方法" class="headerlink" title="5.1.6 EF Core中的异步方法"></a>5.1.6 EF Core中的异步方法</h3><p>立即执行方法都具有异步的拓展方法。</p><p>非立即执行方法由于没有实际执行的操作，不消耗IO，因此不需要异步的版本。</p><h3 id="5-1-7-执行原生的SQL语句"><a href="#5-1-7-执行原生的SQL语句" class="headerlink" title="5.1.7 执行原生的SQL语句"></a>5.1.7 执行原生的SQL语句</h3><h4 id="1-执行SQL非查询语句"><a href="#1-执行SQL非查询语句" class="headerlink" title="1.执行SQL非查询语句"></a>1.执行SQL非查询语句</h4><ol><li><p>insert into …… select是先查询出数据，然后插入到数据库表的语法</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">dbCtx.Database.ExecuteSqlInterpolatedAsync(@<span class="string">$&quot;</span></span><br><span class="line"><span class="string">insert into T_Books(Title,PubTime,Price,AuthorName)</span></span><br><span class="line"><span class="string">    select Title,PubTime,Price,<span class="subst">&#123;aName&#125;</span> from T_Books where Price&gt;<span class="subst">&#123;price&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-实体查询"><a href="#2-实体查询" class="headerlink" title="2. 实体查询"></a>2. 实体查询</h4><p>要执行的SQL语句是查询语句，且查询结果对应一个实体类。</p><p>使用实体类的DbSet的FromSqlInterpolated方法执行语句，该方法为非立即执行的。</p><p>order by newid()是SQL Server独有的，生成Guid后排序。</p><p>局限性：</p><ol><li>只能单表查询。</li></ol><h4 id="3-任意SQL查询"><a href="#3-任意SQL查询" class="headerlink" title="3.任意SQL查询"></a>3.任意SQL查询</h4><ol><li>把视图或存储过程映射为实体类。都有缺陷。</li><li>调用ADO.NET。底层API，调用麻烦。</li><li>使用DAPPER等轻量级ORM工具。推荐。</li></ol><h3 id="5-1-8-如何知道实体数据变了"><a href="#5-1-8-如何知道实体数据变了" class="headerlink" title="5.1.8 如何知道实体数据变了"></a>5.1.8 如何知道实体数据变了</h3><p>快照更改跟踪：</p><h4 id="5种状态"><a href="#5种状态" class="headerlink" title="5种状态"></a>5种状态</h4><p>已添加、未改变、已修改、已删除、分离</p><p>Entry方法：创建EntityEntry对象</p><h2 id="5-2-EF-Core性能优化利器"><a href="#5-2-EF-Core性能优化利器" class="headerlink" title="5.2 EF Core性能优化利器"></a>5.2 EF Core性能优化利器</h2><h3 id="5-2-1-AsNoTracking"><a href="#5-2-1-AsNoTracking" class="headerlink" title="5.2.1 AsNoTracking"></a>5.2.1 AsNoTracking</h3><p>查询的数据只用于展示，可以禁用跟踪</p><h3 id="5-2-2-实体状态跟踪的妙用"><a href="#5-2-2-实体状态跟踪的妙用" class="headerlink" title="5.2.2 实体状态跟踪的妙用"></a>5.2.2 实体状态跟踪的妙用</h3><p>知道即可。</p><h3 id="5-2-3-Find和FindAsync"><a href="#5-2-3-Find和FindAsync" class="headerlink" title="5.2.3 Find和FindAsync"></a>5.2.3 Find和FindAsync</h3><h3 id="5-2-4-EF-Core中高效地更新、删除数据"><a href="#5-2-4-EF-Core中高效地更新、删除数据" class="headerlink" title="5.2.4 EF Core中高效地更新、删除数据"></a>5.2.4 EF Core中高效地更新、删除数据</h3><p>EF Core8支持批量更新删除数据，自行查阅资料补充。</p><h3 id="5-2-5-全局查询筛选器"><a href="#5-2-5-全局查询筛选器" class="headerlink" title="5.2.5 全局查询筛选器"></a>5.2.5 全局查询筛选器</h3><h4 id="1-软删除"><a href="#1-软删除" class="headerlink" title="1.软删除"></a>1.软删除</h4><p>在config中加上</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">builder.HasQueryFilter(b=&gt;b.IsDeleted==false)</span><br></pre></td></tr></table></figure><p>忽略全局查询筛选器</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctx.Books.IgnoreQueryFilters().Where(b=&gt;b.Name==&quot;这是第一本书&quot;)</span><br></pre></td></tr></table></figure><h3 id="5-2-6-悲观并发控制"><a href="#5-2-6-悲观并发控制" class="headerlink" title="5.2.6 悲观并发控制"></a>5.2.6 悲观并发控制</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> MyDbContext = <span class="keyword">new</span> MyDbContext();</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> tx = <span class="keyword">await</span> ctx.Database.BeginTransactionAsync();<span class="comment">//锁和事务相关，需要先创建事务</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//EF Core没有封装悲观并发控制，需要编写原生SQL语句</span></span><br><span class="line">    <span class="keyword">var</span> h1 = <span class="keyword">await</span> ctx.Houses.FromSqlInterpolated(<span class="string">$&quot;select * from T_Houses where Id=1 for update&quot;</span>).SingleAsync();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">await</span> tx.CommitAsync();<span class="comment">//执行完操作提交事务</span></span><br></pre></td></tr></table></figure><h3 id="5-2-7-乐观并发控制：并发令牌"><a href="#5-2-7-乐观并发控制：并发令牌" class="headerlink" title="5.2.7 乐观并发控制：并发令牌"></a>5.2.7 乐观并发控制：并发令牌</h3><p>更新时带有旧值，确认影响行数</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Update T_Houses Owner = <span class="string">&quot;Tom&quot;</span></span><br><span class="line"></span><br><span class="line">Where Id = <span class="number">1</span> AND Owner = <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>使用IsConcurrencyToken把Owner列设置并发令牌属性</p><p> ROWVERSION、IsRowVersion方法</p><p>声明一个byte类型的属性，在config中配置属性</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//声明</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">byte</span>[] RowVer &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line"><span class="comment">//配置</span></span><br><span class="line">build.Property(b=&gt;b.RowVer).IsRowVersion();</span><br></pre></td></tr></table></figure><h4 id="高并发场景："><a href="#高并发场景：" class="headerlink" title="高并发场景："></a>高并发场景：</h4><p>非SQLServer，可以将并发令牌列的值更新为Guid值。缺点是需要手动更新。</p><h2 id="5-3-表达式树"><a href="#5-3-表达式树" class="headerlink" title="5.3 表达式树"></a>5.3 表达式树</h2><h3 id="5-3-1-什么是表达式树"><a href="#5-3-1-什么是表达式树" class="headerlink" title="5.3.1 什么是表达式树"></a>5.3.1 什么是表达式树</h3><p>一种用树形数据结构来表示代码逻辑运算的技术。</p><h3 id="5-3-2-Expression和Func的区别"><a href="#5-3-2-Expression和Func的区别" class="headerlink" title="5.3.2 Expression和Func的区别"></a>5.3.2 Expression和Func的区别</h3><p>Expression存储了运算逻辑，数据处理是在数据库完成的，是服务器评估。</p><p>Func是委托，没有运算逻辑，将数据拉入内存操作，是客户端评估。</p><h3 id="5-3-3-可视化查看表达式树"><a href="#5-3-3-可视化查看表达式树" class="headerlink" title="5.3.3 可视化查看表达式树"></a>5.3.3 可视化查看表达式树</h3><h4 id="调试时查看"><a href="#调试时查看" class="headerlink" title="调试时查看"></a>调试时查看</h4><h4 id="使用插件ExpressionTreeVisualizer"><a href="#使用插件ExpressionTreeVisualizer" class="headerlink" title="使用插件ExpressionTreeVisualizer"></a>使用插件ExpressionTreeVisualizer</h4><h3 id="5-3-4-通过代码查看表达式树"><a href="#5-3-4-通过代码查看表达式树" class="headerlink" title="5.3.4 通过代码查看表达式树"></a>5.3.4 通过代码查看表达式树</h3><h4 id="安装ExpressionTreeToString拓展包"><a href="#安装ExpressionTreeToString拓展包" class="headerlink" title="安装ExpressionTreeToString拓展包"></a>安装ExpressionTreeToString拓展包</h4><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Console.WriteLine(e.ToString(<span class="string">&quot;Object notation&quot;</span>,<span class="string">&quot;C#&quot;</span>))</span><br></pre></td></tr></table></figure><h3 id="5-3-5-通过代码动态构建表达式树"><a href="#5-3-5-通过代码动态构建表达式树" class="headerlink" title="5.3.5 通过代码动态构建表达式树"></a>5.3.5 通过代码动态构建表达式树</h3><h3 id="5-3-6-让动态构建表达式树更简单"><a href="#5-3-6-让动态构建表达式树更简单" class="headerlink" title="5.3.6 让动态构建表达式树更简单"></a>5.3.6 让动态构建表达式树更简单</h3><p>使用<strong>ExpressionTreeToString</strong>，将ToString第一个参数改为“Factory Methods”</p><h3 id="5-3-7-让构建”动态“起来"><a href="#5-3-7-让构建”动态“起来" class="headerlink" title="5.3.7 让构建”动态“起来"></a>5.3.7 让构建”动态“起来</h3><p>先观察静态表达式，再推出动态的表达式。抽取动态表达式树通用部分进行重用。</p><h3 id="5-3-8不用Emit实现Select动态化"><a href="#5-3-8不用Emit实现Select动态化" class="headerlink" title="5.3.8不用Emit实现Select动态化"></a>5.3.8不用Emit实现Select动态化</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> .net </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.net Core: EF Core </title>
      <link href="/posts/65a8c7d5.html"/>
      <url>/posts/65a8c7d5.html</url>
      
        <content type="html"><![CDATA[<h1 id="4-EF-Core-基础"><a href="#4-EF-Core-基础" class="headerlink" title="4 EF Core 基础"></a>4 EF Core 基础</h1><h2 id="4-1-EF-Core-概述"><a href="#4-1-EF-Core-概述" class="headerlink" title="4.1 EF Core 概述"></a>4.1 EF Core 概述</h2><h3 id="4-1-1-ORM"><a href="#4-1-1-ORM" class="headerlink" title="4.1.1 ORM"></a>4.1.1 ORM</h3><p>实现双向转换</p><ol><li>对象：C#中的对象</li><li>关系：关系数据库</li><li>映射：在对象和关系数据库搭建桥梁。</li></ol><p>框架：EF Core、Dapper</p><h3 id="4-1-2-EF-Core-入门"><a href="#4-1-2-EF-Core-入门" class="headerlink" title="4.1.2 EF Core 入门"></a>4.1.2 EF Core 入门</h3><h4 id="4-1-2-1-搭建开发环境"><a href="#4-1-2-1-搭建开发环境" class="headerlink" title="4.1.2.1 搭建开发环境"></a>4.1.2.1 搭建开发环境</h4><ol><li><p>步骤：建实体类；建DbContext；生成数据库；编写调用EF Core代码。</p></li><li><p>Book.cs</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;<span class="comment">//主键</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;<span class="comment">//标题</span></span><br><span class="line">    <span class="keyword">public</span> DateTime PubTime &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;<span class="comment">//发布日期</span></span><br><span class="line">    <span class="keyword">public</span> Double Price &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;<span class="comment">//单价</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Install-Package Microsoft.EntityFrameworkCore.SqlServer -version 7.0.20 (.net 6.0)</p></li><li><p>配置实体类与数据库表对应关系</p> <figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">BookConfig</span>:<span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Book</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Book&gt; builder</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">       builder.ToTable(<span class="string">&quot;Book&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>创建继承自DbContext的类</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestDBContext</span>:<span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;Book&gt; Books &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment">//连接字符串，指定链接的数据库</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> connStr = <span class="string">&quot;Server=.;Database=demo1;Trusted_Connection=true&quot;</span>;</span><br><span class="line">        <span class="comment">//string connStr = “Server=localhost;Database=MyDatabase;User ID=myUsername;Password=myPassword”;</span></span><br><span class="line">        optionsBuilder.UseSqlServer(connStr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//加载程序集中所有实现了IEntityTypeConfiguration接口的类</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Install-Package Microsoft.EntityFrameworkCore.Tools</p></li><li><p>生成一次迁移，InitialCreate是迁移名称</p><p><code>Add-Migration InitialCreate</code></p></li><li><p>执行Update-database</p></li><li><p>修改表结构</p><p>1). 在Book类中添加字段</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Nation &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//添加的列 </span></span><br></pre></td></tr></table></figure><p>重复8、9</p><p>2). 限制最大长度和不可为空，在5中添加以下代码</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">builder.Property(e=&gt;e.Title).HasMaxLength(<span class="number">50</span>).IsRequired();</span><br><span class="line">builder.Property(e=&gt;e.Id).HasMaxLength(<span class="number">20</span>).IsRequired();</span><br></pre></td></tr></table></figure><p>重复8、9</p></li></ol><h4 id="4-1-2-2-EF-Core-增删改查"><a href="#4-1-2-2-EF-Core-增删改查" class="headerlink" title="4.1.2.2 EF Core 增删改查"></a>4.1.2.2 EF Core 增删改查</h4><ol><li><p>插入数据;</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> (TestDBContext test=<span class="keyword">new</span> TestDBContext())</span><br><span class="line">&#123;</span><br><span class="line">    Book b1 = <span class="keyword">new</span> Book();</span><br><span class="line">    b1.Title = <span class="string">&quot;Test&quot;</span>;</span><br><span class="line">    b1.Nation = <span class="string">&quot;China&quot;</span>;</span><br><span class="line">    test.Books.Add(b1);<span class="comment">//把对象b1加入到表里面</span></span><br><span class="line">    <span class="keyword">await</span> test.SaveChangesAsync();<span class="comment">//保存刷新表</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>查询数据</p></li></ol><p>大部分LINQ语句都能作用于EF Core</p><p>查询不需要SaveChangesAsync</p><ol start="3"><li><p>修改、删除数据</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> b = test.Books.Single(b =&gt; b.Title == <span class="string">&quot;book1&quot;</span>);<span class="comment">//先查询</span></span><br><span class="line">b.Title = <span class="string">&quot;SQL必知必会&quot;</span>;<span class="comment">//再修改</span></span><br><span class="line"><span class="keyword">var</span> b1 = test.Books.Single(b =&gt; b.Title == <span class="string">&quot;book3&quot;</span>);<span class="comment">//先查询</span></span><br><span class="line">test.Remove(b1);<span class="comment">//再删除</span></span><br><span class="line"><span class="keyword">await</span> test.SaveChangesAsync();<span class="comment">//最后保存</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="4-1-2-3-EF-Core实体配置"><a href="#4-1-2-3-EF-Core实体配置" class="headerlink" title="4.1.2.3 EF Core实体配置"></a>4.1.2.3 EF Core实体配置</h4><p>1）约定配置：（以下为最常用的四个）</p><p>规则1：数据库表名采用上下文类中对应的DbSet的属性名</p><p>规则2：数据库表列的名字采用<code>实体类属性</code>的名字，列的数据类型采用和<code>实体类属性</code>兼容的类型。</p><p>规则3：数据库表列的可空性取决于对应实体类属性的可空性。</p><p>规则4：名字为Id的属性为主键</p><p>2）配置方式：</p><ol><li><p>Data Annotation</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">table<span class="string">&quot;T_Books&quot;</span></span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">MaxLength(50)</span>]</span><br><span class="line">    [<span class="meta">Required</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Fluent API（建议使用）</p><p>见上一节第四项。</p></li></ol><p>3）Fluent API基本配置</p><p>补充</p><ol><li>生成列的值：ValueGeneratedOnAdd()</li><li>设置默认值：HasDefaultValue()</li></ol><blockquote><p>[🪧TIP]</p><p>EF Core高级特性使用需谨慎，尽量不与业务逻辑混合。</p></blockquote><ol start="3"><li>重载方法：推荐使用HasIndex(b&#x3D;&gt;b.Number)，可以利用C#的检查机制。</li></ol><p>4）链式调用</p><p>是否可以继续调用取决于调用的方法是否为前一个调用方法的返回值中的方法。</p><p>5）主键</p><table><thead><tr><th>主键类型</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>普通自增</td><td>简单</td><td>高并发性能差、数据库迁移麻烦</td></tr><tr><td>Guid</td><td>简单、高并发、全局唯一</td><td>磁盘占用空间大、需要设置为非聚集索引</td></tr><tr><td>混合自增和Guid</td><td>结合两者优点</td><td>减少风险</td></tr><tr><td>Hi&#x2F;Lo算法</td><td>中心化数据库</td><td>需要数据库支持</td></tr></tbody></table><h2 id="4-4-数据库迁移"><a href="#4-4-数据库迁移" class="headerlink" title="4.4 数据库迁移"></a>4.4 数据库迁移</h2><h3 id="Update-database其他参数"><a href="#Update-database其他参数" class="headerlink" title="Update-database其他参数"></a>Update-database其他参数</h3><p>既可升级又可回滚版本</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Update-database + Version</span><br></pre></td></tr></table></figure><h2 id="删除迁移脚本"><a href="#删除迁移脚本" class="headerlink" title="删除迁移脚本"></a>删除迁移脚本</h2><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Remove-migration</span><br></pre></td></tr></table></figure><h2 id="生成迁移脚本"><a href="#生成迁移脚本" class="headerlink" title="生成迁移脚本"></a>生成迁移脚本</h2><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Script-Migration</span><br></pre></td></tr></table></figure><p>通常在生产时使用，手动进行更新</p><h2 id="4-5-EF-Core生成的SQL语句"><a href="#4-5-EF-Core生成的SQL语句" class="headerlink" title="4.5 EF Core生成的SQL语句"></a>4.5 EF Core生成的SQL语句</h2><h2 id="EF-Core做不到的"><a href="#EF-Core做不到的" class="headerlink" title="EF Core做不到的"></a>EF Core做不到的</h2><p>存在C#语句不能被翻译成SQL语句的情况</p><h3 id="4-5-1-通过代码查看EF-Core生成的SQL语句"><a href="#4-5-1-通过代码查看EF-Core生成的SQL语句" class="headerlink" title="4.5.1 通过代码查看EF Core生成的SQL语句"></a>4.5.1 通过代码查看EF Core生成的SQL语句</h3><p>1.标准日志</p><p>2.简单日志:测试性代码</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">optionBuilder.LogTo(Console.WriteLine())</span><br></pre></td></tr></table></figure><p>3.ToQueryString：开发阶段，需要从大量操作中看到SQL</p><p>IQueryable的拓展方法</p><p>where的返回值为IQueryable</p><h3 id="4-5-2-EF-Core生成SQL语句的不同"><a href="#4-5-2-EF-Core生成SQL语句的不同" class="headerlink" title="4.5.2 EF Core生成SQL语句的不同"></a>4.5.2 EF Core生成SQL语句的不同</h3><h2 id="4-6-关系配置"><a href="#4-6-关系配置" class="headerlink" title="4.6 关系配置"></a>4.6 关系配置</h2><p>实体类关系属性、<strong>FluentAPI关系配置</strong>、使用关系操作</p><h3 id="4-6-1-一对多"><a href="#4-6-1-一对多" class="headerlink" title="4.6.1 一对多"></a>4.6.1 一对多</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">HasXXX(...).WithXXX(...)</span><br></pre></td></tr></table></figure><p>XXX:可选One和Many</p><p>一对多：HasOne(…).WithMany(…)</p><p>举例：文章和评论</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//文章类    </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Article</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Message &#123;  <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Comment&gt; Comments=<span class="keyword">new</span> List&lt;Comment&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//文章类配置</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ArticleConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Article</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Article&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Article&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//评论类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Comment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Message &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Article Article &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//评论类配置</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">CommentConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Comment</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Comment&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Comments&quot;</span>);</span><br><span class="line">        builder.Property(a=&gt;a.Message).HasMaxLength(<span class="number">128</span>).IsUnicode().IsRequired();</span><br><span class="line">        builder.HasOne&lt;Article&gt;(c =&gt; c.Article).WithMany(c=&gt;c.Comments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//操作数据库 </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyDBContxt</span>:<span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;Article&gt; Articles &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnConfiguring(optionsBuilder);</span><br><span class="line">        optionsBuilder.UseSqlServer(<span class="string">&quot;Server=.;Database=demo2;Trusted_Connection=true;TrustServerCertificate=true&quot;</span>);</span><br><span class="line">        optionsBuilder.LogTo(Console.WriteLine);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        <span class="comment">//从当前程序集加载所有的IEntityTypeConfiguration</span></span><br><span class="line">        modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//添加数据</span></span><br><span class="line"><span class="keyword">using</span> (MyDBContxt ctx=<span class="keyword">new</span> MyDBContxt())</span><br><span class="line">&#123;</span><br><span class="line">    Article a1= <span class="keyword">new</span> Article();</span><br><span class="line">    a1.Title = <span class="string">&quot;文章1&quot;</span>;</span><br><span class="line">    a1.Message=<span class="string">&quot;这是文章内容&quot;</span>; </span><br><span class="line"></span><br><span class="line">    Comment c1 = <span class="keyword">new</span> Comment();</span><br><span class="line">    c1.Message = <span class="string">&quot;这是评论1&quot;</span>;</span><br><span class="line">    Comment c2 = <span class="keyword">new</span> Comment();</span><br><span class="line">    c2.Message = <span class="string">&quot;this is second comment&quot;</span>;</span><br><span class="line">    a1.Comments.Add(c1);</span><br><span class="line">    a1.Comments.Add(c2);</span><br><span class="line">    ctx.Articles.Add(a1);</span><br><span class="line">    ctx.SaveChanges();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-6-2-获取关系数据"><a href="#4-6-2-获取关系数据" class="headerlink" title="4.6.2 获取关系数据"></a>4.6.2 获取关系数据</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> (MyDBContxt ctx=<span class="keyword">new</span> MyDBContxt())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//include</span></span><br><span class="line">    Article a = ctx.Articles.Include(a=&gt;a.Comments).Single(a=&gt;a.Id==<span class="number">3</span>);</span><br><span class="line">    Console.WriteLine(a.Id);</span><br><span class="line">    Console.WriteLine(a.Title);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> a.Comments)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(item.Message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-6-3-单向导航属性"><a href="#4-6-3-单向导航属性" class="headerlink" title="4.6.3 单向导航属性"></a>4.6.3 单向导航属性</h3><p>当被频繁引用的实体不需要导航属性。</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//用户类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//用户配置</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">User</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;User&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_User&quot;</span>);</span><br><span class="line">        builder.Property(u=&gt;u.Name).HasMaxLength(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请假类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Leave</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> ID &#123;  <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> User Requester &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> User? Approver &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Remark &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请假配置</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LeaveConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Leave</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Leave&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Leave&quot;</span>);</span><br><span class="line">        builder.HasOne&lt;User&gt;(u=&gt;u.Requester).WithMany().IsRequired();</span><br><span class="line">        builder.HasOne&lt;User&gt;(u=&gt;u.Approver).WithMany();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在MyDBContxt中添加</span></span><br><span class="line"><span class="keyword">public</span> DbSet&lt;User&gt; Users &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="keyword">public</span> DbSet&lt;Leave&gt; Leaves &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br></pre></td></tr></table></figure><h3 id="4-6-4-自引用组织结构"><a href="#4-6-4-自引用组织结构" class="headerlink" title="4.6.4 自引用组织结构"></a>4.6.4 自引用组织结构</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrgUnitConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">OrgUnit</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;OrgUnit&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_OrgUnit&quot;</span>);</span><br><span class="line">        <span class="comment">//在配置后需要添加OnDelete(enum DeleteBehavior)级联删除，枚举类型DeleteBehavior&#123;Restrict, SetNull, , &#125;</span></span><br><span class="line">        builder.HasOne&lt;OrgUnit&gt;(o =&gt; o.Parent).WithMany(p =&gt; p.Children).OnDelete(DeleteBehavior.Restrict);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">region</span> 测试数据插入</span></span><br><span class="line">OrgUnit orgUnitFirst = <span class="keyword">new</span> OrgUnit() &#123; Name = <span class="string">&quot;总公司&quot;</span> &#125;;</span><br><span class="line">OrgUnit orgUnitSecond = <span class="keyword">new</span> OrgUnit() &#123; Name = <span class="string">&quot;分公司1&quot;</span> &#125;;</span><br><span class="line">OrgUnit orgUnitSecond2 = <span class="keyword">new</span> OrgUnit() &#123; Name = <span class="string">&quot;分公司2&quot;</span> &#125;;</span><br><span class="line">OrgUnit orgUnitSecondPart = <span class="keyword">new</span> OrgUnit() &#123; Name = <span class="string">&quot;分公司1办公室&quot;</span> &#125;;</span><br><span class="line">orgUnitSecond.Parent = orgUnitFirst;</span><br><span class="line">orgUnitSecond2.Parent = orgUnitFirst;</span><br><span class="line">orgUnitSecondPart.Parent = orgUnitSecond;</span><br><span class="line">orgUnitFirst.Children.Add(orgUnitSecond);</span><br><span class="line">orgUnitFirst.Children.Add(orgUnitSecond2);</span><br><span class="line">orgUnitSecond.Children.Add(orgUnitSecondPart);</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> (MyDBContxt ctx=<span class="keyword">new</span> MyDBContxt())</span><br><span class="line">&#123;</span><br><span class="line">    ctx.OrgUnits.Add(orgUnitFirst);</span><br><span class="line">    <span class="comment">//ctx.OrgUnits.Add(orgUnitSecond);</span></span><br><span class="line">    <span class="comment">//ctx.OrgUnits.Add(orgUnitSecond2);</span></span><br><span class="line">    <span class="comment">//ctx.OrgUnits.Add(orgUnitSecondPart);</span></span><br><span class="line">    ctx.SaveChanges();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">region</span> 测试递归缩进打印</span></span><br><span class="line">        <span class="keyword">using</span> (MyDBContxt ctx = <span class="keyword">new</span> MyDBContxt())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> ogRoot = ctx.OrgUnits.Single(o =&gt; o.Parent == <span class="literal">null</span>);</span><br><span class="line">            PrintChild(<span class="number">1</span>, ogRoot, ctx);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintChild</span>(<span class="params"><span class="built_in">int</span> level, OrgUnit parent, MyDBContxt ctx</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> children = ctx.OrgUnits.Where(o =&gt; o.Parent == parent).ToList();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> children)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="keyword">new</span> String(<span class="string">&#x27;\t&#x27;</span>, level) + item.Name);</span><br><span class="line">            PrintChild(level + <span class="number">1</span>, item, ctx);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> .net </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库1</title>
      <link href="/posts/a0116265.html"/>
      <url>/posts/a0116265.html</url>
      
        <content type="html"><![CDATA[<h1 id="1-表的相关数据"><a href="#1-表的相关数据" class="headerlink" title="1 表的相关数据"></a>1 表的相关数据</h1><h2 id="1-1基础内容"><a href="#1-1基础内容" class="headerlink" title="1.1基础内容"></a>1.1基础内容</h2><ol><li>字段：一个事物的某一个特征</li><li>记录：字段的组合，表示一个具体的事物</li><li>表：记录的组合，表示同一类型事物的集合</li><li>1、2、3的关系：字段是事物的属性，记录是事物本身，表是事物的集合</li><li>列、属性、元组：分别是字段、字段、记录的另一种称谓</li><li>主键：唯一标识</li></ol><h2 id="1-1-2"><a href="#1-1-2" class="headerlink" title="1.1.2"></a>1.1.2</h2><p>右键设置主键</p><p>外键表：有外键字段的表</p><h3 id="1-1-3-MicroSoft-SQL-Server设置"><a href="#1-1-3-MicroSoft-SQL-Server设置" class="headerlink" title="1.1.3 MicroSoft SQL Server设置"></a>1.1.3 MicroSoft SQL Server设置</h3><ol><li>工具 &#x3D;&gt; 选项 &#x3D;&gt; 设计器 &#x3D;&gt; 表设计器和数据库设计器 &#x3D;&gt; 取消勾选”阻止保存要求重新创建表的更改”</li><li>工具 &#x3D;&gt; 选项 &#x3D;&gt; SQLserver对象资源管理器 &#x3D;&gt; 命令 &#x3D;&gt; 编辑前N行命令值, 将200修改为0</li></ol><h2 id="1-2-create-table-命令"><a href="#1-2-create-table-命令" class="headerlink" title="1.2 create table 命令"></a>1.2 create table 命令</h2><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>butterfly 更改顶图和背景</title>
      <link href="/posts/eb83d88e.html"/>
      <url>/posts/eb83d88e.html</url>
      
        <content type="html"><![CDATA[<h1 id="Butterfly主题-一图流背景与顶部图修改"><a href="#Butterfly主题-一图流背景与顶部图修改" class="headerlink" title="Butterfly主题 一图流背景与顶部图修改"></a>Butterfly主题 一图流背景与顶部图修改</h1><p>配置参数：<br>index_img：网站背景<br>index_top_img_height：顶图高度<br>background：顶图背景<br>footer_bg：页脚背景<br>mask.header：遮罩<br>原文地址：<a href="https://android99.com/2021/08/10/butterfly-top-image-modify/">Butterfly主题 一图流背景与顶部图修改</a></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>butterfly 折腾合集</title>
      <link href="/posts/5a9dcefa.html"/>
      <url>/posts/5a9dcefa.html</url>
      
        <content type="html"><![CDATA[<h1 id="butterfly-折腾合集"><a href="#butterfly-折腾合集" class="headerlink" title="butterfly 折腾合集"></a>butterfly 折腾合集</h1><p><a href="https://bigpina.github.io/posts/eb83d88e.html">1.更改顶图和背景</a></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET core: 日志</title>
      <link href="/posts/fb2f0a84.html"/>
      <url>/posts/fb2f0a84.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="3-3-日志系统"><a href="#3-3-日志系统" class="headerlink" title="3.3 日志系统"></a>3.3 日志系统</h2><p>需要引用以下几个包</p><p>Microsoft.Extensions.DependencyInjection;</p><p>Microsoft.Extensions.Logging</p><p>Microsoft.Extensions.Logging.Console;</p><h4 id="3-3-2-1-使用NLog"><a href="#3-3-2-1-使用NLog" class="headerlink" title="3.3.2.1 使用NLog"></a>3.3.2.1 使用NLog</h4><p>配置文件需要选择“如果较新则复制”</p><h4 id="3-3-2-2-NLog深入"><a href="#3-3-2-2-NLog深入" class="headerlink" title="3.3.2.2 NLog深入"></a>3.3.2.2 NLog深入</h4><h5 id="按照命名空间过滤日志"><a href="#按照命名空间过滤日志" class="headerlink" title="按照命名空间过滤日志"></a>按照命名空间过滤日志</h5><ol><li><p>新建命名空间</p></li><li><p>新建日志输出类</p></li><li><p>设置输出条件</p></li></ol><h5 id="nlog-config中的关键字"><a href="#nlog-config中的关键字" class="headerlink" title="nlog.config中的关键字"></a>nlog.config中的关键字</h5><p>archiveAboveSize：超过多少字节就把日志存档。</p><p>maxArchiveFiles：最大文件数</p><p>final设置为true，匹配后不再向下匹配</p><p>NLog使用时尽量使用NLog自身的日志等级过滤方法，避免冲突</p><h2 id="3-4-结构化日志和集中式日志"><a href="#3-4-结构化日志和集中式日志" class="headerlink" title="3.4 结构化日志和集中式日志"></a>3.4 结构化日志和集中式日志</h2><h3 id="3-4-1-结构化日志"><a href="#3-4-1-结构化日志" class="headerlink" title="3.4.1 结构化日志"></a>3.4.1 结构化日志</h3><p>安装Serilog.AspNetCore</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Log.Logger = <span class="keyword">new</span> LoggerConfiguration()</span><br><span class="line">.MinimumLevel.Debug()</span><br><span class="line">.Enrich.FromLogContext()</span><br><span class="line">.WriteTo.Console(<span class="keyword">new</span> JsonFormatter())</span><br><span class="line">.CreateLogger();</span><br><span class="line">LogBuilder.AddSerilog();</span><br></pre></td></tr></table></figure><h3 id="3-4-2-集中式日志"><a href="#3-4-2-集中式日志" class="headerlink" title="3.4.2 集中式日志"></a>3.4.2 集中式日志</h3><p>Exceptionless、ELK</p><blockquote><p>🪧🪧🪧</p><p>解决方案的能力</p></blockquote><h3 id="3-4-3-总结"><a href="#3-4-3-总结" class="headerlink" title="3.4.3 总结"></a>3.4.3 总结</h3><p>1、普通项目使用NLog输出至文本文件中即可。</p><p>2、集群部署用Serilog+集中式日志</p><p>3、云服务或Exceptionless本地部署</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> ASP.net Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Avalonia</title>
      <link href="/posts/3f413ee7.html"/>
      <url>/posts/3f413ee7.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="Avalonia不显示中文"><a href="#Avalonia不显示中文" class="headerlink" title="Avalonia不显示中文"></a>Avalonia不显示中文</h3><p>下载字体后放入Assets文件夹，然后引用字体。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FontFamily=&quot;avares://Avalonia2024年9月8日/Assets/MicroSoft Yahei.ttf#Microsoft YaHei&quot;</span><br></pre></td></tr></table></figure><h1 id="2024年9月8日"><a href="#2024年9月8日" class="headerlink" title="2024年9月8日"></a>2024年9月8日</h1><p>不显示预览，报错No Exetutable。     </p><p>Desktop 必须勾选</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> Avalonia </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>程序：打开不同类型文件</title>
      <link href="/posts/2da389c1.html"/>
      <url>/posts/2da389c1.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无 </p></blockquote><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">namespace 打开文件程序</span><br><span class="line">&#123;</span><br><span class="line">    internal class Program</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;请选择要进入的磁盘&quot;);</span><br><span class="line">            string path = Console.ReadLine();</span><br><span class="line">            Console.WriteLine(&quot;请选择要打开的文件&quot;);</span><br><span class="line">            string fileName = Console.ReadLine();</span><br><span class="line">            string filePath = path + fileName;</span><br><span class="line">            //里氏转换,将子类赋值给父类</span><br><span class="line">            OpenFile openFile = GetFile(fileName);</span><br><span class="line">            //调用文件打开方法</span><br><span class="line">            openFile.Open(filePath);</span><br><span class="line">        &#125;</span><br><span class="line">        //简单工厂设计模式，根据文件类型不同，返回不同的子类</span><br><span class="line">        public static OpenFile GetFile(string fileName)</span><br><span class="line">        &#123;</span><br><span class="line">            //建立一个父类</span><br><span class="line">            OpenFile openFile = null;</span><br><span class="line">            //获取文件后缀</span><br><span class="line">            string fileType = fileName.Substring(fileName.LastIndexOf(&#x27;.&#x27;) + 1, 3);</span><br><span class="line">            //根据文件类型确定子类</span><br><span class="line">            switch (fileType)</span><br><span class="line">            &#123;</span><br><span class="line">                case &quot;txt&quot;:</span><br><span class="line">                    openFile = new TxtOpen();</span><br><span class="line">                    break;</span><br><span class="line">                default:</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">            return openFile;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 父类</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public class OpenFile</span><br><span class="line">    &#123;</span><br><span class="line">        string _fileName;</span><br><span class="line">        public string FileName</span><br><span class="line">        &#123; get; set; &#125;</span><br><span class="line">        string _path;</span><br><span class="line">    </span><br><span class="line">        public OpenFile()</span><br><span class="line">        &#123;</span><br><span class="line">            //this._path = filePath;</span><br><span class="line">        &#125;</span><br><span class="line">        public void Open(string filePath)</span><br><span class="line">        &#123;</span><br><span class="line">            ProcessStartInfo psi = new ProcessStartInfo(filePath);</span><br><span class="line">            Process p = new Process();</span><br><span class="line">            p.StartInfo = psi;</span><br><span class="line">            p.Start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 子类</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public class TxtOpen : OpenFile</span><br><span class="line">    &#123;</span><br><span class="line">        public TxtOpen()</span><br><span class="line">        &#123;</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>设计模式</title>
      <link href="/posts/364ea8cc.html"/>
      <url>/posts/364ea8cc.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="1-简单工厂"><a href="#1-简单工厂" class="headerlink" title="1. 简单工厂"></a>1. 简单工厂</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>进阶：S7-1500</title>
      <link href="/posts/5e62758.html"/>
      <url>/posts/5e62758.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="第一节：1500和1200区别"><a href="#第一节：1500和1200区别" class="headerlink" title="第一节：1500和1200区别"></a>第一节：1500和1200区别</h2><ul><li>1.1 硬件特性<ul><li>1）1500最多拓展30个模块</li><li>2）1500位指令执行速度更快</li><li>3）200个点（SMART）1000个点（1200）1000个点以上（1500）</li><li></li></ul></li></ul><h2 id="第二节：分类"><a href="#第二节：分类" class="headerlink" title="第二节：分类"></a>第二节：分类</h2><ul><li>PN（网口）、DP（串口）</li><li>无字（标准型）、C（紧凑型）、T（工艺型）、F（故障安全型）、R或H（冗余型）</li><li>运行灯、故障灯、数据灯（由左至右）</li></ul><h2 id="第三节：硬件实物"><a href="#第三节：硬件实物" class="headerlink" title="第三节：硬件实物"></a>第三节：硬件实物</h2><ul><li><p>3.1 数字量输入模块</p><ul><li>HF代表高性能，带有高速计数</li><li>BA代表基本型、ST标准型</li></ul></li><li><p>3.2 数字量输出模块</p><ul><li>例子：1接KA的14，13出来接负</li><li>属性-&gt;通道模板-&gt;诊断</li></ul></li><li><p>3.3 模拟量输入模块</p></li><li><p>3.4 模拟量输出模块</p><ul><li>查看说明书</li></ul></li><li><p>3.5 高速计数器</p><ul><li>编码器接入到高性能DI模块（只有通道0和通道1有）或专用计数器模块</li><li>启用0通道和1通道上的计数器</li><li>启用后会出现输出地址</li><li>字节X+4到X+11对应通道0</li><li>从IBX+4的4个字节，代表当前计数值</li><li>IBX+8，代表状态区，IB(X+8).0达到条件后输出，置1</li><li>设置初始值：</li><li>输出：<ul><li>X+0到X+7对应通道0输出。X+4是状态区QB(X+4)<br>  *【 QB(X+4).2，QB(X+4).1，QB(X+4).0】000无操作，001装载计数值，011装载起始值（初始值是上次计数值）</li><li>软件门：QB(X+4).3，0停止，1启动</li></ul></li><li>高速计数器模块：工艺<ul><li>A0, B0, [接黑白]</li><li>N0, DI, DQ</li><li>西门子NPN是源型</li></ul></li></ul></li></ul><h2 id="第四节：通信"><a href="#第四节：通信" class="headerlink" title="第四节：通信"></a>第四节：通信</h2><ul><li>4.1 1500与1200<br>  * </li><li>4.2 1500与1500<br>  * </li><li>4.3 触摸屏<ul><li></li></ul></li></ul><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>汇川伺服调试参数</title>
      <link href="/posts/2d48590f.html"/>
      <url>/posts/2d48590f.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电工知识</title>
      <link href="/posts/57df7c97.html"/>
      <url>/posts/57df7c97.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="2024年5月5日"><a href="#2024年5月5日" class="headerlink" title="2024年5月5日"></a>2024年5月5日</h2><table><thead><tr><th align="left">器具的额定电流（A）</th><th align="left">软线截面积（mm²）</th><th align="left">用于固定布线的电缆截面积（mm²）</th></tr></thead><tbody><tr><td align="left">≤3</td><td align="left">0.5 和 0.75</td><td align="left">1-2.5</td></tr><tr><td align="left">＞3 和≤6</td><td align="left">0.75 和 1</td><td align="left">1-2.5</td></tr><tr><td align="left">＞6 和≤10</td><td align="left">1 和 1.5</td><td align="left">1-2.5</td></tr><tr><td align="left">＞10 和≤16</td><td align="left">1.5 和 2.5</td><td align="left">1.5-4</td></tr><tr><td align="left">＞16 和≤25</td><td align="left">2.5 和 4</td><td align="left">2.5-6</td></tr><tr><td align="left">＞25 和≤32</td><td align="left">4 和 6</td><td align="left">4-10</td></tr><tr><td align="left">＞32 和≤40</td><td align="left">6 和 10</td><td align="left">6-16</td></tr><tr><td align="left">＞40 和≤63</td><td align="left">10 和 16</td><td align="left">10-25</td></tr></tbody></table><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 电工 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Siemens PLC 1200</title>
      <link href="/posts/5d7c375d.html"/>
      <url>/posts/5d7c375d.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="第一节：区别对比"><a href="#第一节：区别对比" class="headerlink" title="第一节：区别对比"></a>第一节：区别对比</h2><ol><li><p>1200 可以仿真</p></li><li><p>硬件、软件分开下载</p></li><li><p>FC（函数）、FB（函数块）</p></li><li><p>OB（中断程序）（非重点）</p></li><li><p>定时器（最大21天）、计数器：自行创建，个数取决于内存。</p></li><li><p>M存储区和DB块</p></li><li><p>变量表</p></li><li><p>监控和强制表</p></li><li><p>一个程序段可以有多个回路</p></li><li><p>指令可以直接连左母线</p></li><li><p>模拟量输入 IW</p></li><li><p>模拟量输出 QW</p></li><li><p>高速计数器变为 ID，ID1000（默认）、ID1004</p></li></ol><h2 id="第二节：1200-硬件"><a href="#第二节：1200-硬件" class="headerlink" title="第二节：1200 硬件"></a>第二节：1200 硬件</h2><p>CPU 1211C DC&#x2F;DC&#x2F;DC</p><p>AC：交流电<br>DC：直流电<br>Rly：继电器输出</p><p>DC&#x2F;DC&#x2F;DC (PLC、I点、O点)<br>SIPLUS 宽温型</p><p>1211C：C代表紧凑型<br>CM&#x2F;CP：通信模块（串口和网口）<br>SM：信号模块（开关量和模拟量）（DI&#x2F;DQ&#x2F;AI&#x2F;AQ）最多8个</p><p>CPU 1500：</p><p>PM&#x2F;PS（负载电源&#x2F;系统电源）：PS可以放在中间。（无需组态）<br>CPU：<br>最多32个模块</p><p>分布式I&#x2F;O</p><table><thead><tr><th align="left">PLC型号</th><th align="left">特点</th></tr></thead><tbody><tr><td align="left">1212C</td><td align="left">8DI和6DQ，4个高速输入，4个高速输出，2个模拟量输入</td></tr><tr><td align="left">1214C</td><td align="left">14DI和10DQ，6个高速输入，4个高速输出，2个模拟量输入</td></tr><tr><td align="left">1215C</td><td align="left">8DI和6DQ，6个高速输入，4个高速输出，2个AI，2个AQ</td></tr></tbody></table><h2 id="第三节：1500-硬件"><a href="#第三节：1500-硬件" class="headerlink" title="第三节：1500 硬件"></a>第三节：1500 硬件</h2><ol><li>分类</li></ol><table><thead><tr><th align="left">1500 PLC型号</th><th>特点</th></tr></thead><tbody><tr><td align="left">标准型</td><td>无字</td></tr><tr><td align="left">紧凑型</td><td>带C</td></tr><tr><td align="left">工艺（运动）型</td><td>带T</td></tr><tr><td align="left">故障安全型</td><td>带F</td></tr><tr><td align="left">冗余型</td><td>带H或R</td></tr></tbody></table><p>CPU 1517T-3PN&#x2F;DP：必须插卡</p><p>T：运动<br>3：三个通信口<br>PN：网口<br>DP：串口</p><ol start="2"><li><p>接口模块</p><p> 和分布式IO通讯。</p></li><li><p>通信模块</p></li><li><p>工艺模块</p><p> 高速计数：TMCount2×24V，支持增量编码器<br> 位置检测：<br> 时间戳模块：<br> PTO脉冲输出模块：TMPTO4<br> 称重模块：</p></li><li><p>总结：</p></li></ol><h2 id="第四节：软件基础操作"><a href="#第四节：软件基础操作" class="headerlink" title="第四节：软件基础操作"></a>第四节：软件基础操作</h2><ul><li><p>4.1 下载</p><p>  1）在CPU上右击PLC-&gt;下载到设备-&gt;硬件配置<br>  2）程序更新选择“软件（全部下载）”</p></li><li><p>4.2 上传</p><p>  4.2.1 菜单栏“在线”-&gt;将设备作为新站上传</p><p>  4.2.2 添加设备-&gt;CPU-&gt;非指定的CPU-&gt;获取</p></li></ul><p>Tips：PG&#x2F;PC接口：PN&#x2F;IE</p><ul><li><p>4.3 起保停</p><p>  1）右击“重命名变量”。<br>  2）下载“硬件配置”。</p></li><li><p>4.4 仿真</p></li></ul><h2 id="第五节：数据类型"><a href="#第五节：数据类型" class="headerlink" title="第五节：数据类型"></a>第五节：数据类型</h2><ul><li><p>5.1 SMART数据类型</p><table><thead><tr><th>序号</th><th>类型</th><th>符号</th><th>位数</th><th>存储区</th><th>备注</th></tr></thead><tbody><tr><td>1</td><td>位(bit)</td><td>BOOL</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>2</td><td>字节</td><td>byte</td><td>8位</td><td>IB0 VB0 QB0 MB0 QB0</td><td>非负数</td></tr><tr><td>3</td><td>字</td><td>WORD</td><td>16位</td><td>IW0</td><td>非负数</td></tr><tr><td>4</td><td>双字</td><td>DWORD</td><td>32位</td><td>VD0</td><td>非负数</td></tr><tr><td>5</td><td>双整数</td><td>DINT</td><td>32位</td><td>&#x2F;</td><td>有正负</td></tr><tr><td>6</td><td>浮点数</td><td>REAL</td><td>32位</td><td>VD</td><td>有正负</td></tr><tr><td>7</td><td>TIME</td><td>&#x2F;</td><td>32位</td><td>&#x2F;</td><td>-24天~24天</td></tr></tbody></table></li><li><p>5.2 新增类型</p><p>  |序号|符号|位数|备注|<br>  |–|–|–|–|–|–|<br>  |1|USINT|8位|0-255|<br>  |2|UINT|16位|0-65535|<br>  |3|UDINT|32位|无|<br>  |4|SINT|8位|无|<br>  |5|LREAL|64位|无|</p></li><li><p>5.3 分类</p><ol><li>基本数据类型</li><li>复杂数据类型</li><li>自定义（结构）</li></ol></li><li><p>5.4 DB块（数据块）</p><p>  数据类型、存储区、寻址方式</p><p>  寻址方式：直接寻址（在指令给出存储器或寄存器）、立即寻址（数据以常量的形式出现在指令中）、间接寻址（使用地址指针给出要访问的存储区或寄存器地址，通讯中常见）</p><ul><li>1 DB块有1位，8位，16位，32位。</li><li>2 添加新块 -&gt; 全局DB -&gt; 属性&#x2F;取消优化</li></ul><p>  偏移量就是地址。  </p></li><li><p>5.5 置位、复位</p><ul><li>5.5.1 常开、常闭、线圈</li><li>5.5.2 取反NOT、取反线圈</li><li>5.5.3 置位和复位</li><li>5.5.4 置位位域、复位位域</li><li>5.5.5 SR和RS指令</li><li>5.5.6 上升沿、下降沿</li></ul></li></ul><h2 id="第六节：定时器和计数器"><a href="#第六节：定时器和计数器" class="headerlink" title="第六节：定时器和计数器"></a>第六节：定时器和计数器</h2><ul><li><p>6.1 定时器和计数器</p><ul><li>1）种类：TON、TOF、TONR、TP（脉冲型：触发一次就开始计时，Q点得电，时间到，Q点失电）</li><li>2）计数器：CTU、CTD、CTUD<blockquote><p>建立方法：自动建立或手动建立DB块</p></blockquote></li><li>3）PLC-&gt;常规-&gt;系统和时钟存储器</li></ul></li><li><p>6.2</p></li></ul><h2 id="第七节：功能指令"><a href="#第七节：功能指令" class="headerlink" title="第七节：功能指令"></a>第七节：功能指令</h2><ul><li><p>7.1 传送</p><ul><li>1）MOVE、MOVE_BLK、FILL_BLK</li><li>2）S7-1200只能以数组来传递数据。</li><li>3）SWAP：交换（了解即可）</li></ul></li><li><p>7.2 比较</p><ul><li>1）</li></ul><p>  <img src="/posts/5d7c375d/Compare.png" alt="比较指令">  </p></li><li><p>7.3 转换指令</p><p>  <img src="/posts/5d7c375d/Trans.png" alt="转换指令"></p><ul><li>1）Convert：</li></ul></li><li><p>7.4 数学函数（运算指令）</p><ul><li>1）CALCULATE：</li></ul></li></ul><h2 id="第八节：FC和FB（都是子程序）"><a href="#第八节：FC和FB（都是子程序）" class="headerlink" title="第八节：FC和FB（都是子程序）"></a>第八节：FC和FB（都是子程序）</h2><blockquote><p>必须用main[OB1]调用</p></blockquote><ul><li><p>8.1 FC（函数）（无背景DB）</p><ul><li>1）函数没有专用存储区</li><li>2）分为带参（input、output、inout、temp、constant）和不带参</li><li>3）经常用作不带参子程序</li></ul></li><li><p>8.2 FB（函数块）（有专用背景DB）</p><ul><li>1）分为带参（input、output、inout、static、temp、constant）和不带参</li><li>2）单个实例：调用一次，只为一个FB。</li><li>3）FB可以保持循环扫描结果，FC不行。</li></ul></li><li><p>8.3 OB（组织块）</p></li><li><p>8.4 DB（全局DB、背景DB）</p></li></ul><h2 id="第九节：步进控制"><a href="#第九节：步进控制" class="headerlink" title="第九节：步进控制"></a>第九节：步进控制</h2><ul><li><p>9.1 选型</p><ul><li>1）PLC、步进驱动器、电机</li><li>2）伺服运动控制类型：PTO（脉冲，开环）（最多4个轴）、PROFIdrive（通信、闭环）（最多16个轴）、模拟量（闭环）（最多8个轴）</li><li>3）1200所有Q点都能发脉冲</li><li>4）PWM：脉宽调制。</li><li>5）</li></ul></li><li><p>9.2 接线</p></li><li><p>9.3 组态</p><ul><li>1）工艺对象-&gt;新增对象-&gt;运动控制-&gt;轴</li><li>2）启动&#x2F;停止速度：设置的所有速度大于此速度。</li><li>3）接近速度：快。回原点速度：慢。</li><li>4）归为开关侧：在原点开关两边。</li></ul></li><li><p>9.4 调试</p></li><li><p>9.5 程序</p><ul><li><p>1）启用轴[MC_Power]：</p></li><li><p>2）复位轴[MC_Reset]:</p><ul><li>确认错误。</li></ul></li><li><p>3）回原点[MC_Home]:</p><ul><li>主动回原点（Mode &#x3D; 3）</li></ul><p>  自动执行回原点步骤。必须有限位开关</p><ul><li>被动回原点（Mode &#x3D; 2）</li></ul><p>  被动回原点期间，运动控制指令“MC_Home”不会执行任何回原点运动。用户需通过其它运动控制指令，执行这一步骤中所需的行进移动。检测到回原点开关时，轴即回原点。</p><ul><li>直接绝对回原点（Mode &#x3D; 0）</li></ul><p>  将当前的轴位置设置为参数“Position”的值。</p><ul><li>直接相对回原点（Mode &#x3D; 1）</li></ul><p>  将当前轴位置的偏移值设置为参数“Position”的值。（绝对＋相对）</p></li><li><p>4）暂停轴[MC_Halt]</p></li><li><p>5）绝对定位[MC_MoveAbsolute]</p><ul><li>定位指令用不用沿都可以</li></ul></li><li><p>6）相对定位</p></li><li><p>7）手动[MC_MoveJog]：不能用沿触发</p></li><li><p>8）恒速[MC_MoveVelocity]</p></li></ul></li><li><p>9.6 细节 </p><ul><li>位置和速度信息在轴的DB编辑器中。</li></ul></li></ul><h2 id="第十节：编码器和高速计数器"><a href="#第十节：编码器和高速计数器" class="headerlink" title="第十节：编码器和高速计数器"></a>第十节：编码器和高速计数器</h2><ul><li>10.1 硬件<ul><li>1）</li></ul></li><li>10.2 组态<ul><li>1）启用高速计数器</li><li>2）计数、单相、硬件输入</li><li>3）滤波：在数字量输入-&gt;0.1 microsec</li><li>4）门输入：相当于外部按钮（不能用强制），启用或禁用计数。硬件输入中选择门输入。</li><li>5）同步输入：相当于外部按钮复位或清零。</li></ul></li><li>10.3 指令<ul><li>1）控制高速计数器：</li><li>2）扩展高速计数器：HSC（HSC标识符）、CTRL（数据类型 Vari）<ul><li>新建DB块，新建数据类型HSC_Count</li><li>EnHSC：计数使能。</li><li>CurrentCount：当前计数值。</li><li>Ensync：复位计数器。必须和同步输入同时执行。</li><li>组态完成后需要指令。</li></ul></li><li>3）编码器断电保持：<ul><li>DB块中勾选保持</li><li>添加控制功能，按下启动就传入保持值。</li></ul></li></ul></li></ul><h2 id="第十一节：开放式TCPIP通信、S7通信"><a href="#第十一节：开放式TCPIP通信、S7通信" class="headerlink" title="第十一节：开放式TCPIP通信、S7通信"></a>第十一节：开放式TCPIP通信、S7通信</h2><ul><li><p>11.1 开放式TCPIP通信</p><ul><li>1）组态plc，勾选时钟存储器</li><li>2）连接机制：PUT&#x2F;GET访问</li><li>3）组态另一台PLC，步骤同1）、2） </li><li>4）PLC在同一个网段：网络视图</li></ul></li><li><p>11.2 指令</p><ul><li><p>1）TSEND_C：点开右上角组态。连接数据：新建。</p><ul><li>REQ：选择脉冲</li></ul></li><li><p>2）TRCV_C：点开右上角组态。</p><ul><li>EN_R：</li></ul></li></ul></li><li><p>11.3 拓展 </p><ul><li>1）P#DB0.DBX0.0 REAL（数据类型） 1（个数）</li></ul></li><li><p>11.3 S7通信（西门子产品）</p><ul><li>1）组态，时钟，PUT&#x2F;GET</li><li>2）网络视图</li><li>3）一台PLC建立DB1，建立一个位，作为发送，调用PUT指令</li><li>4）另一台建立DB1，建立1个位，作为接收，不需要调用指令</li><li>5）PUT：SD_1（发送到ADDR_1)（发送端地址）、ADDR_1（接收端地址）</li><li>6）GET：</li><li>7）SMART中只能传到V区，代号DB1.DBX0.0 REAL 1</li></ul></li><li><p>11.4 多条通讯指令</p><ul><li>1）上一条通信完成位触发下一条指令。</li><li>2）都用脉冲触发。</li></ul></li><li><p>11.5 建议</p><ul><li>1）网口通讯，最少以字节为单位。</li><li>2）串口通信，最少以16位为单位。</li><li>3）设置M断电保持，多次下载后空间会出现已满的情况。DB区断电后不会出现。</li><li></li></ul></li></ul><h2 id="第十二节：常用操作"><a href="#第十二节：常用操作" class="headerlink" title="第十二节：常用操作"></a>第十二节：常用操作</h2><ul><li>12.1 恢复出厂设置<ul><li>1）新的内存卡，断电插入。</li><li>2）软件恢复：在线访问-&gt;网卡-&gt;更新可访问设备-&gt;PLC-&gt;在线和诊断-&gt;功能-&gt;复位为出厂设置-&gt;重置</li></ul></li></ul><h2 id="第十三节：分布式（远程IO）"><a href="#第十三节：分布式（远程IO）" class="headerlink" title="第十三节：分布式（远程IO）"></a>第十三节：分布式（远程IO）</h2><ul><li>13.1 选型<ul><li>1）ET200SP（32个模块，不需要额外电源）、ET200MP、ET200M（用于300系列）、ET200S（64个，每6-8添加一个电源模块）</li><li>2）<ul><li>BA：基本型；</li><li>ST：标准型；IM155-6PN SI</li><li>HF：增强型；</li><li>HS：高速型；</li></ul></li></ul></li><li>13.2 组态<ul><li>1）RTD：热电阻。TC：热电偶。</li><li>2）浅色底座需要接电源，深色不需要。</li><li>3）模拟量输出模块2个一组，一正一负。</li><li>4）</li></ul></li></ul><h2 id="第十四节：变频器MODBUS-RTU通信"><a href="#第十四节：变频器MODBUS-RTU通信" class="headerlink" title="第十四节：变频器MODBUS RTU通信"></a>第十四节：变频器MODBUS RTU通信</h2><ul><li><p>14.1 硬件</p></li><li><p>14.2 指令</p><ul><li>1）Modbus_Comm_Load：主站定义参数</li><li>2）Modbus_Master：主站读写</li><li>3）Modbus_Slave：从站定义</li></ul></li><li><p>14.3</p><ul><li>1）打开时钟存储位和系统存储位</li><li>2）添加模块</li><li>3）半双工：发完才能收，485使用。全双工：可同时发收。</li><li>4）H代表16进制</li><li>5）2101H，实际写地址转成10进制加40001</li></ul></li><li><p>14.4 变频器核心参数（每种变频器不一样）</p><ul><li>n2.00&#x3D;4 （运行来自通讯指令有效）</li><li>n2.01&#x3D;3 （频率来自通讯指令有效）</li><li>n9.00&#x3D;3 （站号）</li><li>n9.01&#x3D;1 （波特率）</li></ul></li><li><p>14.5 串口接线</p><ul><li>232：3对应RJ45：5</li><li>232：8对应RJ45：4</li></ul></li></ul><h2 id="第十五节：V90伺服"><a href="#第十五节：V90伺服" class="headerlink" title="第十五节：V90伺服"></a>第十五节：V90伺服</h2><ul><li><p>驱动器功率等于或略大于伺服功率。</p></li><li><p>15.1 硬件接线</p><ul><li>电源220V、</li><li>位置模式：。速度模式：。</li></ul></li><li><p>15.2 V90调试软件（V-ASSISTANT)</p><ul><li>1）打开后，工具-&gt;恢复出厂值</li><li>2）选择驱动器和电机</li><li>3）标准报文3，可以用步进的指令</li><li>4）PN站名和IP需要和PLC中的一致</li><li>5）设置完成下载到驱动器，工具-&gt;保存参数到ROM</li><li>6）使能，点动测试</li></ul></li><li><p>15.3 V90组态</p><ul><li>1）打开允许远程PUT\GET访问</li><li>2）添加V90伺服后（其他现场设备），子模块-标准报文3</li><li>3）改IP、站名，用网线连接</li></ul></li><li><p>15.4 调试和程序编写</p><ul><li>1）添加工艺对象，设置参数</li><li>2）下载硬件，调试轴</li><li>3）在DB编辑器查看参数</li></ul></li></ul><h2 id="第十六节：模拟量"><a href="#第十六节：模拟量" class="headerlink" title="第十六节：模拟量"></a>第十六节：模拟量</h2><p>温度传感器-&gt;变送器-&gt;</p><ul><li>16.1 硬件和接线<ul><li>1）通道0和1的信号要一致，都是电流或电压</li><li>2）</li><li>3）</li></ul></li><li>16.2 组态<ul><li>1）</li></ul></li><li>16.3 指令<ul><li>1）模拟量输入：</li><li>2）模拟量输出：电流不允许开路</li><li>3）标准化、缩放</li></ul></li><li>16.4 控制变频器</li></ul><h2 id="第十七节：PID恒液位调节"><a href="#第十七节：PID恒液位调节" class="headerlink" title="第十七节：PID恒液位调节"></a>第十七节：PID恒液位调节</h2><p>比例、积分、微分</p><ul><li>17.1 硬件和接线<ul><li>1）输入端：液位传感器正接24V，负接AI正极，AI负极与0V连接。</li><li>2）输出端：0M（-）接变频器AC，0（+）接变频器A1。</li></ul></li><li>17.2 指令<ul><li>1）工艺对象-&gt;新增对象-&gt;选第一个</li><li>2）右侧工具栏-&gt;PID</li><li>3）管脚：<br>  setpoint：设定值<br>  input：测量值<br>  output-PER：模拟量输出<br>  *4）PID要写在OB30（循环中断）里。</li></ul></li><li>17.3 组态<ul><li>1）重启后：自动模式</li><li>2）过程值。</li></ul></li><li>17.4 调试<ul><li>1）测量开始</li><li>2）选调节模式，先预调节，再精确调节</li><li>3）稳定后，参数下载到PLC</li></ul></li></ul><h2 id="第十八节：触摸屏"><a href="#第十八节：触摸屏" class="headerlink" title="第十八节：触摸屏"></a>第十八节：触摸屏</h2><p>先写程序，再做画面。</p><ul><li>18.1 硬件<ul><li>1）博图屏（用博图软件）、SMART屏（专用软件）、WinCC（上位机）（WinCC7.5和博图WinCC）</li><li>2）博图屏分类：串口不能仿真</li><li>3）选择允许远程对象通信访问</li><li>4）</li></ul></li><li>18.2 添加组件（按钮、指示灯、I&#x2F;O域、切换画面、报警）<ul><li>1）文本格式改变字体大小</li><li>2）常规中改文字内容</li><li>3）事件-&gt;按下-&gt;添加函数-&gt;编辑为-&gt;置位位、释放-&gt;复位位</li><li>4）写入失败：设置PG&#x2F;PC接口-&gt;选择实际网卡</li><li>5）在触摸屏变量表中更改触摸屏变量采集周期</li><li>6）DB块中的变量可以不取消优化</li><li>7）在外观中可以添加单位</li><li>8）切换页面：事件-&gt;按下-&gt;激活屏幕</li></ul></li><li>18.3 报警（离散量【开关量】、模拟量）<ul><li>1）首先建立16位地址、选择触发位</li><li>2）</li></ul></li><li>18.4 PC station（上位机）<ul><li>1）运行系统设置&gt;&gt;全屏模式（取消勾选）&gt;&gt;</li></ul></li></ul><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> Siemens </tag>
            
            <tag> PLC </tag>
            
            <tag> 1200 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TIA 博图小知识</title>
      <link href="/posts/ddf9bf4.html"/>
      <url>/posts/ddf9bf4.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="2024年5月30日"><a href="#2024年5月30日" class="headerlink" title="2024年5月30日"></a>2024年5月30日</h2><h3 id="缩写名称："><a href="#缩写名称：" class="headerlink" title="缩写名称："></a>缩写名称：</h3><pre><code>* SDT（System Data Type）系统数据类型。</code></pre><h2 id="2024年4月22日"><a href="#2024年4月22日" class="headerlink" title="2024年4月22日"></a>2024年4月22日</h2><h3 id="安装博图后出现通讯设置"><a href="#安装博图后出现通讯设置" class="headerlink" title="安装博图后出现通讯设置"></a>安装博图后出现通讯设置</h3><p>在任务管理器中找到SCSMonitor服务，将自动改为手动。 </p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>毛选语录摘抄</title>
      <link href="/posts/6e6d4d0d.html"/>
      <url>/posts/6e6d4d0d.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C Sharp 入门详解笔记</title>
      <link href="/posts/312a0f46.html"/>
      <url>/posts/312a0f46.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h2 id="第17章：字段、属性、索引器、常量"><a href="#第17章：字段、属性、索引器、常量" class="headerlink" title="第17章：字段、属性、索引器、常量"></a>第17章：字段、属性、索引器、常量</h2><h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><h4 id="属性是由Set-x2F-Get方法进化来的"><a href="#属性是由Set-x2F-Get方法进化来的" class="headerlink" title="属性是由Set&#x2F;Get方法进化来的"></a>属性是由Set&#x2F;Get方法进化来的</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class student</span><br><span class="line">&#123;</span><br><span class="line">    private int age;</span><br><span class="line">    public int Age</span><br><span class="line">    &#123;</span><br><span class="line">        get</span><br><span class="line">        &#123;</span><br><span class="line">            return this.age;</span><br><span class="line">        &#125;</span><br><span class="line">        set</span><br><span class="line">        &#123;</span><br><span class="line">            if (value &gt; 0 &amp;&amp; value &lt; 120)</span><br><span class="line">            &#123;</span><br><span class="line">                this.age = value;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                throw new Exception(&quot;Age is error!&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态计算值的属性"><a href="#动态计算值的属性" class="headerlink" title="动态计算值的属性"></a>动态计算值的属性</h3><p>第一种</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    public class student</span><br><span class="line">    &#123;</span><br><span class="line">        private int age;</span><br><span class="line">        public int Age</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                return age;</span><br><span class="line">            &#125;</span><br><span class="line">            set</span><br><span class="line">            &#123;</span><br><span class="line">                age = value;</span><br><span class="line">                this.CaculateCanWork();</span><br><span class="line"> //赋值时主动计算，不适用在age经常改变但CanWork不经常被访问时。因为每改变一次就计算一次CanWork。</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        private bool canWork;</span><br><span class="line">        public bool CanWork</span><br><span class="line">        &#123;</span><br><span class="line">            get &#123; return canWork; &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void CaculateCanWork()</span><br><span class="line">        &#123;</span><br><span class="line">            if (this.age &gt; 16)</span><br><span class="line">            &#123;</span><br><span class="line">                this.canWork = true;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                 this.canWork = false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二种</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    public class student</span><br><span class="line">    &#123;</span><br><span class="line">        private int age;</span><br><span class="line">        public int Age</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                return age;</span><br><span class="line">            &#125;</span><br><span class="line">            set</span><br><span class="line">            &#123;</span><br><span class="line">                age = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> //在访问时计算，因此当CanWork被经常访问浪费计算机性能。在设定age计算一次即可。</span><br><span class="line">        public bool CanWork</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                if (this.age &gt; 16)</span><br><span class="line">                &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第18章-参数"><a href="#第18章-参数" class="headerlink" title="第18章 参数"></a>第18章 参数</h2><h3 id="传值参数"><a href="#传值参数" class="headerlink" title="传值参数"></a>传值参数</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C#使用技巧</title>
      <link href="/posts/597266b9.html"/>
      <url>/posts/597266b9.html</url>
      
        <content type="html"><![CDATA[<h2 id="2024年8月13日"><a href="#2024年8月13日" class="headerlink" title="2024年8月13日"></a>2024年8月13日</h2><h2 id="3-3-日志系统"><a href="#3-3-日志系统" class="headerlink" title="3.3 日志系统"></a>3.3 日志系统</h2><p>需要引用以下几个包</p><p>Microsoft.Extensions.DependencyInjection;</p><p>Microsoft.Extensions.Logging</p><p>Microsoft.Extensions.Logging.Console;</p><h4 id="3-3-2-1-使用NLog"><a href="#3-3-2-1-使用NLog" class="headerlink" title="3.3.2.1 使用NLog"></a>3.3.2.1 使用NLog</h4><p>配置文件需要选择“如果较新则复制”</p><h4 id="3-3-2-2-NLog深入"><a href="#3-3-2-2-NLog深入" class="headerlink" title="3.3.2.2 NLog深入"></a>3.3.2.2 NLog深入</h4><h5 id="按照命名空间过滤日志"><a href="#按照命名空间过滤日志" class="headerlink" title="按照命名空间过滤日志"></a>按照命名空间过滤日志</h5><ol><li><p>新建命名空间</p></li><li><p>新建日志输出类</p></li><li><p>设置输出条件</p></li></ol><h5 id="nlog-config中的关键字"><a href="#nlog-config中的关键字" class="headerlink" title="nlog.config中的关键字"></a>nlog.config中的关键字</h5><p>archiveAboveSize：超过多少字节就把日志存档。</p><p>maxArchiveFiles：最大文件数</p><p>final设置为true，匹配后不再向下匹配</p><p>NLog使用时尽量使用NLog自身的日志等级过滤方法，避免冲突</p><h3 id="2023年12月28日"><a href="#2023年12月28日" class="headerlink" title="2023年12月28日"></a>2023年12月28日</h3><h4 id="C-快速排版"><a href="#C-快速排版" class="headerlink" title="C#快速排版"></a>C#快速排版</h4><p>Ctrl K + Ctrl D</p><h3 id="2023年12月27日"><a href="#2023年12月27日" class="headerlink" title="2023年12月27日"></a>2023年12月27日</h3><h4 id="修改为仅使用Tab进行补全"><a href="#修改为仅使用Tab进行补全" class="headerlink" title="修改为仅使用Tab进行补全"></a>修改为仅使用Tab进行补全</h4><p>编辑&#x2F;Intellisense&#x2F;在自动和仅限Tab的Intellisense完成之间切换（快捷键 Ctrl+Alt+Space）</p><h4 id="C-开源项目"><a href="#C-开源项目" class="headerlink" title="C#开源项目"></a>C#开源项目</h4><ol><li><p><a href="https://github.com/microsoft/PowerToys">https://github.com/microsoft/PowerToys</a></p></li><li><p><a href="https://qithub.com/shadowsocks/shadowsocks-windows">https://qithub.com/shadowsocks/shadowsocks-windows</a></p></li><li><p><a href="https://github.com/2dust/v2rayN">https://github.com/2dust/v2rayN</a></p></li><li><p><a href="https://github.com/PowerShell/PowerShell">https://github.com/PowerShell/PowerShell</a></p></li><li><p><a href="https://github.com/dotnet/aspnetcore">https://github.com/dotnet/aspnetcore</a></p></li><li><p><a href="https://github.com/dotnet-architecture/eShopOnContainers">https://github.com/dotnet-architecture/eShopOnContainers</a></p></li><li><p><a href="https://github.com/huiyadanli/RevokeMsgPatcher">https://github.com/huiyadanli/RevokeMsgPatcher</a></p></li><li><p><a href="https://github.com/Kyome22/RunCat_for_windows">https://github.com/Kyome22/RunCat_for_windows</a></p></li><li><p><a href="https://github.com/bitsadmin/fakelogonscreen">https://github.com/bitsadmin/fakelogonscreen</a></p></li><li><p><a href="https://github.com/2881099/FreelM">https://github.com/2881099/FreelM</a></p></li><li><p><a href="https://github.com/AdminTest0/SharpWxDump">https://github.com/AdminTest0/SharpWxDump</a></p></li><li><p><a href="https://github.com/keijiro/AICommand">https://github.com/keijiro/AICommand</a></p></li></ol><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SolidWorks使用技巧</title>
      <link href="/posts/74c008c3.html"/>
      <url>/posts/74c008c3.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="2023年12月15日"><a href="#2023年12月15日" class="headerlink" title="2023年12月15日"></a>2023年12月15日</h3><h3 id="图纸标题栏文字"><a href="#图纸标题栏文字" class="headerlink" title="图纸标题栏文字"></a>图纸标题栏文字</h3><p>1.选项-&gt;输出-&gt;dwg文件-&gt;字体-&gt;Truetype</p><h3 id="2023年11月19日"><a href="#2023年11月19日" class="headerlink" title="2023年11月19日"></a>2023年11月19日</h3><h4 id="装配体批量上色"><a href="#装配体批量上色" class="headerlink" title="装配体批量上色"></a>装配体批量上色</h4><ol><li><p>评估-&gt;装配体直观</p></li><li><p>左侧导航栏-&gt;质量-&gt;添加显示状态-&gt;配置页面-&gt;双击”直观显示状态”</p></li></ol><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> SolidWorks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QT和OPENCV环境配置-使用Mingw</title>
      <link href="/posts/6a4765f.html"/>
      <url>/posts/6a4765f.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：结合自己的配置过程，供大家参考</p></blockquote><span id="more"></span><h3 id="1-软件版本："><a href="#1-软件版本：" class="headerlink" title="1.软件版本："></a>1.软件版本：</h3><p>QT： 6.2.4<br>OPENCV： 4.8<br>Python： 3.12<br>Cmake： 官网最新版</p><h3 id="2-安装过程：略"><a href="#2-安装过程：略" class="headerlink" title="2.安装过程：略"></a>2.安装过程：略</h3><h3 id="3-Cmake使用参考此视频"><a href="#3-Cmake使用参考此视频" class="headerlink" title="3.Cmake使用参考此视频"></a>3.Cmake使用参考此视频</h3><p>传送门: <a href="https://www.bilibili.com/video/BV1Za4y1v7ra/?buvid=XU616126D542B8D9B167733428C64FE692C6F&from_spmid=main.my-history.0.0&is_story_h5=false&mid=9AC71GOD+KT4NhVvZnZZCn8FTQ/SZMtL1rElX6M3iMo=&p=1&plat_id=116&share_from=ugc&share_medium=android&share_plat=android&share_session_id=47e0f1f0-247c-4d41-b52f-cc0455c24b0c&share_source=WEIXIN&share_tag=s_i&spmid=united.player-video-detail.0.0&timestamp=1698589426&unique_k=TY9ywgD&up_id=365916694">OpenCV4 + Qt5 开发环境配置</a></p><h3 id="4-报错处理"><a href="#4-报错处理" class="headerlink" title="4.报错处理"></a>4.报错处理</h3><h4 id="报错结尾为opencv-core"><a href="#报错结尾为opencv-core" class="headerlink" title="报错结尾为opencv_core"></a>报错结尾为opencv_core</h4><p>在cmake里面取消OPENCV_ENABLE_ALLOCATOR_STATS的勾选，重新Configure和Generate，在powershell窗口中继续使用mingw32-make -j编译。</p><h4 id="报错中有VS-VERSION"><a href="#报错中有VS-VERSION" class="headerlink" title="报错中有VS_VERSION"></a>报错中有VS_VERSION</h4><p>在CMAKE中添加一项<br>add Entry -&gt; 名称：OPENCV_VS_VERSIONINFO_SKIP 类型：BOOL </p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QT+HALCON环境配置</title>
      <link href="/posts/f8f37c42.html"/>
      <url>/posts/f8f37c42.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：QT 6.2.4 &#x2F; HALCON 22.11.0.0</p></blockquote><span id="more"></span><h3 id="1-在-pro文件中添加以下代码"><a href="#1-在-pro文件中添加以下代码" class="headerlink" title="1.在.pro文件中添加以下代码"></a>1.在.pro文件中添加以下代码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">win32:DEFINES += WIN32</span><br><span class="line"></span><br><span class="line">INCLUDEPATH   += &quot;$$(HALCONROOT)/include&quot;</span><br><span class="line">INCLUDEPATH   += &quot;$$(HALCONROOT)/include/halconcpp&quot;</span><br><span class="line"></span><br><span class="line">QMAKE_LIBDIR  += &quot;$$(HALCONROOT)/lib/$$(HALCONARCH)&quot;</span><br><span class="line">unix:LIBS     += -lhalconcpp -lhalcon -lXext -lX11 -ldl -lpthread</span><br><span class="line">win32:LIBS    +=&quot;$$(HALCONROOT)/lib/$$(HALCONARCH)/halconcpp.lib&quot; \</span><br><span class="line">&quot;$$(HALCONROOT)/lib/$$(HALCONARCH)/halcon.lib&quot;</span><br></pre></td></tr></table></figure><div style="width:50%;margin:auto"><img src="/posts/f8f37c42/pic1.png" class=""></div><!-- <div style="width:50%;margin:auto"></div>--><blockquote><p>注意添加位置</p></blockquote><h3 id="2-在头文件中添加以下代码"><a href="#2-在头文件中添加以下代码" class="headerlink" title="2. 在头文件中添加以下代码"></a>2. 在头文件中添加以下代码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;HalconCpp.h&gt;</span><br><span class="line">// 后期根据需要添加头文件</span><br><span class="line">using namespace HalconCpp;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HObject  ho_Image;</span><br><span class="line">HTuple  hv_Width,hv_Height,hv_WindowHandle;</span><br><span class="line">Hlong widid;</span><br></pre></td></tr></table></figure><div style="width:50%;margin:auto"><img src="/posts/f8f37c42/pic2.png" class=""></div><h3 id="3-在mainwindow-cpp文件中添加窗口代码"><a href="#3-在mainwindow-cpp文件中添加窗口代码" class="headerlink" title="3. 在mainwindow.cpp文件中添加窗口代码"></a>3. 在mainwindow.cpp文件中添加窗口代码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">widid=static_cast&lt;Hlong&gt;(ui-&gt;label-&gt;winId());</span><br><span class="line">OpenWindow(0,0,ui-&gt;label-&gt;width(),ui-&gt;label-&gt;height(),widid,&quot;visible&quot;,&quot;&quot;,&amp;hv_WindowHandle);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ReadImage(&amp;ho_Image,&quot;G:/CV/HALCON/1.jpg&quot;); </span><br><span class="line">//  &quot;G:/CV/HALCON/1.jpg&quot;需要更改为自己电脑中图片的路径</span><br><span class="line">GetImageSize(ho_Image,&amp;hv_Width,&amp;hv_Height);</span><br><span class="line">HDevWindowStack::Push(hv_WindowHandle);</span><br><span class="line">if(HDevWindowStack::IsOpen())</span><br><span class="line">SetPart(HDevWindowStack::GetActive(),0,0,hv_Width-1,hv_Height-1);</span><br><span class="line">if(HDevWindowStack::IsOpen())</span><br><span class="line">DispObj(ho_Image,HDevWindowStack::GetActive());</span><br></pre></td></tr></table></figure><div style="width:50%;margin:auto"><img src="/posts/f8f37c42/pic3.png" class=""></div><h3 id="4-在UI文件中添加一个label和pushbotton"><a href="#4-在UI文件中添加一个label和pushbotton" class="headerlink" title="4. 在UI文件中添加一个label和pushbotton"></a>4. 在UI文件中添加一个<code>label</code>和<code>pushbotton</code></h3><p><code>pushbotton</code>右键选择<code>提升槽</code>,选择<code>clicked</code>.</p><p>调试运行</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> CV </tag>
            
            <tag> HALCON </tag>
            
            <tag> QT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>名词整理</title>
      <link href="/posts/e8917f8b.html"/>
      <url>/posts/e8917f8b.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="2023年10月24日"><a href="#2023年10月24日" class="headerlink" title="2023年10月24日"></a>2023年10月24日</h3><table><thead><tr><th align="left">名词</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left">CODESYS</td><td align="left">CODESYS是一种功能强大的<code>PLC软件编程工具</code>，它支持IEC61131-3标准IL 、ST、 FBD 、LD、 CFC、 SFC 六种PLC编程语言，用户可以在同一项目中选择不同的语言编辑子程序，功能模块等。</td></tr><tr><td align="left">OLE</td><td align="left">Object Linking and Embedding，<code>对象连接与嵌入，简称OLE技术</code>。OLE 不仅是桌面应用程序集成，而且还定义和实现了一种允许<code>应用程序作为软件“对象”（数据集合和操作数据的函数）彼此进行“连接”的机制</code>，这种连接机制和协议称为组件对象模型（COM）。OLE可以用来创建复合文档，复合文档包含了创建于不同源应用程序，有着不同类型的数据，因此它可以把文字、声音、图像、表格、应用程序等组合在一起。</td></tr><tr><td align="left">OPC</td><td align="left">OPC（OLE for Process Control）, 用于<code>过程控制的OLE</code>，是一个<code>工业标准</code>，管理这个标准的国际组织是OPC基金会，OPC基金会现有会员已超过220家。遍布全球，包括世界上所有主要的自动化控制系统、仪器仪表及过程控制系统的公司。基于微软的OLE(现在的Active X)、COM （部件对象模型）和DCOM （分布式部件对象模型）技术。OPC包括一整套接口、属性和方法的标准集，用于过程控制和制造业自动化系统。</td></tr><tr><td align="left">SMART原则</td><td align="left">1. 绩效指标必须是具体的（Specific）<br>2. 绩效指标必须是可以衡量的（Measurable）<br>3. 绩效指标必须是可以达到的（Attainable）<br>4. 绩效指标是要与其他目标具有一定的相关性(Relevant)<br>5. 绩效指标必须具有明确的截止期限（Time-bound）</td></tr></tbody></table><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CAD模板调整手册</title>
      <link href="/posts/904de5aa.html"/>
      <url>/posts/904de5aa.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="2023年10月27日"><a href="#2023年10月27日" class="headerlink" title="2023年10月27日"></a>2023年10月27日</h3><p>PL命令，起点-W回车-起点宽度3-端点宽度0.2-长度3-线长3-边长5的矩形</p><h3 id="2023年10月24日"><a href="#2023年10月24日" class="headerlink" title="2023年10月24日"></a>2023年10月24日</h3><h4 id="螺栓沉孔标注中的特殊符号"><a href="#螺栓沉孔标注中的特殊符号" class="headerlink" title="螺栓沉孔标注中的特殊符号"></a>螺栓沉孔标注中的特殊符号</h4><p>特殊符号</p><p>字体：gdt.shx，勾选大字体，gbcbig.shx</p><p>中文字体</p><p>字体：gbenor.shx，勾选大字体，gbcbig.shx</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器视觉技术基础</title>
      <link href="/posts/80f300b5.html"/>
      <url>/posts/80f300b5.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><span id="more"></span><h3 id="2023年10月22日"><a href="#2023年10月22日" class="headerlink" title="2023年10月22日"></a>2023年10月22日</h3><h4 id="光的吸收与反射"><a href="#光的吸收与反射" class="headerlink" title="光的吸收与反射"></a>光的吸收与反射</h4><div style="width:50%;margin:auto"><img src="/posts/80f300b5/%E5%85%89%E7%9A%84%E5%90%B8%E6%94%B6%E4%B8%8E%E5%8F%8D%E5%B0%84.png" class=""></div><p>采用单色光源照射时，由于单色光被其他颜色物体吸收，无法反射，在黑白相机中呈现黑色。相同单色物体反射光，在相机中呈现白色。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 机器视觉 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2</title>
      <link href="/posts/13bb8d58.html"/>
      <url>/posts/13bb8d58.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：无</p></blockquote><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 无 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EXCEL使用技巧</title>
      <link href="/posts/59436549.html"/>
      <url>/posts/59436549.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：EXCEL使用技巧</p></blockquote><span id="more"></span><h3 id="2023年10月22日"><a href="#2023年10月22日" class="headerlink" title="2023年10月22日"></a>2023年10月22日</h3><h4 id="单元格条件格式以百分比填充"><a href="#单元格条件格式以百分比填充" class="headerlink" title="单元格条件格式以百分比填充"></a>单元格条件格式以百分比填充</h4><p>将条件格式的最大值设置为数字“1”</p><h3 id="2023-x2F-9-x2F-10"><a href="#2023-x2F-9-x2F-10" class="headerlink" title="2023&#x2F;9&#x2F;10"></a>2023&#x2F;9&#x2F;10</h3><h4 id="高阶甘特图"><a href="#高阶甘特图" class="headerlink" title="高阶甘特图"></a>高阶甘特图</h4><ol><li><p><strong>Ctrl+；</strong> 快速输入当前日期</p></li><li><p>格式-&gt;自定义-&gt;添加<strong>周AAA</strong> 显示周几</p></li><li><p><strong>F4</strong> 绝对引用</p></li><li><p>TEXT(A1,”dddd”)</p></li></ol><p>*dddd为英文星期全称<br>*ddd为英文星期简称<br>*aaaa为中文星期全称<br>*aaa为中文星期简称</p><ol start="5"><li><p><strong>weeknum(“”,“2，国外周日为第一天”)</strong> 返回日期在当年的周数</p></li><li><p><strong>Ctrl+t</strong> 结构化表格、动态表、超级表</p></li><li><p><strong>Ctrl+1</strong> 自定义格式</p></li><li><p><strong>数据-&gt;数据验证-&gt;序列</strong> 添加下拉选项</p></li><li><p><strong>条件格式-&gt;数据条</strong> 以单元格百分比显示</p></li></ol><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> EXCEL </tag>
            
            <tag> 办公技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Word快捷指令</title>
      <link href="/posts/9f3f6fb5.html"/>
      <url>/posts/9f3f6fb5.html</url>
      
        <content type="html"><![CDATA[<p>简介：Word快捷指令</p><span id="more"></span><h3 id="2023-x2F-9-x2F-9"><a href="#2023-x2F-9-x2F-9" class="headerlink" title="2023&#x2F;9&#x2F;9"></a>2023&#x2F;9&#x2F;9</h3><p>线型：</p><p>虚线：三个“*”，回车</p><p>波浪线：三个“~”，回车</p><p>隔行线：三个“#”，回车</p><p>双直线：三个“&#x3D;”，回车</p><p>直线：三个“-”，回车</p><p>实例：</p><p><img src="/posts/9f3f6fb5/%E7%BA%BF%E5%9E%8B.png"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 办公技巧 </tag>
            
            <tag> Word </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WIN11添加过时硬件“Microsoft KM-TEST环回适配器”</title>
      <link href="/posts/2fae4cea.html"/>
      <url>/posts/2fae4cea.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>简介：WIN11添加过时硬件“Microsoft KM-TEST环回适配器”</p></blockquote><span id="more"></span><hr><h3 id="1-使用“WIN＋R”调出命令提示符，并输入“hdwwiz”"><a href="#1-使用“WIN＋R”调出命令提示符，并输入“hdwwiz”" class="headerlink" title="1.使用“WIN＋R”调出命令提示符，并输入“hdwwiz”"></a>1.使用“WIN＋R”调出命令提示符，并输入“hdwwiz”</h3><p><img src="/posts/2fae4cea/cmd.png"></p><h3 id="2-弹出添加硬件向导窗口，下一步"><a href="#2-弹出添加硬件向导窗口，下一步" class="headerlink" title="2.弹出添加硬件向导窗口，下一步"></a>2.弹出添加硬件向导窗口，下一步</h3><p><img src="/posts/2fae4cea/picture1.png"></p><h3 id="3-选择“安装我手动从列表选择的硬件”，下一步"><a href="#3-选择“安装我手动从列表选择的硬件”，下一步" class="headerlink" title="3.选择“安装我手动从列表选择的硬件”，下一步"></a>3.选择“安装我手动从列表选择的硬件”，下一步</h3><p><img src="/posts/2fae4cea/picture2.png"></p><h3 id="4-选择“网络适配器”，下一步"><a href="#4-选择“网络适配器”，下一步" class="headerlink" title="4.选择“网络适配器”，下一步"></a>4.选择“网络适配器”，下一步</h3><p><img src="/posts/2fae4cea/picture3.png"></p><h3 id="5-在左侧找到“Micorsoft”，右侧选择“Microsoft-KM-TEST环回适配器”，下一步"><a href="#5-在左侧找到“Micorsoft”，右侧选择“Microsoft-KM-TEST环回适配器”，下一步" class="headerlink" title="5.在左侧找到“Micorsoft”，右侧选择“Microsoft KM-TEST环回适配器”，下一步"></a>5.在左侧找到“Micorsoft”，右侧选择“Microsoft KM-TEST环回适配器”，下一步</h3><p><img src="/posts/2fae4cea/picture4.png"></p><h3 id="6-等待下载完成"><a href="#6-等待下载完成" class="headerlink" title="6.等待下载完成"></a>6.等待下载完成</h3><p><img src="/posts/2fae4cea/picture6.png"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>星-三角启动</title>
      <link href="/posts/81c86f89.html"/>
      <url>/posts/81c86f89.html</url>
      
        <content type="html"><![CDATA[<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 电工电子 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C#运动控制及界面开发</title>
      <link href="/posts/682b50d5.html"/>
      <url>/posts/682b50d5.html</url>
      
        <content type="html"><![CDATA[<h1 id="一、硬件"><a href="#一、硬件" class="headerlink" title="一、硬件"></a>一、硬件</h1><p>电机、驱动器、板卡</p><h1 id="二、软件"><a href="#二、软件" class="headerlink" title="二、软件"></a>二、软件</h1><p>XCOM</p><h1 id="三、编程"><a href="#三、编程" class="headerlink" title="三、编程"></a>三、编程</h1><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>VS 2019</p><h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>.cs:<br>.dll:<br>winform:</p><h2 id="常用工具"><a href="#常用工具" class="headerlink" title="常用工具"></a>常用工具</h2><p>button：按钮<br>panel：面板<br>text：文本<br>label：标签</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 工控 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RobotStudio基础</title>
      <link href="/posts/9d614237.html"/>
      <url>/posts/9d614237.html</url>
      
        <content type="html"><![CDATA[<h2 id="2023年8月6日"><a href="#2023年8月6日" class="headerlink" title="2023年8月6日"></a>2023年8月6日</h2><h3 id="1-RS中Smart组件添加直线传感器"><a href="#1-RS中Smart组件添加直线传感器" class="headerlink" title="1.RS中Smart组件添加直线传感器"></a>1.RS中Smart组件添加直线传感器</h3><p>（1）编辑Smart组件<br>（2）添加linesensor（直线传感器），更改传感器属性<br>（3）拖动linesensor至Smart组件中工装夹具上；弹出是否更改传感器位置，选“否”</p><h3 id="2-导入多个工件后，夹具工作时多个工件会一起运动"><a href="#2-导入多个工件后，夹具工作时多个工件会一起运动" class="headerlink" title="2.导入多个工件后，夹具工作时多个工件会一起运动"></a>2.导入多个工件后，夹具工作时多个工件会一起运动</h3><p>取消工装夹具的可由传感器检测功能</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 工控 </tag>
            
            <tag> ABB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown技巧</title>
      <link href="/posts/f3de4c07.html"/>
      <url>/posts/f3de4c07.html</url>
      
        <content type="html"><![CDATA[<h2 id="1-星号成对使用"><a href="#1-星号成对使用" class="headerlink" title="1. 星号成对使用"></a>1. 星号成对使用</h2><ol><li><p>* * 和_ _内的文本会被转换为斜体</p></li><li><p>** ** 或 __ __ 内的文本会被加粗（相邻符号内不能有空格）</p></li><li><p>在第一个符号前加入反斜杠 “ \ ”，取消特殊格式</p></li></ol><h2 id="2-表格"><a href="#2-表格" class="headerlink" title="2. 表格"></a>2. 表格</h2><table><thead><tr><th>name1</th><th>name2</th></tr></thead><tbody><tr><td>num</td><td>name</td></tr></tbody></table><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第2章 这不是Bug，而是语言特性</title>
      <link href="/posts/5e3708b8.html"/>
      <url>/posts/5e3708b8.html</url>
      
        <content type="html"><![CDATA[<p>《C专家编程》</p><span id="more"></span><h2 id="2-1-语言缺陷"><a href="#2-1-语言缺陷" class="headerlink" title="2.1 语言缺陷"></a>2.1 语言缺陷</h2><p>类型1：多做之过<br>类型2：少做之过<br>类型3：误做之过</p><h2 id="2-2-多做之过"><a href="#2-2-多做之过" class="headerlink" title="2.2 多做之过"></a>2.2 多做之过</h2><h3 id="2-2-1-switch语句中的“fall-through”带来的问题"><a href="#2-2-1-switch语句中的“fall-through”带来的问题" class="headerlink" title="2.2.1 switch语句中的“fall through”带来的问题"></a>2.2.1 switch语句中的“fall through”带来的问题</h3><ol><li><p>case语句后需要添加break结束switch的命令执行。</p></li><li><p>break中断了整个switch函数的执行，跳出了switch函数结构。</p></li></ol><h3 id="2-2-2-粉笔也成了可用硬件"><a href="#2-2-2-粉笔也成了可用硬件" class="headerlink" title="2.2.2 粉笔也成了可用硬件"></a>2.2.2 粉笔也成了可用硬件</h3><blockquote><p>在修饰变量的时候,static修饰的静态局部变量只执行一次初始化</p></blockquote><p>字符串数组两个字符串成员之间需要添加逗号，否则两个成员会自动合并为一个成员，引发问题。</p><h3 id="2-2-3-太多的缺省可见性"><a href="#2-2-3-太多的缺省可见性" class="headerlink" title="2.2.3 太多的缺省可见性"></a>2.2.3 太多的缺省可见性</h3><p>无论是否有extern关键字，函数在任何地方均可以访问</p><p>添加static关键字可以限制文件对函数的访问</p><h2 id="2-3-误做之过"><a href="#2-3-误做之过" class="headerlink" title="2.3 误做之过"></a>2.3 误做之过</h2><p>与C语言的简洁和操作符的优先级有关</p><h3 id="2-3-1-骆驼背上的重载"><a href="#2-3-1-骆驼背上的重载" class="headerlink" title="2.3.1 骆驼背上的重载"></a>2.3.1 骆驼背上的重载</h3><p>字符的过度使用、C语言中的符号重载</p><p>例：*</p><ol><li>乘法运算符</li><li>用于指针，间接引用</li><li>在声明中，表示指针</li></ol><p>sizeof(int) * p 中 <code>*</code>为乘法运算符；</p><h3 id="2-3-2-“某些运算符的优先级是错误的”"><a href="#2-3-2-“某些运算符的优先级是错误的”" class="headerlink" title="2.3.2 “某些运算符的优先级是错误的”"></a>2.3.2 “某些运算符的优先级是错误的”</h3><table><thead><tr><th align="left">优先级问题</th><th align="left">表达式</th><th align="left">人们可能误认为的结果</th><th align="left">实际结果</th></tr></thead><tbody><tr><td align="left">.的优先级高于* <br> -&gt;操作符用于消除这个问题</td><td align="left">*p.f</td><td align="left">p所指对象的字段f <br> (*p).f</td><td align="left">对p取f偏移，作为指针，然后进行解除引用操作。<br>*(p.f)</td></tr><tr><td align="left">[]高于*</td><td align="left">int *ap[]</td><td align="left">ap是指向int数组的指针int(*ap)[]</td><td align="left">ap是元素为int指针的数组 <br> int *(ap[])</td></tr><tr><td align="left">函数()高于*</td><td align="left">int *fp()</td><td align="left">fp是个函数指针，所指函数返回int。int(*fp)()</td><td align="left">fp是个函数，返回int* <br> int *(fp())</td></tr><tr><td align="left">&#x3D;&#x3D;和!&#x3D;高于位操作符</td><td align="left">(val &amp; mask !&#x3D; 0)</td><td align="left">(val &amp; mask) !&#x3D; 0</td><td align="left">val &amp; (mask !&#x3D; 0)</td></tr><tr><td align="left">&#x3D;&#x3D;和!&#x3D;高于赋值符</td><td align="left">c&#x3D; getchar() !&#x3D; EOF</td><td align="left">(c&#x3D; getchar()) !&#x3D; EOF</td><td align="left">c&#x3D; (getchar() !&#x3D; EOF)</td></tr><tr><td align="left">算术运算高于位移运算符</td><td align="left">msb &lt;&lt; 4 + lsb</td><td align="left">(msb &lt;&lt; 4) + lsb</td><td align="left">msb &lt;&lt; (4 + lsb)</td></tr><tr><td align="left">逗号运算符在所有运算符中优先级最低</td><td align="left">i &#x3D; 1, 2</td><td align="left">i &#x3D; (1, 2)</td><td align="left">(i &#x3D; 1), 2</td></tr></tbody></table><h4 id="优先级："><a href="#优先级：" class="headerlink" title="优先级："></a>优先级：</h4><p>乘法和除法先于加法和减法，在涉及其他操作符时一律加上括号。</p><h4 id="结合性"><a href="#结合性" class="headerlink" title="结合性"></a>结合性</h4><p>结合性只用于表达式中出现两个以上相同优先级的操作符的情况，所有的赋值符（包括复合赋值符）都具有右结合性，从右向左依次执行。左结合性的操作符：”&amp;”和”|”</p><h3 id="2-3-2-早期gets-中的bug导致了internet蠕虫"><a href="#2-3-2-早期gets-中的bug导致了internet蠕虫" class="headerlink" title="2.3.2 早期gets()中的bug导致了internet蠕虫"></a>2.3.2 早期gets()中的bug导致了internet蠕虫</h3><p><img src="/posts/5e3708b8/2.3.1.jpg"></p><h2 id="2-4-少做之过"><a href="#2-4-少做之过" class="headerlink" title="2.4 少做之过"></a>2.4 少做之过</h2><h3 id="2-4-1-若用户名中有f，便收不到邮件"><a href="#2-4-1-若用户名中有f，便收不到邮件" class="headerlink" title="2.4.1 若用户名中有f，便收不到邮件"></a>2.4.1 若用户名中有f，便收不到邮件</h3><p>引起该错误的主要是由于系统对’-‘符号的糟糕解析，系统分不清该符号是是选项开关还是文件名。</p><h3 id="2-4-2-空格——最后的领域"><a href="#2-4-2-空格——最后的领域" class="headerlink" title="2.4.2 空格——最后的领域"></a>2.4.2 空格——最后的领域</h3><ul><li>使用”&quot;字符对一些字符进行转义时，”&quot;与字符间不能有空格</li><li>也不可将所有的空格弃之不用</li></ul><p>例：z &#x3D; y+++x |可以是z &#x3D; y++ +x 或 z &#x3D; y+ ++x</p><ul><li>使用两个指针执行除法运算</li></ul><p>例：ratio &#x3D; *x&#x2F;<em>y |由于缺少空格”&#x2F;</em>“被认为是注释符号</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第2章 算法</title>
      <link href="/posts/ef905eca.html"/>
      <url>/posts/ef905eca.html</url>
      
        <content type="html"><![CDATA[<p>《大话数据结构》</p><span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>算法是解决特定问题求解步骤的描述，在计算机中表现为指令的有限序列，并且每条指令表示一个或多个操作。</p><h2 id="2-1算法的特性"><a href="#2-1算法的特性" class="headerlink" title="2.1算法的特性"></a>2.1算法的特性</h2><blockquote><p>基本特性：输入、输出、有穷性、确定性和可行性</p></blockquote><h3 id="2-1-1-输入输出"><a href="#2-1-1-输入输出" class="headerlink" title="2.1.1 输入输出"></a>2.1.1 输入输出</h3><p>算法具有零个或多个输入，至少具有一个或多个输出</p><h3 id="2-1-2-有穷性"><a href="#2-1-2-有穷性" class="headerlink" title="2.1.2 有穷性"></a>2.1.2 有穷性</h3><p>算法在执行有限的步骤后，自然结束而不会出现无限循环，并且每一个步骤在可接受的时间内完成。</p><h3 id="2-1-3-确定性"><a href="#2-1-3-确定性" class="headerlink" title="2.1.3 确定性"></a>2.1.3 确定性</h3><p>算法的每一步骤都具有确定的含义，不会出现二义性</p><h3 id="2-1-4"><a href="#2-1-4" class="headerlink" title="2.1.4"></a>2.1.4</h3><p>算法的每一步都必须是可行的，也就是说，每一步都能通过执行有限次数完成。</p><h2 id="2-2-算法设计要求"><a href="#2-2-算法设计要求" class="headerlink" title="2.2 算法设计要求"></a>2.2 算法设计要求</h2><blockquote><p>正确性、可读性、健壮性、时间效率高和存储量低</p></blockquote><h3 id="2-2-1-正确性"><a href="#2-2-1-正确性" class="headerlink" title="2.2.1 正确性"></a>2.2.1 正确性</h3><p>算法至少具有输入、输出和加工处理无歧义性，能正确反映问题需求，能够得到问题的正确答案。</p><p>算法层次：<br>（1）算法程序没有语法错误<br>（2）算法程序对于合法的输入数据能够产生满足要求的输出结果<br>（3）算法程序对于非法的输入数据能够得出满足规格要求的结果<br>（4）算法程序对于精心选择的，甚至刁难的测试数据都有满足要求的输出结果</p><h3 id="2-2-2-可读性"><a href="#2-2-2-可读性" class="headerlink" title="2.2.2 可读性"></a>2.2.2 可读性</h3><p>算法设计的目的之一是便于阅读、理解和交流。</p><h3 id="2-2-3-健壮性"><a href="#2-2-3-健壮性" class="headerlink" title="2.2.3 健壮性"></a>2.2.3 健壮性</h3><p>当输入数据不合理时，算法能够做出相应的处理，而不会产生异常或莫名其妙的结果。</p><h3 id="2-2-4-时间效率高和存储量低"><a href="#2-2-4-时间效率高和存储量低" class="headerlink" title="2.2.4 时间效率高和存储量低"></a>2.2.4 时间效率高和存储量低</h3><p>尽量满足</p><h2 id="2-3-算法效率的度量方法"><a href="#2-3-算法效率的度量方法" class="headerlink" title="2.3 算法效率的度量方法"></a>2.3 算法效率的度量方法</h2><h3 id="2-3-1-事后统计方法"><a href="#2-3-1-事后统计方法" class="headerlink" title="2.3.1 事后统计方法"></a>2.3.1 事后统计方法</h3><p>有较大缺陷，不考虑</p><h3 id="2-3-2-事前分析估算方法"><a href="#2-3-2-事前分析估算方法" class="headerlink" title="2.3.2 事前分析估算方法"></a>2.3.2 事前分析估算方法</h3><p>定义：在计算机程序编制前，依据统计方法对算法进行估算。</p><p>抛开硬件和软件的影响，程序运行时间依赖于算法的好坏和问题的输入规模。</p><p>分析程序的运行时间，最总要的是把程序看成是独立于程序设计语言的算法或一系列步骤。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> C语言 </tag>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深入理解计算机系统</title>
      <link href="/posts/e8670b7a.html"/>
      <url>/posts/e8670b7a.html</url>
      
        <content type="html"><![CDATA[<p>待学习…</p><span id="more"></span><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 电子信息 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>流固耦合仿真</title>
      <link href="/posts/6ad5bd55.html"/>
      <url>/posts/6ad5bd55.html</url>
      
        <content type="html"><![CDATA[<p>待学习…</p><span id="more"></span><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 科学研究 </tag>
            
            <tag> COMSOL </tag>
            
            <tag> 流固耦合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>人生在世</title>
      <link href="/posts/b9908884.html"/>
      <url>/posts/b9908884.html</url>
      
        <content type="html"><![CDATA[<p>Recording life.</p><span id="more"></span><h3 id="2023-4-19"><a href="#2023-4-19" class="headerlink" title="2023-4-19"></a>2023-4-19</h3><p>世界很大，世界很小<font color=white>山东科技大学北门事件</font></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PLC 200 SMART 学习手册</title>
      <link href="/posts/3eef07d.html"/>
      <url>/posts/3eef07d.html</url>
      
        <content type="html"><![CDATA[<p>待学习…</p><span id="more"></span><h3 id="2023-8-22"><a href="#2023-8-22" class="headerlink" title="2023.8.22"></a>2023.8.22</h3><h4 id="1-特殊标志继电器-SM"><a href="#1-特殊标志继电器-SM" class="headerlink" title="1.特殊标志继电器 (SM)"></a>1.特殊标志继电器 (SM)</h4><p>SM0.0：始终接通；</p><p>SM0.1：首次扫描为1，以后为0，常用来对程序进行初始化；</p><p>SM0.2：当机器执行数学运算的结果为负时，该位被置1；</p><p>SM0.3：开机后进入RUN方式，该位被置1一个扫描周期； </p><p>SM0.4：该位提供一个周期为1分钟的时钟脉冲，30秒为1，30秒为0；</p><p>SM0.5：该位提供一个周期为1秒钟的时钟脉冲，0.5秒为1，0.5秒为0；</p><p>SM0.6：该位为扫描时钟脉冲，本次扫描为1，下次扫描为0；</p><p>SM0.7: 指示CPU工作方式开关的位置，0为Term位置。1为Run位置;</p><p>SM1.0：当执行某些指令，其结果为0时，将改位置1； </p><p>SM1.1：当执行某些指令，其结果溢出或为非法数值时，将改位置1；</p><p>SM1.2：当执行数学运算指令，其结果为负数时，将改位置1；</p><p>SM1.3：试图除以0时，将改位置1</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 自动化 </tag>
            
            <tag> 西门子 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux编程基础操作</title>
      <link href="/posts/b81877f0.html"/>
      <url>/posts/b81877f0.html</url>
      
        <content type="html"><![CDATA[<p>Linux学习备忘</p><span id="more"></span><ol><li>创建文件</li></ol><p><font color= white>[kb]</font>vi test2.c</p><ol start="2"><li>编译并执行文件</li></ol><p>gcc (文件名加后缀) &amp;&amp;.&#x2F;a.out</p><ol start="3"><li>退出文件</li></ol><p>shift ＋ Z ＋ Z</p><ol start="4"><li>复制光标所在整行</li></ol><p>yy</p><ol start="5"><li>删除 (剪切) 光标所在整行</li></ol><p>dd</p><ol start="6"><li>将之前删除 (dd) 或者复制 (yy) 的数据粘贴到光标后面</li></ol><p>p</p><ol start="7"><li>光标定位到最后一行</li></ol><p>Shift + G</p><ol start="8"><li>快速打开终端</li></ol><p>Shift + Alt + t</p><ol start="9"><li>新建文件夹</li></ol><p>mkdir</p><ol start="10"><li>回退文件夹</li></ol><p>cd ..</p><ol start="11"><li>代码左移或右移</li></ol><p><code>v</code>进入vision模式，移动选中一行或多行代码<br>shift + &lt; 整体左移<br>shift + &gt; 整体左移</p><ol start="12"><li>修改文件夹名称</li></ol><p>mv file1 file2</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Yilia主题添加更新日期</title>
      <link href="/posts/bcd402f1.html"/>
      <url>/posts/bcd402f1.html</url>
      
        <content type="html"><![CDATA[<p><font color=white>[block]</font></p><span id="more"></span><ol><li>在<code>themes\yilia-plus\layout\_partial</code>中找到<code>article.ejs</code>，搜索date关键词，找到文章日期的代码，然后将代码中<code>date</code>改为<code>update</code>，然后将这段代码复制到你想显示的位置。</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;% if (!post.noupdated)&#123; %&gt;</span><br><span class="line">&lt;%- partial(&#x27;post/updated&#x27;, &#123;class_name: &#x27;archive-article-updated&#x27;, date_format: null&#125;) %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在<code>themes\yilia-plus\layout\_partial\post</code>中，新建<code>update.ejs</code>文件，输入如下代码</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;&lt;%- url_for(post.path) %&gt;&quot; class=&quot;&lt;%= class_name %&gt;&quot;&gt;</span><br><span class="line">&lt;time updatedtime=&quot;&lt;%= date_xml(post.updated) %&gt;&quot; itemprop=&quot;updatedPublished&quot;&gt;</span><br><span class="line">&lt;strong&gt;&lt;font color=black&gt;&lt;%= &quot;更新日期：&quot;%&gt;&lt;/strong&gt;&lt;%= date(post.updated, date_format) %&gt;&lt;/time&gt;</span><br><span class="line">&lt;/a&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>这样，就可以在底部声明添加文章更新日期。</li></ol><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>压电元件阻抗分析</title>
      <link href="/posts/37b07429.html"/>
      <url>/posts/37b07429.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>对压电元件进行阻抗分析，获得压电元件的阻抗特性</p></blockquote><h1 id="1-创建阻抗分析项目"><a href="#1-创建阻抗分析项目" class="headerlink" title="1.创建阻抗分析项目"></a>1.创建阻抗分析项目</h1><p>  打开workbench，在左侧分析系统找到“Harmonic Response”，即“谐响应模块”。建立谐响应分析。<br><img src="/posts/37b07429/1.png"></p><span id="more"></span><h1 id="2-首先定义所需的材料"><a href="#2-首先定义所需的材料" class="headerlink" title="2.首先定义所需的材料"></a>2.首先定义所需的材料</h1><p>  常见材料在ANSYS材料库中都有，如果没有需要的材料可以自定义。<br><img src="/posts/37b07429/2.png"></p><h1 id="3-模型导入"><a href="#3-模型导入" class="headerlink" title="3.模型导入"></a>3.模型导入</h1><p>  一般在其他三维软件中建立模型，导入进workbench中。<br><img src="/posts/37b07429/3.png"></p><h1 id="4-网格划分"><a href="#4-网格划分" class="headerlink" title="4.网格划分"></a>4.网格划分</h1><p>  主要方法为扫掠和自由划分，<br>  (1).</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 科学研究 </tag>
            
            <tag> ANSYS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0基础学习C语言</title>
      <link href="/posts/4b23d230.html"/>
      <url>/posts/4b23d230.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>《带你学C带你飞》</p></blockquote><span id="more"></span><p>scanf函数从标准缓冲区读取数据，在使用scanf函数输入字符时，需要清除缓冲区或在%c前添加一个空格，示例：<code>scanf(&quot; %c&quot;,&amp;name)</code>，否则函数读取到的是上一次输入后的回车。</p><p>引用math库时，在GCC编译时需要加<code>-lm</code>，示例<code>gcc name.c -lm</code>。</p><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><ol><li>在定义指针后，后续使用 *运算符得到的是指针指向对象的值。</li><li>scanf_s:使用时需要输入数组长度。（不输入不影响使用）<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scanf_s(<span class="string">&quot;%s&quot;</span>,name,1)；</span><br></pre></td></tr></table></figure></li></ol><ul><li>3.数组在使用printf指令打印时具有特殊性，因为输出字符串是通过读取字符串地址，即：输出字符串只需找到字符串的地址，不需要进行解引用。</li></ul><h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>基本条件：1. 调用函数自身。 2. 需要正确的结束条件。</p><h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><font color=white></font><h3 id="动态内存管理"><a href="#动态内存管理" class="headerlink" title="动态内存管理"></a>动态内存管理</h3><ol><li>malloc函数</li><li>free 函数<br>用于释放malloc、calloc、realloc函数申请的内存空间</li></ol><blockquote><p>内存泄漏:<br>1.申请的动态内存没有及时释放。<br>2.内存地址丢</p></blockquote><blockquote><p>memset: 初始化内存空间<br>memcpy: 复制内存</p></blockquote><ol start="3"><li>calloc<br>动态申请nmemb个长度为size的连续内存空间，并全部初始化为0.</li><li>realloc</li></ol><h3 id="C语言内存布局"><a href="#C语言内存布局" class="headerlink" title="C语言内存布局"></a>C语言内存布局</h3><p>代码段：</p><p>数据段：</p><p>BSS段：</p><p>堆：</p><p>栈： </p><blockquote><p>小甲鱼39节视频中最后一个问题：a和b都是由计算机分配的，存在于栈中，因此a位于高地址，b位于低地址，在强制转换后b为int类型，最大存储数据为255，因此存储258时，在数据达到256后，数据溢出到高位地址，即a的地址，本身为0的a在＋1后变为1，而溢出后b的值变为0，b又重新开始计数，因此258-266&#x3D;2.</p></blockquote><h3 id="宏定义"><a href="#宏定义" class="headerlink" title="宏定义"></a>宏定义</h3><h3 id="内联函数"><a href="#内联函数" class="headerlink" title="内联函数"></a>内联函数</h3><p>使用<code>inline</code>避免宏定义缺陷</p><p>预处理运算符：<code>#</code>（将符号后的内容装换成字符串）和<code>##</code>（记号连接运算符）。</p><h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>定义：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">struct Name</span><br><span class="line">&#123;</span><br><span class="line">结构体组成1；</span><br><span class="line">结构体组成2；</span><br><span class="line">结构体组成3；</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>声明：</p><p><code>char Name name</code></p><p>访问：</p><p><code>Name.title</code></p><p>内存对齐</p><h3 id="结构体数组和结构体指针"><a href="#结构体数组和结构体指针" class="headerlink" title="结构体数组和结构体指针"></a>结构体数组和结构体指针</h3><h3 id="单链表"><a href="#单链表" class="headerlink" title="单链表"></a>单链表</h3><p>头插法</p><p>尾插法</p><p>使用方法：利用静态指针指向单链表的尾部</p><h3 id="内存池"><a href="#内存池" class="headerlink" title="内存池"></a>内存池</h3><p>由于结构体使用的内存空间是一定的，因此小甲鱼的课程在从内存池申请空间时，没有声明变量大小。</p><h3 id="typedef"><a href="#typedef" class="headerlink" title="typedef"></a>typedef</h3><p>给数据类型起别名<br>对类型的封装</p><h3 id="共用体"><a href="#共用体" class="headerlink" title="共用体"></a>共用体</h3><p>union</p><p>初始化共用体：只能一次初始化一个成员。</p><h3 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h3><h4 id="声明枚举类型"><a href="#声明枚举类型" class="headerlink" title="声明枚举类型"></a>声明枚举类型</h4><p>enum 枚举类型名称 {枚举值名称,枚举值名称}；</p><h4 id="定义枚举变量"><a href="#定义枚举变量" class="headerlink" title="定义枚举变量"></a>定义枚举变量</h4><p>enum 枚举类型名称 枚举变量1,枚举变量2；</p><h3 id="位域"><a href="#位域" class="headerlink" title="位域"></a>位域</h3><h3 id="位操作和位运算"><a href="#位操作和位运算" class="headerlink" title="位操作和位运算"></a>位操作和位运算</h3><h4 id="逻辑位运算符："><a href="#逻辑位运算符：" class="headerlink" title="逻辑位运算符："></a>逻辑位运算符：</h4><p>~ 按位取反 将1变0、将0变1<br>&amp; 按位与<br>^ 按位异或 位不同为1，位相同为0<br>| 按位或 </p><p>&amp; ^ | 可以和赋值号（ &#x3D; ）结合</p><h4 id="移位运算符："><a href="#移位运算符：" class="headerlink" title="移位运算符："></a>移位运算符：</h4><p>左移位运算符 <code>&lt;&lt;</code><br>右移位运算符 <code>&gt;&gt;</code></p><h4 id="掩码"><a href="#掩码" class="headerlink" title="掩码"></a>掩码</h4><h3 id="打开和关闭文件"><a href="#打开和关闭文件" class="headerlink" title="打开和关闭文件"></a>打开和关闭文件</h3><p>输入 -&gt; 处理 -&gt; 输出</p><p>函数：<br>fopen<br>fclose</p><h3 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h3><p>####顺序读写</p><p>单个字符读取和写入<br>读取字符函数：fgetc、getc<br>写入字符函数：fputc、putc</p><p>整个字符串读写<br>函数：fgets、fputs</p><p>格式化读写文件<br>函数：fscanf（scanf form file）、fprintf（printf to file）</p><p>二进制读写文件<br>函数：fread、fwrite</p><h4 id="随机读写"><a href="#随机读写" class="headerlink" title="随机读写"></a>随机读写</h4><p>函数：ftell、rewind、fseek</p><h3 id="标准流"><a href="#标准流" class="headerlink" title="标准流"></a>标准流</h3><p>标准输入：stdin<br>标准输出：stdout<br>标准错误输出：stderr</p><p>错误指示器：ferror<br>清除末尾指示器和错误指示器：cleanerr<br>存储错误原因：errno<br>打印错误原因：perror<br>直接返回错误信息：strerror</p><h3 id="IO缓冲区"><a href="#IO缓冲区" class="headerlink" title="IO缓冲区"></a>IO缓冲区</h3><p>函数：setvbuf<br>指定缓存模式</p><p>块缓存：<br>行缓存：<br>不缓存：<br>fflush</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>声场与流场相互作用仿真</title>
      <link href="/posts/1a9f9e17.html"/>
      <url>/posts/1a9f9e17.html</url>
      
        <content type="html"><![CDATA[<p>简介：声学与流场产生的流体流动研究。</p><span id="more"></span><h2 id="思路一：二维截面"><a href="#思路一：二维截面" class="headerlink" title="思路一：二维截面"></a>思路一：二维截面</h2><p>官方程序： <a href="http://cn.comsol.com/model/acoustic-streaming-in-a-microchannel-cross-section-17087">[微通道横截面中的声流]</a></p><h3 id="主要方法"><a href="#主要方法" class="headerlink" title="主要方法"></a>主要方法</h3><p>温度（可选）、声学、流动、粒子追踪</p><h3 id="改动：在层流场中添加气体边界条件，增加入口速度和出口压力。"><a href="#改动：在层流场中添加气体边界条件，增加入口速度和出口压力。" class="headerlink" title="改动：在层流场中添加气体边界条件，增加入口速度和出口压力。"></a>改动：在层流场中添加气体边界条件，增加入口速度和出口压力。</h3><p>备注：<br>1.大部分情况下声场使用线弹性，远距离传播考虑热传导和粘性<br>2.流场利用声场产生的振速</p><h3 id="存在问题："><a href="#存在问题：" class="headerlink" title="存在问题："></a>存在问题：</h3><p>1.频域计算压力远大于实际产生的声压。<br>2.声压与气压是两个单独变量无法叠加。</p><h2 id="思路二：线性N-S方程"><a href="#思路二：线性N-S方程" class="headerlink" title="思路二：线性N-S方程"></a>思路二：线性N-S方程</h2><p>备注：<br>1.COMSOL中压力声学是一个无黏性无流动的简化模型。<br>2.一般假设声场不影响流动，流动影响声场</p><h2 id="压电微泵"><a href="#压电微泵" class="headerlink" title="压电微泵"></a>压电微泵</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 科学研究 </tag>
            
            <tag> COMSOL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试页面</title>
      <link href="/posts/4832c66c.html"/>
      <url>/posts/4832c66c.html</url>
      
        <content type="html"><![CDATA[<p>测试代码、记录效果</p><span id="more"></span><h3 id="2023年12月27日"><a href="#2023年12月27日" class="headerlink" title="2023年12月27日"></a>2023年12月27日</h3><h4 id="博客中插入链接"><a href="#博客中插入链接" class="headerlink" title="博客中插入链接"></a>博客中插入链接</h4><p><a href="http://www.baidu.com" title="Baidu" target="_blank" rel="noopener">Baidu</a></p><p><a href="http://www.baidu.com/">百度</a></p><h3 id="2023年10月29日"><a href="#2023年10月29日" class="headerlink" title="2023年10月29日"></a>2023年10月29日</h3><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--text--&gt;</span><br></pre></td></tr></table></figure><h3 id="2023年10月22日"><a href="#2023年10月22日" class="headerlink" title="2023年10月22日"></a>2023年10月22日</h3><h4 id="引入图片的两种方法"><a href="#引入图片的两种方法" class="headerlink" title="引入图片的两种方法"></a>引入图片的两种方法</h4><ol><li>简单快捷，但无法调整样式</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![图片描述](图片.png)</span><br></pre></td></tr></table></figure><ol start="2"><li>通过<code>&#123;%%&#125;</code>可以添加样式控制</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;width:50%;margin:auto&quot;&gt;</span><br><span class="line">&#123;% asset_img 图片名称.png %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><h3 id="2023年8月6日"><a href="#2023年8月6日" class="headerlink" title="2023年8月6日"></a>2023年8月6日</h3><h2 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h2><p>安装命令：npm install hexo-simple-mindmap</p><blockquote class="pullquote mindmap mindmap-md"><ul><li>思维导图<ul><li>Tab分级<ul><li>不能引入图片</li></ul></li></ul></li></ul></blockquote><h3 id="引用块"><a href="#引用块" class="headerlink" title="引用块"></a>引用块</h3><p>代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% blockquote %&#125;</span><br><span class="line">#### Warning Header</span><br><span class="line">Warning content</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure><p>效果：</p><blockquote><h4 id="Warning-Header"><a href="#Warning-Header" class="headerlink" title="Warning Header"></a>Warning Header</h4><p>Warning content</p></blockquote><p>也可以使用<code>&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; #### Warning Header</span><br><span class="line">&gt; Warning content</span><br></pre></td></tr></table></figure><p>效果:</p><blockquote><h4 id="Warning-Header"><a href="#Warning-Header" class="headerlink" title="Warning Header"></a>Warning Header</h4><p>Warning content</p></blockquote><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/4a17b156.html"/>
      <url>/posts/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><span id="more"></span><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
