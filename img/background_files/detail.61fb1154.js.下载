webpackJsonp([5],{12:function(t,e,a){"use strict";var n,i,o,s,r=a(6);(i=r)&&i.__esModule;s=function(){return{isInApp:function(){return this.isDuiTang()||this.isNaiYou()},isDuiTang:function(){return this.testUa(/(duitang)/gi)},isNaiYou:function(){return this.testUa(/(naiyoubz)/gi)},isWeiXin:function(){return this.testUa(/(micromessenger)/gi)},isQQ:function(){return this.testUa(/( qq)/gi)&&!this.testUa(/( qqbrowser)/gi)},isWeiBo:function(){return this.testUa(/(weibo)/gi)},testUa:function(t){var e=navigator.userAgent.toLowerCase();return!!t.test(e)},isMEIZU:function(){var t=navigator.userAgent.match(";s?([^;]+?)s?(Build)?/")[1];return!!/\b[M]\d{3}\b/.test(t)||!!/\b[M][X]\d{1}\b/.test(t)},getPhoneType:function(){var t=navigator.userAgent.toString().toLowerCase();return/iphone/gi.test(t)?"iphone":/ipad/gi.test(t)?"ipad":/android/gi.test(t)?"android":"other"},getAppVersion:function(t){var e=(t||navigator.userAgent).match(/duitang\/([^\s]+)/i);return e?e[1]:null},appVersionCompare:function(t,e){for(var a=t.split("."),n=e.split("."),i=0;i<a.length&&i<n.length;i++){var o=Number(a[i]),s=Number(n[i]);if(o>s)return 1;if(o<s)return-1}return a.length>n.length?1:a.length<n.length?-1:0},isIos:function(){return"iphone"===this.getPhoneType()||"ipad"===this.getPhoneType()},isAndroid:function(){return"android"===this.getPhoneType()},isWindowsPhone:function(){return/(?:Windows Phone)/.test(navigator.userAgent)},isSymbian:function(){return/(?:SymbianOS)/.test(navigator.userAgent)||this.isWindowsPhone()},isFireFox:function(){return/(?:Firefox)/.test(navigator.userAgent)},isChrome:function(){return/(?:Chrome|CriOS)/.test(navigator.userAgent)},isTablet:function(){var t=navigator.userAgent;return/(?:iPad|PlayBook)/.test(t)||this.isAndroid()&&!/(?:Mobile)/.test(t)||this.isFireFox()&&/(?:Tablet)/.test(t)},isPhone:function(){return/(?:iPhone)/.test(navigator.userAgent)&&!this.isTablet()},isPc:function(){return!this.isPhone()&&!this.isAndroid()&&!this.isSymbian()},sdkVersion:function(){var t,e=navigator.userAgent.toLowerCase(),a=/(jssdk)[ \/]([\w.]+)/.exec(e);return null===a?(t="0",parseFloat(t)):(t=a[2]||"0.1",parseFloat(t))}}},o=(o=void 0)||{},void 0===(n=function(){return o.DtPlatform=s()}.apply(e,[]))||(t.exports=n)},13:function(t,e,a){"use strict";a(0);!function(t){t.fn.confirm=function(e,a,n){"function"!=typeof e&&(n=a,a=e,e=t.noop),"string"!=typeof a&&(n=a,a="");var i=(n=t.extend({},n)).dir?1:-1,o=n.tipword||"",s=function(e,a){d.css({display:"block",overflow:"hidden"}),t(".PL-cfm-cont",d).stop().clearQueue().css({marginTop:i*e}).animate({marginTop:i*a},300,"linear",(function(){d.css("overflow","visible").css("display",a>e?"none":"block")}))},r=function(a){a.preventDefault();var n,r,l=t(this),c=l.offset(),p=l.outerWidth(),u=l.outerHeight(),m=t(document).width(),f=t(document).height(),h=t(window).scrollTop(),g=t(window).scrollLeft(),v=t(window).width(),b=t(window).height(),w=d.outerWidth(),y=d.outerHeight(),_=-1===i?c.top+u+12:c.top-y-12,C=c.left-w/2+p/2;n=f-y-12,_=_<12?12:_>n?n:_,n=m-w-12,C=C<12?12:C>n?n:C,n=_-12,r=C-12,t("html").animate({scrollTop:n<h||(n=_+12+y-b)>h?n:"+=0",scrollLeft:r<g||(r=C+12+w-v)>g?r:"+=0"},300),d.css({top:_,left:C}).data({this:this,event:a,fn:e}),t(".PL-cfm-wds",d).html(o),s(y,0)},d=t("#PL-confirm");if(!d.length){d=t('<div id="PL-confirm" class="PL-confirm"><div class="PL-cfm-cont"><div class="PL-cfm-wds tc">'+o+'</div><div class="PL-cfm-btns tc"><a class="abtn abtn-s PL-cfm-yes dib" href="javascript:;""><u>确定</u></a><a class="abtn abtn-s PL-cfm-no dib" target="_self" href="javascript:;"><u>取消</u></a></div></div></div>').appendTo("body");var l=function(){var t=d.outerHeight();s(0,t)};t(".PL-cfm-yes",d).click((function(t){t.preventDefault(),d.data("fn").call(d.data("this"),d.data("event"))})).click(l),t(".PL-cfm-no",d).click(l)}return a?this.delegate(a,"click",r):this.click(r),this}}(jQuery)},14:function(t,e,a){"use strict";$.G&&!$.G.reTop&&($.G.reTop=function(){var t,e=$(window),a=(e.width(),e.height(),$.browser),n=(a.msie&&a.version,a.webkit,$("#dt-side-combo"));if(!n.length){var i=$('<div style="width:0;height:0;position:relative;"></div>').prependTo("#content");n=$('<div id="dt-side-combo" style="float:left;position:relative;width:0;height:0;"><a id="dt-index-backtotop" class="dt-backtotop" href="javascript:;" style="position:absolute;left:1020px">回到顶部</a></div>').prependTo(i).sidepop({id:"dt-side-combo",dockSide:"right",width:44,height:44,scroll:1,departure:0,baseline:"bottom",bias:80,seat:!0,seatrange:function(){return $(document).height()-290},isFixed:!0,scrollDelayTime:100,zIndex:1e4,btnset:0})}$("#dt-index-backtotop").click((function(t){var e=$(this);t.preventDefault(),e.prop("disabled")||(e.prop("disabled",!0),$("body,html").animate({scrollTop:0},200,(function(){e.prop("disabled",!1)})))}));var o=function(a){clearTimeout(t),t=window.setTimeout((function(){e.scrollTop()>100?n.stop().css({display:"block"}).animate({opacity:1},300):n.stop().animate({opacity:0},300,(function(){n.css("display","none")})),a&&$({}).delay(300).queue((function(){n.removeClass("vh")}))}),100)};e.scroll(o),o(!0)},$((function(){$.G.reTop()})))},156:function(t,e,a){"use strict";a(0);!function(t){t.fn.turnlink=function(){return this.html((function(e,a){var n=[],i=[];(a=a.replace(/\[\[((?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[\w-\.\/%]*)\.(tiff|psd|gif|png|bmp|tga|png|jpg|jpeg|img)?)\]\]/gi,(function(e,a){return'<div class="turnlink-img"><img src="'+t.G.dtImageTrans(a,!0,600)+'" /></div>'}))).replace(/<a[^>]*>[^<]*<\/a>/gi,(function(t){var e=[];return e.length=t.length+1,e.join("*")})).replace(/<[^>]*>/gi,(function(t){var e=[];return e.length=t.length+1,e.join("*")})).replace(/(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[\w-\.\/%]*)?(?:[?][\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?(?:#[\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?/gi,(function(t,e){n.push({url:t,pos:e})}));var o=0;for(e=0;e<n.length;e++){var s=n[e].pos,r=n[e].url.length,d=n[e].url;i.push(a.substring(o,s)),i.push('<a href="'+d+'" target="_blank">'+d+"</a>"),o=s+r}return i.push(a.substring(o)),i.join("")})),this}}(jQuery)},23:function(t,e,a){"use strict";!function(t){var e={type:"",id:"",commentId:""};t.extend(t.fn,{feedback:function(a){var n=t.extend(e,a),i=t(this);if(i.length&&0!=n.id&&""!=n.id){var o,s=!!t.G.getUSERID(),r={article:window.location.protocol+"//"+window.location.host+"/article/?id="+n.id,articleComment:window.location.protocol+"//"+window.location.host+"/article/?id="+n.id+"&comment_id="+n.commentId,feed_video:window.location.protocol+"//"+window.location.host+"/p/feedvideo/?id="+n.id,feedVideoComment:window.location.protocol+"//"+window.location.host+"/p/feedvideo/?id="+n.id+"&comment_id="+n.commentId,atlas:window.location.protocol+"//"+window.location.host+"/atlas/?id="+n.id,atlasComment:window.location.protocol+"//"+window.location.host+"/atlas/?id="+n.id+"&comment_id="+n.commentId,blog:window.location.protocol+"//"+window.location.host+"/blog/?id="+n.id,blogComment:window.location.protocol+"//"+window.location.host+"/blog/?id="+n.id+"&comment_id="+n.commentId},d={article:204,feed_video:207,atlas:205,blog:201,articleComment:203,atlasComment:206,feedVideoComment:206,blogComment:206}[n.type],l=r[n.type],c="",p=function(e){var a=e.find(".submit"),i=e.find(".report-reason input");if(!a.hasClass("locked")){a.addClass("locked");var s={nickname:n.nickname,flag:d,msg:c,refer_url:l};t.ajax({url:"/napi/feedback/",type:"POST",data:s,success:function(e){1===e.status?(i.val(""),clearTimeout(o),o=setTimeout((function(){SUGAR.PopOut.alert('<div class="prompt prompt-success"><h3>举报成功</h3></div>')}),500),t({}).delay(1500).queue((function(){SUGAR.PopOut.closeMask()}))):(clearTimeout(o),o=setTimeout((function(){SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>举报失败 请稍候再试</h3></div>')}),500),t({}).delay(1500).queue((function(){SUGAR.PopOut.closeMask()})))}}).always((function(){a.removeClass("locked")}))}};return i.on("click",(function(){n.nickname=s?USER.username:"",function(e){if(0==t("#dt-report-dialog").length){t("#win-house").append('<div id="dt-report-dialog">\n            <div class="report-reason">\n              <i class="icon-select"></i>\n              <input type="text" name="reason" placeholder="选择举报原因">\n              <ul class="reason-list">\n                <li class="reason-item">抄袭/未授权转载</li>\n                <li class="reason-item">淫秽低俗不能忍！</li>\n                <li class="reason-item">广告！垃圾内容！</li>\n                <li class="reason-item">骂人是不对的！</li>\n                <li class="reason-item">其他</li>\n              </ul>\n            </div>\n            <div class="report-detail">\n              <textarea name="" id="" cols="52" rows="5" placeholder="填写理由..."></textarea>\n            </div>\n            <a class="submit" href="javascript:;">确定</a>\n          </div>'),e()}else e()}((function(){var e,a,n,i;e=t("#dt-report-dialog"),a=e.find(".report-reason"),n=e.find(".report-reason input"),i=e.find(".report-detail"),n.val(""),e.off("click"),e.find(".report-reason").removeClass("active"),e.on("click",".report-reason",(function(){t(this).hasClass("active")?t(this).removeClass("active"):t(this).addClass("active")})),e.on("click",".report-reason .reason-item",(function(e){e.stopPropagation(),e.preventDefault(),n.val(t(this).text()),a.removeClass("active"),"其他"==n.val()?i.show():i.hide()})),e.on("click",".submit",(function(){var t=i.find("textarea").val();""!=(c=""==t?n.val():t)&&(SUGAR.PopOut.closeMask(),p(e,n))})),SUGAR.PopOut.alert(["举报",t("#dt-report-dialog")],1)}))})),i}}})}($)},366:function(t,e,a){"use strict";var n,i=a(10),o=(n=i)&&n.__esModule?n:{default:n};var s=a(0),r=a(1);a(9),a(46),a(48),a(13),a(367),a(14),a(370),a(51),a(53);var d=a(371);a(50),a(15),a(228);var l=a(222),c=a(372),p=a(38),u=a(2),m=a(5),f=m.dtImageThumb,h=m.dtImageSquare,g=m.dtThumb;a(4),a(91),u.registerHelper("lessThanThree",(function(t,e){return t<=2?e.fn(this):e.inverse(this)})),u.registerHelper("ifCond",(function(t,e,a,n){switch(e){case"==":return t==a?n.fn(this):n.inverse(this);case"===":return t===a?n.fn(this):n.inverse(this);case"!=":return t!=a?n.fn(this):n.inverse(this);case"!==":return t!==a?n.fn(this):n.inverse(this);case"<":return t<a?n.fn(this):n.inverse(this);case"<=":return t<=a?n.fn(this):n.inverse(this);case">":return t>a?n.fn(this):n.inverse(this);case">=":return t>=a?n.fn(this):n.inverse(this);case"&&":return t&&a?n.fn(this):n.inverse(this);case"||":return t||a?n.fn(this):n.inverse(this);default:return n.inverse(this)}})),s((function(){var t,e=s(document),a=s(".center"),n=(s(window),s("#txa-cmt-reply")),i=s("#detailcnt"),m=(s(".htube-b-inner"),s(".pgreplydetail")),v=s(".relative-albums"),b=m.find(".reply-list"),w=!!s.G.getUSERID(),y=null,_=null,C=null,k=s("#blog-info-tmpl").html(),P=s("#blog-relative-tmpl").html(),x=s("#blog-comment-tmpl").html(),S=u.compile(k),I=u.compile(P),T=(u.compile(x),r.getParams().id);function R(t){if(t.short_video){var e=s("#pgdetail .de-img");e.css("width","588px").css("height","588px"),e.find(".showprev").height("calc(100% - 42px)").width("20%"),e.find(".shownext").height("calc(100% - 42px)").width("20%");var a=s("#pgdetail .img-out"),n=s("<div>").addClass("feedvideo-container");a.replaceWith(n),n.videoPc({src:t.photo.video.path,poster:f(t.photo.path,600),width:588,height:588,preload:"preload",loop:!0}),e.find(".vieworg").remove()}}s("#pgdetail .de-img").css("opacity",0);var U=s("#blog-status").data("status");U=parseInt(U);var j,G,E=[6,10,5].includes(U);if(!E){var D={blog_id:T,include_fields:"tags,related_albums,related_albums.covers,root_album,share_links_2,extra_links,icon_description,root_id"};s.ajax({url:"/napi/blog/detail/",type:"GET",data:D,mysuccess:function(e){s("#pgdetail .de-img").css("opacity",1),R(e.data),M(e.data.sender_id);var a=e.data,n=a.has_favorited,i=a.favorite_count,l=a.like_count,c=a.like_id,p=a.reply_count,u=a.favorite_blog_id,m=e.data.sender.id==USER.ID,f={id:e.data.id,rooter:e.data.root_blog_id,owner:e.data.sender_id},g={id:e.data.id,rooter:e.data.is_root,owner:e.data.sender_id,edit:!0,belongalbumid:e.data.album.id,belongalbumname:e.data.album.name,onlyedit:!1},b={has_favorited:n,favorite_count:i,like_count:l,like_id:c,reply_count:p,is_self:m,favorite_blog_id:u,object_id:T,pic:e.data.photo.path,title:e.data.msg,favoriteOpt:(0,o.default)(f),favoriteEdit:(0,o.default)(g)};if(d(s(".de-action"),b),e.data.album&&e.data.album.covers&&e.data.album.covers.length>0?e.data.album.cover=h(e.data.album.covers[0],100):e.data.album.cover="https://c-ssl.dtstatic.com/uploads/people/201208/13/20120813135111_xYFdP.png",e.data.hasRelated=!!(e.data.favorite_count>1&&e.data.related_albums),e.data.hasRelated){e.data.hasRelated=!0,e.data.favorite_count--;var w=void 0;s.each(e.data.related_albums,(function(t,a){a.covers&&a.covers.length>0?a.cover=h(a.covers[0],100):a.cover="https://c-ssl.dtstatic.com/uploads/people/201208/13/20120813135111_xYFdP.png",a.name.length>32&&(a.name=s.trim(a.name).substring(0,32).trim()+"..."),a.id!==e.data.album.id?a.unrootAlbum=!0:w=t})),e.data.related_albums.splice(w,1)}var y=I(e);v.append(y),function(e){var a=r.getParams().comment_id;s("#pg-bottom-comment").dtBottomComment({pageInfo:e,showBtn:s(".action-list .comment-action"),apiParamsForCommentList:{subject_id:e.id,subject_type:0},tmplBottomComment:s("#bottom-comment-tmpl").html(),dtCommentPc:s("#pg-comment-all")}),s("#pg-comment-all").dtCommentPc({pageInfo:e,setNavigation:!0,apiUrlForCommentList:"/napi/vienna/comment/list/",apiParamsForCommentList:{subject_id:e.id,subject_type:0},tmplCommentItem:s("#common-tmpl").html(),tmplCommentReply:s("#reply-tmpl").html(),tmplCommentLayout:s("#combox-tmpl").html(),hasHotComment:!0}),clearTimeout(t),a&&""!=a&&0!=a&&(t=window.setTimeout((function(){s("#pg-comment-all").trigger("dtCommentPc:receiveNotification",{name:"anchor_to_target_comment",data:{cid:a}})}),300))}({id:T,visit_count:12312,comment_count:123,sender:{avatar:e.data.sender.avatar,id:e.data.sender.id,is_certify_user:e.data.sender.is_certify_user,username:e.data.sender.username},user:{id:USER.ID,username:USER.username,avatar:USER.smallAvatar}}),C=O(e)}})}function F(t,e,a){var n={blog_id:t,include_fields:"tags,related_albums,related_albums.covers,root_album,share_links_2,extra_links,icon_description,root_id"};t&&s.ajax({url:"/napi/blog/detail/",type:"GET",data:n,mysuccess:function(t){t=O(t),"function"==typeof e&&e(t)},myfailure:a})}function O(t){t.data.photo.width>=588||t.data.photo.height>588?(t.data.photo.pWidth=588,t.data.photo.pHeight=t.data.photo.height/t.data.photo.width*588):(t.data.photo.pWidth=t.data.photo.width,t.data.photo.pHeight=t.data.photo.height),t.data.photo.OtherWidth=t.data.photo.pWidth+32,t.data.photo.path=g(t.data.photo.path,1e3,!1,!0),t.data.has_favorited>0&&(t.data.hasFavorited=!0),USER&&USER.ID===t.data.sender_id?t.data.userSelf=!0:t.data.userSelf=!1;var e,a,n,i,r={id:t.data.id,rooter:t.data.is_root,owner:t.data.sender_id,edit:!0,belongalbumid:t.data.album.id,belongalbumname:t.data.album.name,onlyedit:!1},d={id:t.data.id,rooter:t.data.root_blog_id,owner:t.data.sender_id},l={id:t.data.id,rooter:t.data.is_root,owner:t.data.sender_id,edit:!0,belongalbumid:t.data.album.id,belongalbumname:t.data.album.name,onlyedit:!0};if(t.data.favoriteEdit=(0,o.default)(r),t.data.favoriteOpt=(0,o.default)(d),t.data.favoriteEditOnly=(0,o.default)(l),t.data.source_title&&t.data.source_title.length>18&&(t.data.source_title=s.trim(t.data.source_title).substring(0,18).trim()+"..."),0!==t.data.buyable?(t.data.buyabled=!0,1==t.data.buyable||11==t.data.buyable||12==t.data.buyable||4==t.data.buyable||14==t.data.buyable?(t.data.buyableTao=!0,12===t.data.buyable&&(t.data.disabledbuy=!0),11!==t.databuyable&&14!==t.databuyable||(t.data.buyableMan=!0)):t.data.buyableTao=!1):t.data.buyabled=!1,t.data.links=(t.data.sender.username,e=t.data.msg,a=t.data.photo.path,n=t.data.id,(i={}).sina="http://service.weibo.com/share/share.php?appkey=1152390549&title="+encodeURIComponent(s.trim(e).substring(0,105).trim()+"...")+encodeURIComponent("...去堆糖查看更多图片→")+"&pic="+f(a,400)+"&url=http%3A//www.duitang.com/blog/"+encodeURIComponent("?id="+n),i.txweibo="http://share.v.t.qq.com/index.php?c=share&a=index&url=http%3A//www.duitang.com/blog/"+encodeURIComponent("?id="+n)+"&title="+encodeURIComponent(s.trim(e).substring(0,105).trim()+"...")+encodeURIComponent("...去堆糖查看更多图片>>>")+"&appkey=dad361aadb9948278afc268bd5617307&pic="+f(a,600),i.qzone="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http%3A//www.duitang.com/blog/"+encodeURIComponent("?id="+n)+"&title="+encodeURIComponent("堆糖－图片")+"&summary="+encodeURIComponent(s.trim(e).substring(0,50).trim()+"...")+encodeURIComponent("...去堆糖查看更多图片>>>")+"&pics="+f(a,600),i.renren="http://widget.renren.com/dialog/share?resourceUrl=http%3A%2F%2Fwww.duitang.com%2Fmblog%2F"+encodeURIComponent("?id="+n)+"&description="+encodeURIComponent(s.trim(e).substring(0,36).trim()+"...")+encodeURIComponent("...去堆糖查看更多图片>>>")+"&title="+encodeURIComponent("堆糖－图片")+"&pic="+f(a,600),i.douban="http://shuo.douban.com/!service/share?image="+f(a,600)+"&href=http%3A//www.duitang.com/blog/"+encodeURIComponent("?id="+n)+"&text="+encodeURIComponent(s.trim(e).substring(0,68).trim()+"...")+encodeURIComponent("...去堆糖查看更多图片>>>")+"&name="+encodeURIComponent("堆糖－图片"),i),t.data.tags.length>0){t.data.hasTag=!0;var c=t.data.buyable>0?"/blogs/item/":"/blogs/tag/?name=";s.each(t.data.tags,(function(t,e){e.tagLink=c+encodeURIComponent(e.name)}))}if(t.data.next_id>0&&(t.data.hasNextId=!0),t.data.prev_id>0&&(t.data.hasPrevId=!0),t.data.sender.avatar?t.data.sender.avatar=h(t.data.sender.avatar,100):t.data.sender.avatar=h("https://c-ssl.dtstatic.com/uploads/people/201401/15/20140115015227_xjyTc.png",100),t.data.sender.username&&t.data.sender.username.length>8&&(t.data.sender.username=s.trim(t.data.sender.username).substring(0,8).trim()+"..."),t.data.album&&t.data.album.covers&&t.data.album.covers.length>0?t.data.album.cover=h(t.data.album.covers[0],100):t.data.album.cover="https://c-ssl.dtstatic.com/uploads/people/201208/13/20120813135111_xYFdP.png",t.data.related_albums&&t.data.favorite_count>0){t.data.hasRelated=!0;var p=void 0;s.each(t.data.related_albums,(function(e,a){a.covers&&a.covers.length>0?a.cover=h(a.covers[0],100):a.cover="https://c-ssl.dtstatic.com/uploads/people/201208/13/20120813135111_xYFdP.png",a.name.length>32&&(a.name=s.trim(a.name).substring(0,32).trim()+"..."),a.id!==t.data.album.id?a.unrootAlbum=!0:p=e})),t.data.related_albums.splice(p,1)}t.data.extra_links&&t.data.extra_links.length>0&&(t.data.hasExtraLinks=!0,s(t.data.extra_links).each((function(t,e){e.image=h(e.image,100),e.title.length>21&&(e.title=s.trim(e.title).substring(0,21).trim()+"...")}))),A();var u={id:t.data.id,rooter:"",owner:t.data.senderId,likeid:t.data.likeId,type:1};t.data.favoriteConfig=(0,o.default)(u);var m={c:0,r:t.data.id,d:t.data.senderId,t:0,p:5,s:0,n:t.data.replyCount};return m.i=t.user?t.user.id:"",t.data.replycontConfig=(0,o.default)(m),t.data.root_blog_id||(t.data.root_blog_id=t.data.id),(USER&&USER.ID===t.data.senderId||!0===USER.ISSTAFF)&&(t.data.canEditTag=!0),t}function A(){USER&&USER.ISSTAFF&&!0===USER.ISSTAFF&&c.init()}function q(t){var e=S(t);i.find(".detailinfo").remove(),s(e).insertBefore(s(".relative-right-content"));var a=I(t);v.find(".allalbums").remove(),v.append(a);var n=t.data,o={has_favorited:n.has_favorited,favorite_count:n.favorite_count,like_count:n.like_count,like_id:n.like_id,reply_count:n.reply_count,is_self:t.data.sender.id==USER.ID,object_id:t.data.id,pic:t.data.photo.path,title:t.data.msg};M(t.data.sender.id),d(s(".de-action"),o);t.data.id,t.data.sender.avatar,t.data.sender.id,t.data.sender.is_certify_user,t.data.sender.username,USER.ID,USER.username,USER.smallAvatar;s("#form-mblogremovetag").find('[name="target_id"]').val(t.data.id),s("#contaddarea").find(".tag-form-content").remove(),s(".firstlev").prepend('<div class="tag-form-content"><form id="form-mblogaddtag" method="post" action="/napi/tag/add/" onsubmit="return false;"><div class="da tag-sel-cnt tag-use-cnt clr"><input id="mbaddtagipt" class="tag-edt-ipt" autocomplete="off" type="text" value="" maxlength="100" data-optional="true"></div><a class="abtn" href="javascript:;" style="position:absolute;bottom:20px;right:55px"><button type="submit"><u>添加</u></button></a><input type="hidden" class="tag-edt-id" name="target_id" value="" /><input type="hidden" name="tags" value="" /><input type="hidden" name="tags" value="" /><input type="hidden" name="target_type" value="0"><input type="hidden" name="type" value="1"></form><div class="tag-use-cnt tag-def-cnt da" id="mbaddtagsel"><a href="https://www.duitang.com/blogs/tag/?name=家居">家居</a><a href="http://www.duitang.com/blogs/tag/?name=设计">设计</a><a class="locked" href="https://www.duitang.com/blogs/tag/?name=插画">插画</a><a href="https://www.duitang.com/blogs/tag/?name=电影">电影</a><a href="https://www.duitang.com/blogs/tag/?name=旅行">旅行</a><a href="https://www.duitang.com/blogs/tag/?name=手工">手工</a><a href="https://www.duitang.com/blogs/tag/?name=女装">女装</a><a href="https://www.duitang.com/blogs/tag/?name=男装">男装</a><a href="https://www.duitang.com/blogs/tag/?name=配饰">配饰</a><a href="https://www.duitang.com/blogs/tag/?name=美食">美食</a><a href="https://www.duitang.com/blogs/tag/?name=摄影">摄影</a><a href="https://www.duitang.com/blogs/tag/?name=艺术">艺术</a><a href="https://www.duitang.com/blogs/tag/?name=封面">封面</a><a href="https://www.duitang.com/blogs/tag/?name=动漫">动漫</a><a href="https://www.duitang.com/blogs/tag/?name=怀旧">怀旧</a><a href="https://www.duitang.com/blogs/tag/?name=街拍">街拍</a><a href="https://www.duitang.com/blogs/tag/?name=人物">人物</a><a href="https://www.duitang.com/blogs/tag/?name=小孩">小孩</a><a href="https://www.duitang.com/blogs/tag/?name=宠物">宠物</a><a href="https://www.duitang.com/blogs/tag/?name=植物">植物</a><a href="https://www.duitang.com/blogs/tag/?name=人物">人物</a></div></div>'),t.data.tags.length>0&&s.each(t.data.tags,(function(t,e){s(".tag-sel-cnt").prepend('<a class="added-tag" href="javascript:;" data-tagid="'+e.id+'"><i>'+e.name+"</i></a>")})),s(".tag-edt-id").val(t.data.id),window.init_tag_flag=!1,H(),C=t,s("body,html").animate({scrollTop:0},0),R(t.data)}function M(t){t!==USER.ID?(s(".user-title .attention-status").show(),s.ajax({url:"/napi/people/profile/",type:"GET",data:{user_id:t},mysuccess:function(t){switch(t.data.relationship){case 0:break;case 1:case 3:s(".user-title .attention-status").addClass("isfollow").text("已关注")}}})):s(".user-title .attention-status").hide()}function H(){var t=s(".showprev"),e=s(".shownext");if(E)return t.remove(),void e.remove();var a=t.data("previd"),n=e.data("nextid");a&&y===C&&F(a,(function(t){_=t}),(function(e){4!=e.status||USER.ISSTAFF||t.remove()})),n&&_===C&&F(n,(function(t){y=t}),(function(t){4!=t.status||USER.ISSTAFF||e.remove()}))}window.init_tag_flag=!1,/ipad/gi.test(navigator.appVersion)&&(s("#header").before('<div style="margin:0 auto;"><a href="http://www.duitang.com/s/01b883e00e5da9aa2" target="_blank"><img src="https://c-ssl.dtstatic.com/uploads/people/201209/06/20120906133031_FZzrG.png" width="100%" height="160" style="display:block;"/></a><p style="width:48px;height:48px;position:absolute;top:0;right:0;background-color:#000;opacity:0.05;border-radius:24px;" id="banner-closer"></p></div>'),s("#banner-closer").click((function(t){s(this).closest("div").remove()}))),e.on("click",".user-title .attention-status",(function(){var t=s(this),e=s(".user-title").data("userid");w?t.hasClass("isfollow")?s.ajax({url:"/napi/people/unfollow/",type:"POST",data:{user_id:e},success:function(t){1===t.status&&s(".user-title .attention-status").removeClass("isfollow").text("关注")}}):s.ajax({url:"/napi/people/follow/",type:"POST",data:{user_id:e},success:function(t){1===t.status&&s(".user-title .attention-status").addClass("isfollow").text("已关注")}}):p.PopOut.login()})),e.on("click",".view-more",(function(t){var e=s(".allalbums");e.find(".view-more").hide(),e.find(".otheralbums li").removeClass("hide");var a=446+70*(e.find(".otheralbums li").length-3)-47+12;s(".allalbums").animate({height:a},100)})),e.on("click",".de-edit1",(function(t){USER.bindPhone?(window.init_tag_flag||(l(["#form-mblogaddtag","#form-mblogremovetag","#mbtagsrm","#mbaddtagsel","#mbaddtagipt",null,"/blogs/tag/"]),window.init_tag_flag=!0),p.PopOut.alert(["添加标签",s("#contaddarea")],2)):s.SGBindPhone.pop(window.location.href)})),e.on(".minealbums li","mousedown",(function(t){s(this);s.G.gaq("/_trc/Mblog/_/my_album")})),e.on(".otheralbums li","mousedown",(function(t){s(this);s.G.gaq("/_trc/Mblog/_/related_album")})),e.on("#txa-cmt-reply","mousedown",(function(t){s(this);s.G.gaq("/_trc/Mblog/_/firstcmt")})),s("#addnewtag").on("mousedown",(function(t){s.G.gaq("/_trc/Mblog/_/tag_edit")})),e.confirm((function(t){var e=s(this).data("confirm"),n=s(this).data("blogid"),i=a;n?s.ajax({url:e,type:"POST",data:{blog_id:n},mysuccess:function(t,e){var a="/people/?id="+s.G.getUSERID();i.find(".shownext").attr("href").indexOf("javascript")<0&&(a=i.find(".shownext").attr("href")),window.location.href=a}}):s.ajax({url:e,mysuccess:function(t,e){var a="/people/?id="+s.G.getUSERID();i.find(".shownext").attr("href").indexOf("javascript")<0&&(a=i.find(".shownext").attr("href")),window.location.href=a}})}),".js-delbtn",{tipword:"确定要删除？"}),e.on("mouseenter mouseleave",".de-img",(function(t){var e=s(".vieworg"),a=s(".shownext"),n=s(".showprev");"mouseenter"===t.type?(e.css("display","block"),a.addClass("active"),n.addClass("active")):(e.css("display","none"),a.removeClass("active"),n.removeClass("active"))})),j=s("#mbpho-img"),G=j.attr("src"),j.one("error",(function(t){s.G.gaq("/_trc/Mblog/_/picload_fail_1_"+G),s({}).delay(1e3).queue((function(){j.one("error",(function(){s.G.gaq("/_trc/Mblog/_/picload_fail_2_"+G),j.attr("src",G),j.one("error",(function(){s.G.gaq("/_trc/Mblog/_/picload_fail_3_"+G)}))})).attr("src",G)}))})),m.on("click",".reply-text",(function(t){t.preventDefault(),t.stopPropagation(),s(".reply-sub").slideDown({height:"60px"},"fast")})),m.on("click",".rrp-cancle",(function(t){t.preventDefault(),t.stopPropagation(),s(".reply-sub").slideUp({height:"27px"},"fast")})),history.pushState&&(e.on("click",".showprev",(function(t){t.preventDefault(),t.stopPropagation();var e=document.title,a=s(".showprev").attr("href"),n={title:e,url:a};(window.history.pushState(n,e,a),_)?(y=C,q(_)):F(s(this).data("previd"),(function(t){q(t)}))})),e.on("click",".shownext",(function(t){t.preventDefault(),t.stopPropagation(),s(".info-page-scroll-l").show();var e=document.title,a=s(".shownext").attr("href"),n={title:e,url:a};(window.history.pushState(n,e,a),y)?(_=C,q(y)):F(s(this).data("nextid"),(function(t){q(t)}))})),window.addEventListener("popstate",(function(){var t=window.history.state.url;getInfo(t,!1)}),!1),function(){b.length&&(b.Reply(),n.autogrow(),n.focus((function(){s.G.getUSERID()||p.PopOut.login()}))),s.fn.uploadpic&&s("#reply-addpic-btn").uploadpic((function(){}),{sel_holder:".reply-addpic",sel_form:".form-reply-uppic",sel_normal:".reply-normal",sel_error:".reply-uperror",sel_uploading:".reply-uploading",sel_uploaded:".reply-uploaded"}),s(".collection .act-o").SGfavorite(),s(".js-editbtn").SGfavorite({callback:function(t){t.content=t.content.replace(/\n/gi,"<br>").replace(/\s/gi,"&nbsp;"),s("#detailinfo").find("h1").html(t.content)}}),s(".smile .act-o").SGlike();var t=s("#detailcnt").find(".pg-evbanner").find("a"),e=(new Date).getTime();s(t[1]).on("mousedown",(function(a){t.css("visibility","hidden"),s.Store.set("evcTime",e),s.G.gaq("_trc/Mblog/_/activity_close")})),s(t[0]).on("mousedown",(function(t){s.G.gaq("_trc/Mblog/_/activity")})),function(){if(s.Store.get("evcTime")){var a=s.Store.get("evcTime");e-a>259200&&(t.css("visibility","visible"),s.Store.remove("evcTime"))}else t.css("visibility","visible")}(),H(),A()}())}))},367:function(t,e,a){"use strict";a(368),a(156),a(369);a(0);var n=a(43);!function(t){t.fn.Reply=function(e){e=t.extend({},{currentPage:1,prevPage:0,totalCount:0,nextCount:0,typeMessage:""},e);var a=t(this),i=t("#js-cmt-count"),o=a.data("config");function s(e){t.browser.msie&&e.closest(".reply-list").attr("class",(function(t,e){return e}))}function r(n){var i=t.G.store(),s=t("#page-"+e.currentPage);if(i.length||t("body").append('<div id="win-house" class="h0"></div>'),a.find(".cmt-list").wrapAll('<div id="page-'+e.prevPage+'"></div>'),i.append(t("#page-"+e.prevPage)),t("#js-reply-page").empty(),s.length)return a.prepend(s.children()),s.remove(),void a.replyPages({totalCount:e.totalCount,showPages:9,currentPage:e.currentPage,pageType:o.t,pageCount:o.p});a.addClass("loading"),p({url:"/napi/comment/list/",type:"GET",data:{start:(e.currentPage-1)*o.p,comment_message_id:o.r,limit:o.p},successFn:function(t){if(t=t.data){e.nextCount=t.next,e.totalCount=t.total,d(0,t.total);var i=function(t){for(var e="",a=0,n=t.length;a<n;a++)e+=l(t[a],"",0,a);return e}(t.object_list);a.prepend(i),o.p<t.total&&a.replyPages({totalCount:t.total,showPages:9,currentPage:e.currentPage,pageType:o.t,pageCount:o.p}),a.data("loaded",1),a.find(".G-turnlink").turnlink(),n&&"undefined"!=typeof fusion2&&fusion2.canvas&&fusion2.canvas.setHeight({height:0}),!n&&"undefined"!=typeof fusion2&&fusion2.canvas&&(fusion2.canvas.setScroll({top:20}),fusion2.canvas.setHeight({height:0}))}}})}function d(t,a){e.totalCount=a||e.totalCount+t,i.find("i").text(e.totalCount),e.totalCount?i.removeClass("dn"):1!==o.c&&3!==o.c||i.addClass("dn")}function l(a,n,i,s){var r,d=t.G.getUSERID()===a.fromUserId||t.G.isSTAFF()?'<a href="javascript:;" data-confirm="/napi/comment/delete/?comment_id='+a.id+'" class="r lkl mreplydelete">删除</a>':"",l=a.recipient?'<span>回复 </span><a class="ppname" href="/people/?id='+a.recipient.id+'">'+a.recipient.username+"</a><span>：</span>":"",c=t.G.dtImageTrans(a.sender.avatar,!0,100,100,"c"),p=2===o.c&&(r=e.totalCount-o.p*(e.currentPage-1)-s)>0?" | "+r+"楼":"";return['<div class="cmt-list ',n,'"><dl data-config=\'{"id":"',a.id,'","rid":"',a.sender.id,'"}\'><dt class="cmt-avatar"><a href="/people/?id=',a.sender.id,'"><img height="48" width="48" src="',c,'"></a></dt><dd><h3>',d,'<a class="ppname" href="/people/?id=',a.sender.id,'">',a.sender.username,"</a><i>",a.add_datetime,p,'</i></h3><div class="cmt-ctnt">',l,'<span class="G-turnlink">',a.content,'</span><a class="rreply lkl ml8" href="javascript:;">回复</a></div></dd></dl></div>'].join("")}function c(n,i){n.parent().find("a.uploadpic-delthepic").click(),a=t("#replycont-main"),d(1,0),e.totalCount<=1?i.hide().prependTo(a):1===o.s?a.find(".cmt-list:last").after(i.hide()):a.find(".cmt-list:first").length<1?i.hide().prependTo(a):a.find(".cmt-list:first").before(i.hide()),i.show("fast",(function(){if(s(i),1==o.c){var e=t.browser.webkit,a=t(e?"body":"html"),n=i.offset().top;a.animate({scrollTop:n-80},400)}})),i.find(".G-turnlink").turnlink(),window.setTimeout((function(){var e=a.data("callRepos");e&&t.isFunction(e)&&e()}),1e3)}function p(e){var n="Object"==typeof e.form?e.form:t(e.form),i=n.length,o="";if(t.G.getUSERID()||!i){if(i){if((o=n.find(".abtn")).hasClass("abtn-no"))return;o.addClass("abtn-no")}t.ajax({type:e.type,url:e.url,data:e.data,mysuccess:function(t,a){e.successFn(t)}}).always((function(){i&&(o.removeClass("abtn-no"),n.find("textarea").val("").css("height",42)),a.removeClass("loading")}))}else SUGAR.PopOut.login()}o.reply_type=parseInt(o.reply_type)||0,o.reply_ctype=parseInt(o.reply_ctype)||0,o.reply_pagenum=parseInt(o.reply_pagenum)||0,o.reply_sofa=parseInt(o.reply_sofa)||0,o.reply_count=parseInt(o.reply_count)||0,function(){if(o){switch(o.c){case 0:e.typeMessage="comment_message_id";break;case 1:e.typeMessage="comment_group_topic_id";break;case 2:e.typeMessage="comment_event_topic_id";break;case 3:e.typeMessage="comment_album_id"}r(1),n.setLabelIptFocus("#txa-cmt-reply","#txa-cmt-label");var i=t("#form-cmt-reply");i.delegate(".sub-cmt-reply","click",(function(a){t.G.getUSERID()?USER&&!USER.bindPhone?t.SGBindPhone.pop(window.location.href):function(a){var n=t.trim(a.find("textarea").val());if(""===n)return void alert("请输入内容！");var i=a.parent().find("a.uploadpic-thepic");i.length&&(n+="[["+i.attr("href")+"]]");var s={content:n,_type:o.c};s[e.typeMessage]=t("#replycont-main").data("config").r,p({form:a,url:a.getFormAction(),type:a.attr("method"),data:s,successFn:function(e){var n=l({id:e.data.id,fromUserId:t.G.getUSERID(),portrait:"undefined"!=typeof USER?USER.smallAvatar:"",fromUsername:"undefined"!=typeof USER?USER.username:"",daymsg:"刚刚",add_datetime:"刚刚",msg:e.data.content,sender:{id:t.G.getUSERID(),avatar:"undefined"!=typeof USER?USER.smallAvatar:"",username:"undefined"!=typeof USER?USER.username:""},content:e.data.content},"",1,0),i=t(n);c(a,i)}})}(i):SUGAR.PopOut.login()})),a.delegate(".rreply","click",(function(a){a.preventDefault(),a.stopPropagation(),t.G.getUSERID()?USER&&!USER.bindPhone?t.SGBindPhone.pop(window.location.href):function(a){var n=t(a),i=n.closest(".cmt-ctnt"),r=n.closest("dl"),d=n.closest(".cmt-list"),u=d.find(".ppname").eq(0).text(),m=r.data("config"),f=t('<div class="rrp-content '+(1==o.c?"reply-textpic":"")+' rrp-cont"><form method="post" action="/napi/comment/create/"><div class="reply-editcont"><textarea class="txa" name="content"></textarea></div><div class="rrp-tail clr"><a href="javascript:;" class="rrp-submit abtn l"><button type="button" ><u>回复</u></button></a><a class="rrp-cancle" href="javascript:;">取消</a></div><input type="hidden" name="_type" value=""></form>'+(1==o.c?'<div class="reply-addpic dn"><div class="reply-addpicin"><a class="abtn-up dib" href="javascript:;"><form class="form-reply-uppic" target="alupifr" enctype="multipart/form-data" method="POST" action="/upload/photo/"><input name="img" hidefocus="true" type="file" /><input type="hidden" name="tid" value=""/><input type="hidden" name="callback" value="$.fn.uploadpic.upPicCallBack"/><iframe name="alupifr" class="dn" scrolling="no" frameborder="0" height="0" width="0"></iframe><input type="hidden" name="type" value="reply"/></form></a><div class="reply-normal dib gray ml8 l20">可上传一张jpg、png、gif格式的图片，且图片小于2M</div><div class="reply-uploading dib loading3 dn"></div><div class="reply-uperror dib  ml8 l20 red dn"></div><div class="reply-uploaded dib  ml8 l20 dn"></div></div></div>':"")+"</div>"),h=f.hide().insertAfter(i).show("fast",(function(){s(i)}));f.find("[name=content]").focus(),t.fn.uploadpic&&f.find(".abtn-up").uploadpic((function(){}),{sel_holder:".reply-addpic",sel_form:".form-reply-uppic",sel_normal:".reply-normal",sel_error:".reply-uperror",sel_uploading:".reply-uploading",sel_uploaded:".reply-uploaded"});var g=h.find("form");d.find(".rreply").addClass("dn"),g.find(".rrp-submit").click((function(a){if(a.preventDefault(),a.stopPropagation(),t.G.getUSERID())if(!USER||USER.bindPhone){var n=t.trim(g.find("textarea").val());if(""!==n){var i=g.parent().find("a.uploadpic-thepic");i.length&&(n+="[["+i.attr("href")+"]]");var s={content:n,_type:o.c,parent_id:m.id};s[e.typeMessage]=o.r,p({form:g,url:g.getFormAction(),type:g.attr("method"),data:s,successFn:function(e){var a=l({id:e.data.id,fromUserId:t.G.getUSERID(),parentId:1,toUserId:m.rid,toUsername:u,portrait:"undefined"!=typeof USER?USER.smallAvatar:"",fromUsername:"undefined"!=typeof USER?USER.username:"",daymsg:"刚刚",add_datetime:"刚刚",msg:e.data.content,sender:{id:t.G.getUSERID(),avatar:"undefined"!=typeof USER?USER.smallAvatar:"",username:"undefined"!=typeof USER?USER.username:""},recipient:{id:m.rid,username:u},content:e.data.content},"",1,0),n=t(a);c(g,n)}})}else alert("请输入内容！")}else t.SGBindPhone.pop(window.location.href);else SUGAR.PopOut.login()}))}(this):SUGAR.PopOut.login()})),a.delegate(".rrp-cancle","click",(function(e){e.preventDefault(),e.stopPropagation();var a=t(this).closest(".cmt-list");a.find(".rrp-content").animate({height:0},"fast",(function(){t(this).remove(),s(a),a.find(".rreply").removeClass("dn")}))})),t("#js-reply-page").delegate("a","click",(function(a){var n;a.preventDefault(),a.stopPropagation(),t.G.scrollToAnchor("replytop",70),n=t(this),e.prevPage=e.currentPage,e.currentPage=n.data("page"),r(0)})),a.confirm((function(e){var a=t(this),n=a.data("confirm"),i=a.closest(".cmt-list");t.post(n,(function(){})),i.slideUp((function(){i.remove(),d(-1,0)}))}),"[data-confirm]",{tipword:"确定要删除？"})}}()}}(jQuery)},368:function(t,e,a){"use strict";var n=a(0);n.fn.replyPages=function(t){t=n.extend({},{showPages:9,currentPage:1,startPage:2,endPage:10,totalPages:0,totalCount:0,pageCount:20,pageType:0,pageContent:"#js-reply-page"},t);var e=n(this),a=function(){e.find(t.pageContent).empty().append(i()).removeClass("dn");var a=e.data("callRepos");a&&n.isFunction(a)&&a()},i=function(){var e,a='<ul class="dib">',n=(t.showPages-1)/2;if(t.currentPage-n<2?t.startPage=2:t.startPage=t.currentPage-n,t.currentPage+n>=t.totalPages?t.endPage=t.totalPages-1:t.endPage=t.currentPage+n,t.pageType&&(a+='<li class="pbrw gray">('+t.currentPage+"/"+t.totalPages+")</li>"),1!==t.currentPage&&(a+='<li class="prew"><a class="pre" data-page="'+(t.currentPage-1)+'" href="javascript:;">&nbsp;</a></li>'),t.pageType||(1!==t.currentPage?a+='<li><a href="javascript:;" data-page="1">1</a></li>':a+='<li class="cur">1</li>',t.startPage>2&&(a+='<li class="lt">...</li>')),!t.pageType)for(var i=0;i<t.endPage-t.startPage+1;i++){var o=t.startPage+i;(e=o)===t.currentPage?a+='<li class="cur">'+e+"</li>":a+='<li><a href="javascript:;" data-page="'+e+'">'+e+"</a></li>"}return t.pageType||(t.endPage<t.totalPages-1&&(a+='<li class="gt">...</li>'),t.currentPage!==t.totalPages?a+='<li><a href="javascript:;" data-page="'+t.totalPages+'">'+t.totalPages+"</a></li>":a+='<li class="cur">'+t.totalPages+"</li>"),t.currentPage!==t.totalPages&&(a+='<li class="next"><a class="nxt nxtw" data-page="'+(t.currentPage+1)+'" href="javascript:;">下一页</a></li>'),a+="</ul>"};t.totalPages=Math.ceil(t.totalCount/t.pageCount),a()}},369:function(t,e,a){"use strict";!function(t){t.fn.autogrow=function(e){return this.filter("textarea").each((function(){this.timeoutId=null;var e=t(this),a=e.height(),n=t("<div></div>").css({position:"absolute",wordWrap:"break-word",top:0,left:-9999,display:"none",width:e.width(),fontSize:e.css("fontSize"),fontFamily:e.css("fontFamily"),lineHeight:e.css("lineHeight")}).appendTo(document.body),i=function(){var i=this.value.replace(/</g,"<").replace(/>/g,">").replace(/&/g,"&").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,(function(t){return function(t,e){for(var a=0,n="";a<e;a++)n+=t;return n}("&nbsp;",t.length-1)+" "}));n.html(i),t(this).css("overflow","hidden").css("height",Math.max(n.height()+(parseInt(e.css("lineHeight"))||0),a))},o=function(){clearTimeout(this.timeoutId);var t=this;this.timeoutId=setTimeout((function(){i.apply(t)}),100)};t(this).change(i).keyup(o).keydown(o),i.apply(this)})),this}}(jQuery)},370:function(t,e,a){"use strict";var n=a(0);!function(t){t.fn.SGshare=function(){var e,a=this,n=(t(window),t(".album-share-list"));function i(t,a,n){"show"===n?(a.stop(),clearTimeout(e),t.addClass("cur"),a.css({display:"block"}),a.animate({width:184},150)):e=setTimeout((function(){a.stop(),a.animate({width:0},150,(function(){t.removeClass("cur"),a.hide()}))}),0)}t(document).on("mouseover mouseenter",this.selector,(function(){i(a,t(".album-share-list"),"show")})).on("mouseleave",this.selector,(function(){i(a,t(".album-share-list"))})),t(document).on("mouseover mouseenter",n.selector,(function(){clearTimeout(e)})).on("mouseleave",n.selector,(function(){i(a,t(".album-share-list"))}))}}(jQuery),n((function(){n(".album-share").SGshare()}))},371:function(t,e,a){"use strict";var n,i=a(39),o=(n=i)&&n.__esModule?n:{default:n};a(9),a(23);t.exports=function(t,e){var a="https://c-ssl.dtstatic.com/uploads/item/201804/23/20180423144103_3RcMy.png",n=e.object_id,i=e.title,s=e.pic,r=e.is_self,d=!!$.G.getUSERID(),l=t.find(".like-action"),c=t.find(".favorite-action"),p=t.find(".reply-action"),u=t.find(".more-action-list");r?c.hide():c.show(),e.like_id&&l.addClass("active").find("img").attr("src",a),e.like_count>0&&l.find("span").text(e.like_count),c.attr("data-favorite",e.favoriteOpt),e.has_favorited&&c.addClass("active re-done").attr("data-blogid",e.favorite_blog_id).find("img").attr("src","https://c-ssl.dtstatic.com/uploads/item/201804/23/20180423122004_sYcGR.png"),c.SGfavorite(),e.favorite_count>0&&c.find("span").text(e.favorite_count),e.reply_count>0&&p.find("span").text(e.reply_count);var m='<li class="edit"><a class="my-edit" href="javascript:;" data-favorite=\''+e.favoriteEdit+"'><i></i><p>编辑</p></a></li><li class=\"delete js-delbtn\" data-blogid='"+e.favorite_blog_id+'\'  data-confirm="/napi/blog/destroy/"><i></i><p>删除</p></li>',f='<ul>\n    <li class="share-weibo">\n    <a class="sina" href="http://service.weibo.com/share/share.php?appkey=1152390549&title='+i+"&pic="+s+"&url=http%3A//"+location.host+"/blog/%3Fid%3D"+e.object_id+'" title="分享到新浪微博" target="_blank" onmousedown="$.G.gaq(\'/_trc/Social/article/sina\');">\n    <i></i><p>分享至新浪微博</p>\n    </a>\n    </li>\n    <li class="share-qq">\n    <a class="qzone" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http%3A//'+location.host+"/blog/%3Fid%3D"+e.object_id+"&title="+i+"&pics="+s+"&summary="+i+'" title="分享到QQ空间" target="_blank" onmousedown="$.G.gaq(\'/_trc/Social/article/koukou\');">\n    <i></i><p>分享至QQ空间</p>\n    </a>\n    </li>\n    <li class="report">\n    <i></i><p>举报</p>\n    </li>\n    '+(r?m:"")+"\n    </ul>";$(".more-action-list").html(f),$(".more-action-list .my-edit").SGfavorite(),$(".more-action-list .report").feedback({type:"blog",id:n}),t.on("click",".favorite-action",(function(){c.hasClass("active")&&$.ajax({url:"/napi/blog/destroy/",method:"POST",cache:!1,data:{blog_id:c.attr("data-blogid")},mysuccess:function(){c.removeAttr("data-blogid").removeClass("active re-done").find("img").attr("src","https://c-ssl.dtstatic.com/uploads/item/201804/23/20180423141044_YizTc.png");var t=1==parseInt(c.find("span").text())?"收藏":parseInt(c.find("span").text())-1;console.log(c.find("span").text(),t),c.find("span").text(t)}})})),t.on("click",".like-action",(function(){if(d){var t=!l.hasClass("active");(function(t,e){var a={category:1,object_id:e},n=t?"/napi/like/":"/napi/unlike/";return new o.default((function(t,e){$.ajax({url:n,type:"POST",data:a,mysuccess:function(e){t(e)}})}))})(t,n).then((function(e){l.toggleClass("active");var n=t?a:"https://c-ssl.dtstatic.com/uploads/item/201804/23/20180423141044_kt5Rj.png";l.find("img").attr("src",n);var i=parseInt(l.find("span").text()),o=i?t?i+1:1==i?"赞":i-1:1;l.find("span").text(o)}))}else SUGAR.PopOut.login()}));var h=void 0;t.on("mouseenter",".more-action",(function(){clearTimeout(h),"none"==u.css("display")&&u.show().animate({height:r?230:140},100)})),t.on("mouseleave",".more-action",(function(){h=setTimeout((function(){u.hide().animate({height:0},100)}),200)})),u.on("mouseenter",(function(){clearTimeout(h)})),u.on("mouseleave",(function(){h=setTimeout((function(){u.hide().animate({height:0},100)}),200)}))}},372:function(t,e,a){"use strict";var n=a(0);a(13);var i=a(8),o={init:function(){n("#staff-tools").confirm((function(t){var e=n(this),a=n.trim(e.html()),i=e.data("confirm"),s=e.data("blogid");n.ajax({url:""+i,data:{ids:s},timeout:2e4,success:function(t){"可疑"===a?(n("#staff-tools").find(".blog-status").text("6-已可疑"),e.text("解可疑"),e.data("confirm","/operator/audit/manual/?type=0&status=0")):(n("#staff-tools").find(".blog-status").text("0"),e.text("可疑"),e.data("confirm","/operator/audit/manual/?type=0&status=10")),o.init()}})}),"a.mblogdoubt",{tipword:"确定要"+n("#staff-tools a.mblogdoubt").html()+"？"}),n("#staff-tools").confirm((function(t){var e=n(this),a=n.trim(e.html()),i=e.data("confirm"),s=e.data("blogid");n.ajax({url:""+i,data:{ids:s},timeout:2e4,success:function(t){"屏蔽"===a?(n("#staff-tools").find(".blog-status").text("6-已屏蔽"),e.text("解屏"),e.data("confirm","/operator/audit/manual/?type=0&status=0")):(n("#staff-tools").find(".blog-status").text("0"),e.text("屏蔽"),e.data("confirm","/operator/audit/manual/?type=0&status=6")),o.init()}})}),"a.mblogblack",{tipword:"确定要"+n("#staff-tools a.mblogblack").html()+"？"}),n("#staff-tools").confirm((function(t){var e=n(this),a=(e.html(),e.data("confirm"));n.post(a,(function(){var t=e.data("confirm");e.removeClass("mbloggood").addClass("mblogungood").html("去精").data("confirm",t.replace("?opt=on","?opt=off"))}))}),"a.mbloggood",{tipword:"确定要加精？"}),n("#staff-tools").confirm((function(t){var e=n(this),a=(e.html(),e.data("confirm"));n.post(a,(function(){var t=e.data("confirm");e.removeClass("mblogungood").addClass("mbloggood").html("精").data("confirm",t.replace("?opt=off","?opt=on"))}))}),"a.mblogungood",{tipword:"确定要取消加精？"}),n("#staff-createurl").click((function(t){t.preventDefault(),t.stopPropagation(),n("#staff-createurl").after('<input id="staff-taguse" class="r ipt" type="text" value="http://m.duitang.com/people/mblog/${data.id}/detail/?src=liangpin&spm=2014.12553688.710.0" onblur="$(this).delay(1000).remove()"/>'),n("#staff-taguse").select()})),n("#gettaobaocat").click((function(t){var e=n(this).data("blogid");n.ajax({type:"GET",url:"/taobao/category/item/query/",data:"blog_id="+e,timeout:2e4,success:function(t){var e=n.isPlainObject(t)?t:n.parseJSON(t);if(e&&e.success&&e.data){var a=e.data.category,o=e.data.parent_category;i.PopOut.alert('<div class="prompt"><p>类目：'+a.name+"["+a.id+"]</p><p>父类目："+o.name+"["+o.id+']</p><p><a href="/taobao/category/preview/" target="_blank">去后台看看</a></p></div>')}}})})),n("#getrating").click((function(t){t.preventDefault(),t.stopPropagation(),n.ajax({type:"GET",url:"/operate/rating/blog/get/",data:{bid:data.id},timeout:2e4,success:function(t){var e=n.isPlainObject(t)?t:n.parseJSON(t);if(e&&e.success&&e.data){var a=e.data.rating,o=e.data.rid;i.PopOut.alert('<div class="prompt"><p>分级：['+a+"]</p><p>Blog ID：["+o+']</p><p><a href="/operate/rating/blog/list/" target="_blank">去后台看看</a></p></div>')}}})}))}};t.exports=o},4:function(t,e,a){"use strict";var n=a(1),i=a(2),o=a(5).dtImageSquare,s=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;i.registerHelper("ifCond",(function(t,e,a,n){switch(e){case"==":return t==a?n.fn(this):n.inverse(this);case"===":return t===a?n.fn(this):n.inverse(this);case"<":return t<a?n.fn(this):n.inverse(this);case"<=":return t<=a?n.fn(this):n.inverse(this);case">":return t>a?n.fn(this):n.inverse(this);case">=":return t>=a?n.fn(this):n.inverse(this);case"!=":return t!=a?n.fn(this):n.inverse(this);case"&&":return t&&a?n.fn(this):n.inverse(this);case"||":return t||a?n.fn(this):n.inverse(this);default:return n.inverse(this)}})),i.registerHelper("math",(function(t,e,a,n){return{"+":(t=parseFloat(t))+(a=parseFloat(a)),"-":t-a,"*":t*a,"/":t/a,"%":t%a}[e]})),i.registerHelper("if",(function(t,e){return t?e.fn(this):e.inverse(this)})),i.registerHelper("duitang",(function(t){return"http://www.duitang.com/"+t})),i.registerHelper("timePattern",(function(t){var e=1e3*t-(new Date).getTime();if(e>0){var a=Math.floor(e/1e3/3600/24),n=Math.floor(e/1e3/3600-24*a);return a+"天"+n+"时"+Math.floor((e-1e3*(60*n*60-24*a*3600))/1e6/60)+"分"}})),i.registerHelper("promotionDone",(function(t,e){return 1e3*t-(new Date).getTime()<0||e?"done":""})),i.registerHelper("promotionUrl",(function(t,e,a){return 1e3*e-(new Date).getTime()<0||a?"javascript:;":"/shopping/temaihui/detail/"+t+"/?__urlopentype=pageweb"})),i.registerHelper("taobaoUrl",(function(t,e,a){return 1e3*e-(new Date).getTime()<0||a?"javascript:;":t})),i.registerHelper("truncate",(function(t,e){return $.trim(t).substring(0,e)})),i.registerHelper("pcjump",(function(t,e){var a=1e3*t-(new Date).getTime(),n=navigator.userAgent.toString().toLowerCase(),i=(n.match(/ipad/gi),!!n.match(/iphone/gi)),o=!!n.match(/android/gi);return a<0||e?"target=_self":i||o?"":"target=_blank"})),i.registerHelper("dtImageTrans",(function(t,e,a,i,o){var r,d=(l=(l=$.trim(t).replace(/^http(s)?:\/\//gi,"")).split("/"))[0],l=l[1];return-1==d.indexOf("duitang.com")||!l||"uploads"!=l&&"misc"!=l?t:(e?(a=a||0,i=i||0,o=o?"_"+o:"",r=n.dtImageTrans(t).replace(/(\.[a-z_]+)$/gi,".thumb."+a+"_"+i+o+"$1")):r=t.replace(/(?:\.thumb\.\w+|\.[a-z]+!\w+)(\.[a-z_]+)$/gi,"$1"),s||(r=r.replace(/_webp$/i,"")),r)})),i.registerHelper("dtImageSquare",(function(t,e){var a,n=(i=(i=$.trim(t).replace(/^http(s)?:\/\//gi,"")).split("/"))[0],i=i[1];return-1==n.indexOf("duitang.com")||!i||"uploads"!=i&&"misc"!=i?t:(a=o(t,e),s||(a=a.replace(/_webp$/i,"")),a)})),i.registerHelper("plus",(function(t,e){return t+e})),i.registerHelper("exist",(function(t,e){return t?e.fn(this):e.inverse(this)})),i.registerHelper("HbCut",(function(t,e){return n.cut(t,e)})),i.registerHelper("HbContent",(function(t,e){return n.trimLink(t)})),i.registerHelper("HbAddParam",(function(t,e,a){return n.addParam(t,e,a)})),i.registerHelper("HbAddParamOpenTypePageWeb",(function(t){return n.addParam(t,"__urlopentype","pageweb")})),i.registerHelper("HbInc",(function(t){return parseInt(t)+1})),i.registerHelper("htmlescape",(function(t){t=i.Utils.escapeExpression(t);var e=/(\n)/gi;return e.test(t)&&(t=t.replace(e,"<br>").replace(/\r/,"").replace(/\s/gi,"&nbsp;")),new i.SafeString(t)}))},50:function(t,e,a){"use strict";$((function(){if("tbexperience"!==DtTools.getParams().source){var t=$(".wrap-siderbar"),e=$(".main-list-content .right-content"),a=$(window),n=function(t,e){$(".app-download-guide.side").sidepop({id:"app-download-guide",width:t,height:e,dockSide:1,departure:"center",baseline:"top",bias:100,scroll:1,seat:!0,isFixed:!0,zIndex:101,btnset:0})};if(t.length>0){var i='<div class="app-download-guide side" style="padding: 0px 10px 10px 28px;">\n                      <img src="https://c-ssl.dtstatic.com/uploads/item/202010/10/20201010143456_jkKFZ.png" alt="" style="width: 336px;">\n                  </div>';t.append(i),n(336,280),a.resize((function(){$(".app-download-guide:not(.side,.top)").parent().remove(),$(".app-download-guide:not(.side,.top)").length>0||(t.append(i),n(336,280))}))}if(e.length>0){var o='<div class="app-download-guide side" style="display: flex;justify-content: center;align-items: center;">\n                      <img src="https://c-ssl.dtstatic.com/uploads/item/202010/10/20201010143456_jkKFZ.png" alt="" style="width: 200px;">\n                  </div>';e.append(o),n(200,200),a.resize((function(){$(".app-download-guide:not(.side,.top)").parent().remove(),$(".app-download-guide:not(.side,.top)").length>0||(e.append(o),n(200,200))}))}}}))},51:function(t,e,a){"use strict";a(0);var n=a(2);a(4);var i=a(1),o=a(12),s=a(22);window.DtTools=i,window.DtPlatform=o,window.DtPop=s,window.Handlebars=n,a(52)},52:function(t,e,a){"use strict";a(23),function(t){var e,a,n={setNavigation:!1,pageInfo:{show_more_comment:!1,max_reply_count:3},apiUrlForCommentList:"",apiParamsForCommentList:{},tmplCommentItem:"",tmplCommentReply:"",tmplCommentLayout:"",hasHotComment:!1},i=5,o={0:"blogComment",10:"articleComment",23:"atlasComment",26:"feedVideoComment"};t.extend(t.fn,{dtCommentPc:function(s){var r=t.extend(!0,n,s),d=this;if(d.length){var l=t(window),c=t(document),p=!0,u=0,m=Handlebars.compile(r.tmplCommentItem),f=Handlebars.compile(r.tmplCommentReply),h=Handlebars.compile(r.tmplCommentLayout);r.tmplCommentItem&&Handlebars.registerPartial("commentlist",r.tmplCommentItem),r.tmplCommentReply&&Handlebars.registerPartial("replylist",r.tmplCommentReply);l.height();return t.Event("dtCommentPc:receiveNotification",{bubbles:!1}),d.on("dtCommentPc:receiveNotification",(function(e,a){var n=a.name,i=a.data;switch(n){case"add_topic_comment":if(r.apiUrlForCommentList)i.replies=[],w(s={object_list:[i]},!0),y(d.find("ul li:first-child"));break;case"delete_topic_comment":(o=d.find("[data-cid="+i.id+"]")).hide((function(){o.remove(),b(d.find("ul li").length>0)}));break;case"add_topic_comment_reply":var o=d.find("[data-cid="+i.t_comment_id+"]"),s={page_info:r.pageInfo,replies:[i]},l=f(s);o.find(".reply-box-in").append(l),o.find(".reply-box").removeClass("cmt-dn");var c=Number(o.data("rcount"))||0;c++,o.data("rcount",c),o.find(".rcount em").text(c);break;case"delete_topic_comment_reply":(o=d.find("[data-cid="+i.t_comment_id+"]")).find("[data-rid="+i.id+"]").remove(),o.find(".cmt-r-item-answer").length<=0?o.find(".reply-box").addClass("cmt-dn"):o.find(".reply-box").removeClass("cmt-dn");c=Number(o.data("rcount"))||0;c--,o.data("rcount",c),o.find(".rcount em").text(c);break;case"anchor_to_target_comment":var p=i.cid;y(t('li.cmt[data-cid="'+p+'"]').eq(0))}})),d.on("click",".cmt-in-reply a",(function(e){if(_())if(USER.bindPhone){var a=t(this),n=a.closest("li"),i=a.closest(".cmt-r-item-answer"),o=i.find(".reply-input-in");o.length||((o=n.find(".comment-input-in").eq(0).clone(!1)).addClass("reply-input-in").find("textarea").val(""),i.append(o)),o.removeClass("cmt-dn"),a.closest(".cmt-in-reply").addClass("cmt-dn"),i.addClass("reply-active")}else t.SGBindPhone.pop(window.location.href);else SUGAR.PopOut.login()})),d.on("mouseenter mouseover",".cmt-reply-btn, .cmt-report-btn, .cmt-delete-btn",(function(a){var n=t(this);window.clearTimeout(e),n.closest(".cmt-r-item-pos").find(".cmt-report-btn").removeClass("cmt-dn")})),d.on("mouseleave",".cmt-reply-btn, .cmt-report-btn, .cmt-delete-btn",(function(a){var n=t(this);window.clearTimeout(e),e=window.setTimeout((function(){n.closest(".cmt-r-item-pos").find(".cmt-report-btn").addClass("cmt-dn")}),300)})),d.on("mouseenter",".cmt-r-item-pos",(function(e){var n=t(this),i=t(e.target).closest("li.cmt").data("sid");r.pageInfo.user&&r.pageInfo.user.id&&r.pageInfo.user.id==i&&(window.clearTimeout(a),n.find(".cmt-delete-btn").removeClass("cmt-dn"))})),d.on("mouseleave",".cmt-r-item-pos",(function(e){var n=t(this);window.clearTimeout(a),a=window.setTimeout((function(){n.find(".cmt-delete-btn").addClass("cmt-dn")}),200)})),d.on("mouseenter mouseover",".cmt-r-item-answer",(function(e){var a=t(this);if(!a.hasClass("reply-active"))a.find(".cmt-in-reply").removeClass("cmt-dn")})),d.on("mouseleave",".cmt-r-item-answer",(function(e){t(this).find(".cmt-in-reply").addClass("cmt-dn")})),d.on("click",".cmt-reply-btn",(function(e){if(_())if(USER&&USER.bindPhone){var a=t(this).closest("li.cmt");a.find(".comment-input-in").removeClass("cmt-dn");a.find(".reply-box").removeClass("cmt-dn")}else t.SGBindPhone.pop(window.location.href);else SUGAR.PopOut.login()})),d.on("click",".comment-send-cancel",(function(e){var a=t(this),n=a.closest("li.cmt"),i=a.closest(".comment-input-in");i.addClass("cmt-dn");n.find(".reply-box-in .cmt-r-item-answer:first-child").length||n.find(".reply-box").addClass("cmt-dn"),i.hasClass("reply-input-in")&&i.closest(".cmt-r-item-answer").removeClass("reply-active")})),d.on("click",".cmt-delete-btn",(function(e){v(t(this))})),d.on("click",".cmt-like",(function(e){e.preventDefault(),e.stopPropagation();var a=t(this);_()?function(e){var a=e.data("likeid");if(e.hasClass("locked"))return;e=t("[data-likeid="+a+"]");var n=Number(e.find("em").eq(0).text())||0,i=e.hasClass("active");i?(e.removeClass("active"),e.addClass("cancle")):(e.removeClass("cancle"),e.addClass("active"));e.addClass("locked"),i?e.find("em").text(n-1):e.find("em").text(n+1);var o={url:i?"/napi/vienna/comment/unlike/":"/napi/vienna/comment/like/",data:{comment_id:a}};t.ajax({url:o.url,type:"POST",data:o.data,xhrFields:{withCredentials:!0},error:function(t){console.error(t.responseJson.message)}}).always((function(){e.removeClass("locked")}))}(a):SUGAR.PopOut.login()})),d.on("click",".comment-send-btn",(function(e){e.preventDefault(),e.stopPropagation();var a=t(this);_()&&function(e,a){if(e.hasClass("locked"))return;var n=e.closest("li.cmt"),i=e.closest(".comment-input-in"),o=i.hasClass("reply-input-in"),s=a.val();if(""==s)return void DtPop.popupMsgThenClose("评论内容不能为空");var l,c={recipient:r.pageInfo.sender,add_datetime_str:"刚刚",photos:[],sender:r.pageInfo.user,content:s},p=n.data("cid");if(o){var u=e.closest(".cmt-r-item-answer");l=u.data("sid"),c.t_comment_id=p,c.recipient={id:l,username:u.data("sname")}}else l=n.data("sid"),c.t_comment_id=p,c.recipient={id:l,username:n.data("sname")};e.addClass("locked"),t.ajax({url:"/napi/vienna/comment/reply/",type:"POST",data:{t_comment_id:p,to_user_id:l,content:s},error:function(t){DtPop.popupMsgThenClose(t.responseJson.message)},success:function(t){1==t.status?(c.id=t.data,d.trigger("dtCommentPc:receiveNotification",{name:"add_topic_comment_reply",data:c}),i.addClass("cmt-dn"),a.val(""),y(n,!1)):DtPop.popupMsgThenClose(t.message)}}).always((function(){e.removeClass("locked")}))}(a,a.closest(".comment-input-in").find("textarea"))})),d.on("click",".cmt-r-item-find a",(function(e){e.preventDefault(),e.stopPropagation();var a=t(this),n=a.closest("li.cmt").data("cid");!function(e,a){if(e.hasClass("reply-loading"))return;var n=d.find("[data-cid="+a+"]"),i=n.data("sid");e.addClass("reply-loading"),t.ajax({url:"/napi/vienna/comment/reply/list/",type:"GET",data:{start:0,limit:100,comment_id:a},success:function(e){if(1===e.status){var a=e.data.object_list,o=t.extend(!0,r.pageInfo);o.max_reply_count=100;var s=f({comment_sender_id:i,page_info:o,replies:a});n.find(".reply-box-in").html(s)}}}).always((function(){e.removeClass("reply-loading")}))}(a,n),a.addClass("cmt-dn")})),d.on("click",".cmt-show-more-comment a",(function(e){e.preventDefault(),e.stopPropagation();var a=t(this);i=24,a.addClass("cmt-dn")})),r.apiUrlForCommentList&&(g(u,i),c.scroll((function(t){if(i>5){var e=parseFloat(l.height())+parseFloat(l.scrollTop());parseFloat(d.offset().top)+parseFloat(d.height())-l.height()<=e&&p&&g(u,i)}}))),d}function g(e,a){if(!d.find(".cmt-load-more").length){var n=a=a||24;n=t.extend(r.apiParamsForCommentList,{topic_id:r.pageInfo.id,start:e,limit:a});d.append('<div class="cmt-load-more">加载中</div>'),t.ajax({url:r.apiUrlForCommentList,type:"GET",data:n,success:function(a){if(d.removeClass("loading"),1===a.status){p=!!a.data.more,u=a.data.next_start;var n=a.data;if(0==e){for(var o=0,s=n.object_list,l=[],c=0;c<s.length;c++){var f=s[c];if("HOT"!==f.type){o=c;break}r.hasHotComment&&l.push(f)}r.hasHotComment&&l.length>0&&((n={object_list:l}).page_info=r.pageInfo,function(e){var a="";a=h(),d.append('<div class="cmt-hot-comment">'+a+"</div>"),d.find(".cmt-title span").text("热门评论"),a=m(e);var n=t(a);d.find(".cmt-hot-comment ul").append(n)}(n)),o>0&&(s.splice(0,o),n.object_list=s)}r.pageInfo.show_more_comment=i<=5&&p,n.page_info=r.pageInfo,w(n,!1)}}}).always((function(){d.find(".cmt-load-more").remove()}))}}function v(e){if(!e.hasClass("locked")){var a=e.closest("li.cmt"),n=a.data("cid");a=t("[data-cid="+n+"]"),e.addClass("locked"),t.ajax({url:"/napi/vienna/comment/delete/",type:"POST",data:{comment_id:n,owner_id:r.pageInfo.sender.id},error:function(t){DtPop.popupMsgThenClose(t.responseJson.message)},success:function(t){1==t.status&&d.trigger("dtCommentPc:receiveNotification",{name:"delete_topic_comment",data:{id:n}})}}).always((function(){e.removeClass("locked")}))}}function b(t){t?d.find(".cmt-zero").addClass("cmt-dn"):d.find(".cmt-zero").removeClass("cmt-dn")}function w(e,a){var n="",i=d.find(".cmt-normal-comment ul");if(a){n=m(e),(s=t(n).css({display:"none"})).find(".cmt-r-item-find").addClass("cmt-dn"),i.prepend(s),s.show()}else{n="",d.find(".cmt-normal-comment li").length<=0&&(n=h(),d.append('<div class="cmt-normal-comment">'+n+"</div>")),n=m(e);var s=t(n);(i=d.find(".cmt-normal-comment ul")).append(s)}var r=d.find("ul li").length>0;b(r),1==DtTools.getParams().is_comment&&r&&y(d),t("#pg-comment-all").find("li.cmt").each((function(e,a){var n=t(a),i=n.data("cid"),s=n.data("type"),r=n.data("subjectid");n.find(".cmt-report-btn").feedback({type:o[s],commentId:i,id:r})}))}function y(e,a,n){var i=e.offset().top;if(a){var o;o=l.height(),i+=e.outerHeight(!1)-o-2-0}!function(e,a){t("body,html").animate({scrollTop:e},200,(function(){a&&a()}))}(i-64,n)}function _(){return USER&&USER.ID}}})}($)},53:function(t,e,a){"use strict";a(0);var n=a(2);a(4);var i=a(1),o=a(12),s=a(22);window.DtTools=i,window.DtPlatform=o,window.DtPop=s,window.Handlebars=n,a(54)},54:function(t,e,a){"use strict";var n,i=a(5),o=a(57);(n=o)&&n.__esModule;!function(t){var e={pageInfo:{},apiParamsForCommentList:{},showBtn:"",tmplBottomComment:"",dtCommentPc:""};t.extend(t.fn,{dtBottomComment:function(a){var n=t.extend(e,a),o=t("#pg-bottom-comment"),s="",r="";if(this.length){t(window),t(document);var d=Handlebars.compile(n.tmplBottomComment);o.append(d);var l=t(".bottom-comment-photo .comment-photo-wrap"),c=o.find(".bottom-comment-content textarea");return n.showBtn.on("click",(function(){!t.G.getUSERID()?SUGAR.PopOut.login():USER.bindPhone?o.hasClass("hide")?u("show"):u():t.SGBindPhone.pop(window.location.href)})),o.on("click",".comment-submit",(function(){var e=t(this),a=c.val();if(""==a)return SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>评论不能为空哦</h3></div>'),void t({}).delay(2e3).queue((function(){SUGAR.PopOut.closeMask()}));var i={subject_id:n.apiParamsForCommentList.subject_id,subject_type:n.apiParamsForCommentList.subject_type,content:a,media_id:s,media_url:r,owner_id:n.pageInfo.sender.id};e.hasClass("locked")||(e.addClass("locked"),t.ajax({url:"/napi/vienna/comment/create/",type:"POST",data:i,success:function(t){1===t.status?(i.id=t.data,function(t){n.dtCommentPc.trigger("dtCommentPc:receiveNotification",{name:"add_topic_comment",data:{id:t.id,create_time_str:"刚刚",has_liked:0,like_count:0,photos:[{path:t.media_url}],reply_count:0,subject_id:n.apiParamsForCommentList.subject_id,subject_type:n.apiParamsForCommentList.subject_type,sender:n.pageInfo.user,content:t.content}})}(i),p()):DtPop.popupMsgThenClose(t.message)}}).always((function(){e.removeClass("locked")})))})),o.on("click",".comment-cancel",(function(){p()})),o.on("click",".comment-add-photo",(function(){t("input[id=choose-photo]").click()})),t("input[id=choose-photo]").change((function(e){!function(e){(0,i.uploadImage)(e,{type:"COMMENT"}).then((function(t){s=t.photo_id,r=(0,i.dtImageSquare)("https://c-ssl.dtstatic.com/"+t.key,200),l.find("img").attr("src",r),o.find(".comment-add-photo").hide(),l.show()})).catch((function(){SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>图片上传失败，请稍后再试</h3></div>'),t({}).delay(2e3).queue((function(){SUGAR.PopOut.closeMask()}))}))}(e.currentTarget.files[0])})),o.on("click",".photo-delete",(function(){m()})),o.on("click",".photo-edit",(function(){t("input[id=choose-photo]").click()})),this}function p(){c.val(""),m(),u()}function u(t){"show"===t?o.removeClass("hide").animate({height:152},200):(o.animate({height:0},200),setTimeout((function(){o.addClass("hide")}),200))}function m(){s="",r="",l.hide(),t("input[id=choose-photo]").val(""),o.find(".comment-add-photo").show()}}})}($)},9:function(t,e,a){"use strict";var n,i=a(6),o=(n=i)&&n.__esModule?n:{default:n};a(0).G=a(15),a(46);var s=a(43),r=a(38);!function(t){var e,a,n,i,d,l,c,p=!1,u=["收集","收集到","收集"];function m(t){r.PopOut.alert([null,a,""],2)}function f(){l.find("a.abtn").removeClass("abtn-no"),l.find(".s-sina").css({opacity:1,color:"#333"})}function h(t,e){d.find("input[name=album_id]").val(t).end().find("a,span").html(e)}function g(t,e){c.html(e).attr("class",t)}function v(){n.val(""),g("","")}function b(a,n){if(a){var i=t(e);if(i.addClass("re-done").attr("data-blogid",a).attr("title","去看我的收集"),n){var o=i.closest(".woo").find(".wooscr .d1 span"),s=parseInt(o.text())||0;s||o.text(s+1)}}}function w(e,m,w,y,_,C,k){if(a&&a.length)t.G.store(a);else{var P=function(t){s.keyupLenLimitForU(t.currentTarget,300,!0,!0)};a=t('<div id="re-favorite">\n      <form action="'+e+'" target="_self">\n        <div id="re-head">\n          <a id="re-close" target="_self" href="javascript:;" onclick="SUGAR.PopOut.closeMask();">关闭</a>\n          <h1>'+u[0]+'</h1>\n        </div>\n        <div id="re-cont" class="clr">\n          <div id="re-left" class="l"></div>\n          <div id="re-right" class="r">\n            <p>'+u[1]+'</p>\n            <div id="re-albumsel">\n              <input class="dn" type="text" data-optional="1" name="album_id">\n              <a id="re-albumtrig" href="javascript:;">默认专辑</a>\n              <span id="re-onlyeditwds"></span>\n            </div>\n            <textarea name="msg"'+("编辑"==u[0]&&(parseInt(w)||t.G.isSTAFF())?' class="txa" ':' class="txa txa-no"  readonly="true"')+' data-optional="1" ></textarea>\n            <div id="re-subpan" class="u-chk clr">\n              <a href="javascript:;" class="abtn l ">\n                <button type="submit"><u>'+u[2]+"</u></button>\n              </a>\n              "+(null!=("undefined"==typeof BIND_SITES?"undefined":(0,o.default)(BIND_SITES))&&BIND_SITES.sina?'<input id="re-sycn-sina" type="checkbox" value="1" class="chk s-sina" name="syncpost" /><label class="s-sina" title="同步到新浪微博" for="re-sycn-sina">同步</label><div class="re-mbsite s-sina">新浪</div>':"")+'\n              <div id="re-poststat"></div>\n            </div>\n          </div>\n        </div>\n        <input id="re-inp-parent" type="hidden" name="parent" value="" data-optional="1" />\n      </form>\n    </div>'),t.G.store(a);var x=t.G.getYearCookie("sync");t("#re-sycn-sina").prop("checked",-1!==x.indexOf("sina")).change((function(){var e=t(this),a=e.attr("value");x=x.replace(new RegExp(","+a,"ig"),""),e.prop("checked")||-1!==x.indexOf(a)?e.prop("checked")&&t.G.setYearCookie("sync",x+","+a):t.G.setYearCookie("sync",x)})),c=t("#re-poststat"),(d=a.find("#re-albumsel")).removeClass("re-onlyedit").find("a").myalbums({sel_valueipt:d.find("input[name=album_id]"),sel_holder:a}),i=t("#re-left").mousemove((function(e){if(e.stopPropagation(),!t.data(this,"movelock")){var a=t(this),n=(t.data(this,"imgProp")||{}).height;if(n>200){var o=(o=e.pageY-i.offset().top-50)<0?0:o;t.data(this,"movelock",!0),a.stop().animate({scrollTop:o*(n-200)*2/200},50,"linear",(function(){t.data(a[0],"movelock",!1)}))}}})),(n=a.find("textarea.txa")).keyup(P).blur(P).focus(P),s.keyupLenLimitForU(n[0],300,!0,!0),t.fn.at&&n.at({isFixed:!0}),l=a.find("form").safeSubmit((function(e){var a=t(this),i=n.val(),s=d.find("input").val(),c=t("#re-albumtrig").text(),h=a.find("a.abtn");h.find("[type=submit]");if(!h.hasClass("abtn-no")){l.find("a.abtn").addClass("abtn-no"),l.find(".s-sina").css({opacity:.5,color:"#aaa"}),g("re-inpost","正在提交，请稍候");var w=a.getFormAction(),y=a.serializeObject();"/napi/blog/forward/"===w&&(y.album=y.album_id,delete y.album_id),t.ajax({url:w,data:y,success:function(e){var a=t.isPlainObject(e)?e:t.parseJSON(e);if(a&&"object"==(void 0===a?"undefined":(0,o.default)(a)))if(a.data||(a.data={}),a.data.content=i,a.data.albumid=s,a.data.albumname=c,a.success||1===a.status){var n=d.find("[name=album_id]").val(),l=d.find("a").html();!p&&n&&"0"!=n&&(t.Bom.removeCookie("sgt"),console.log("set cookie","ai"+t.G.getUSERID(),n),t.Bom.setSubCookie("sgt","ai"+t.G.getUSERID(),n,{expires:30}),t.Bom.setSubCookie("sgt","an"+t.G.getUSERID(),l,{expires:30})),function(e,a,n){t.G.blinkIt((function(){g("re-postsuc",u[0]+"成功！")}),null,(function(){r.PopOut.closeMask(),t.isFunction(a)&&a(e,n),v()}),1,800),t(".favorite-action").addClass("active");var i=t(".favorite-action").find("span");t(".favorite-action").find("img").attr("src","https://c-ssl.dtstatic.com/uploads/item/201804/23/20180423122004_sYcGR.png"),1===i.length&&e.blog&&i.each((function(){var t=parseInt(i.html())||0;i.html(t+1)}))}(a.data,m,k),b(a.data&&a.data.blog&&a.data.blog.id,1)}else if(a.data&&a.data.robot_check);else{var h=t.trim(t.G.mergeServerMessage(a.message));g("re-posterr",h),f(),"你已经收集了该分享"==h?b():f(),t.G.gaq("/_trc/Error/ajax/response_"+h+"_forward")}else g("re-posterr","出现异常，可能是网络原因")},myerror:function(){g("re-posterr","网络原因导致失败，请稍候再试"),f()}}).always((function(){}))}}),(function(e){t.G.blinkIt((function(){n.css({backgroundColor:"#d7ebf7"})}),(function(){n.css({backgroundColor:"#fff"})}),(function(){n.focus()}),4,200)}))}(C?(d.addClass("re-onlyedit"),t("#re-subpan").find("input,label,div.re-mbsite").css("visibility","hidden")):(d.removeClass("re-onlyedit"),t("#re-subpan").find("input,label,div.re-mbsite").css("visibility","visible")),""!=y)?h(y=y||"",_=_||"默认专辑"):h(t.Bom.getSubCookie("sgt","ai"+t.G.getUSERID())||"",t.Bom.getSubCookie("sgt","an"+t.G.getUSERID())||"默认专辑");l.attr("action",e),a.find("h1").html(u[0]).end().find("#re-right p").eq(0).html(u[1]).end().find(".abtn u").html(u[2])}t.fn.SGfavorite=function(o){var s=(o=o||{}).etype||"click",d=o.callback;return t.G.getUSERID()<=0?(this.attr("title")||this.attr("title","登录才能进行操作哦，点击就可以登录啦"),t(document).on(s,this.selector,(function(t){t.stopPropagation(),t.preventDefault(),r.PopOut.login()}))):USER&&!USER.bindPhone?t(document).on(s,this.selector,(function(){t.SGBindPhone.pop(window.location.href)})):t(document).on(s,this.selector,(function(o){if(t(this).hasClass("re-done"))return!0;o.stopPropagation(),o.preventDefault();var s,r=t(this),l=(s=(s=r.data("favorite"))||r.closest(".collbtn").data("favorite"))?s.id:0,c=t.G.getUSERID(),h=s.owner,g=s.rooter;if(e=this,1!=s.edit||h!=c&&!t.G.isSTAFF()){if(h==c)return void alert("你收集过的，不能再收集哦~");if(g==c)return void alert("你第一次发布的，不能再收集哦~");r.parent().hasClass("collbtn")&&t.G.gaq("/_trc/Repost/waterfall/popstart"),function(e,o,s,r,d){p=!1,u=["收集","收集到","收集"],w("/napi/blog/forward/",d,s,"","","",e),a.css("display","block"),v(),f();var l,c=e.closest(".center"),h="";c.length?h=(l=c.find(".js-favorite-blogtit")).html().replace(/\<br\>/gi,"\n").replace(/&nbsp;/gi," "):(l=e.closest(".woo").find("div.g"),h=t("<div>"+l.html()+"</div>").find("a").remove().end().text()),n.val(t.trim(h)),t("#re-inp-parent").attr("name","parent").val(o),i.empty().scrollTop(0);var g,b,y=c.find(".js-favorite-blogimg");y.length?(g=y.data("width"),b=y.data("height")):(g=(y=e.closest("div.woo").find("div.mbpho img")).outerWidth(),b=parseInt(y.attr("height"))),g>200&&(b=200*b/g,g=200),t("<img />").attr("src",y.attr("src")).appendTo(i).css({width:g,height:b,marginTop:b<=200?(200-b)/2:0,cursor:b<=200?"default":"move"}),t.data(i[0],"imgProp",{height:b}),m()}(r,l,g,0,d)}else!function(e,o,s,r,d,l,c,h){p=h,u=["编辑","转移到","提交"],w("/napi/blog/edit/",d,s,l,c,h,e),a.css("display","block"),v(),f();var g,b=e.closest(".center"),y="";b.length?y=(g=b.find(".js-favorite-blogtit")).html().replace(/\<br\>/gi,"\n").replace(/&nbsp;/gi," "):(g=e.closest(".woo").find("div.g"),y=t("<div>"+g.html()+"</div>").find("a").remove().end().text()),n.val(t.trim(y)),t("#re-inp-parent").attr("name","blog_id").val(o),i.empty().scrollTop(0);var _=b.find("img.js-favorite-blogimg");if(_.length)var C=200*(C=_.data("height"))/_.data("width"),k=t("<img />").attr("src",_.attr("src")).appendTo(i);else{_=e.closest("div.woo").find("div.mbpho img");C=parseInt(_.attr("height")),k=t("<img />").attr("src",_.attr("src")).appendTo(i)}k.css({width:200,marginTop:C<200?(200-C)/2:0,cursor:C<=200?"default":"move"}),t.data(i[0],"imgProp",{height:C}),m()}(r,l,g,0,d,s.belongalbumid,s.belongalbumname,s.onlyedit)})),this},t.fn.SGdeleteComment=function(e){e=e||{};var a=this.selector+" .delete-comment";t.G.getUSERID()?t(document).on("click",a,(function(e){e.stopPropagation(),e.preventDefault();var a=t(this),n=a.closest(".comment-item"),i=a.closest(".woo"),o=i[0].className;!function(e,a,n,i){var o=a.data("commentid"),s=a.closest(".comment-wrap"),r=s.find(".blog-comment span i"),d=a.outerHeight(!0),l=parseInt(r.text());e.hasClass("locked")||(e.addClass("locked"),t.ajax({type:"POST",url:"/napi/comment/delete/",data:{comment_id:o},success:function(e){1===e.status&&(r.text(l-1<0?0:l-1),a.stop().clearQueue().animate({height:0,padding:0},200).queue((function(){a.remove(),s.find(".comment-item").length<1&&r.text()<1&&(s.addClass("dn"),d+=46),s.find(".comment-item").eq(0).addClass("first"),t.Woo.resetCol(-d,n,i)})))},always:function(){e.removeClass("locked")}}))}(a,n,t.G.getNum(o.match(/\bco\d+\b/gi).toString()),parseInt(i.css("top"))||0)})):(this.attr("title")||this.attr("title","登录之后才能删除评论哦！"),t(document).on("click",a,(function(t){t.stopPropagation(),t.preventDefault(),r.PopOut.login()})))},t.fn.SGcomment=function(e){function a(e,a,n,i,o,s,r){var d=o.find(".re-comt"),l=-104;o.find(".comment-item").length>0||(o.find(".comment-wrap").addClass("dn"),l=-118),d.stop().clearQueue().animate({height:0},200).queue((function(){t.Woo.resetCol(l,s,r),t.data(i[0],"comment",-1),d.find("textarea").blur(),d.addClass("dn")})),t.data(i[0],"comment",0)}e=e||{};return t.G.getUSERID()?t(document).on("click",this.selector,(function(e){e.stopPropagation(),e.preventDefault();var n=t(e.target).closest("a"),i=n.closest(".woo"),o=i.find(".f").last(),s=i.find("li").not(".re-comt").last(),r=(i.find(".wooscr .cancel-comment"),(r=n.closest(".collbtn").data("favorite"))||o.data("favorite"));if(!o.length&&r&&r.id)window.location.href="/blog/?id="+r.id+"#reply";else if(0!==(c=t.data(o[0],"comment"))){var d=r.id,l=(r.owner,t.data(t("#woo-holder")[0],"zindex")||10),c=!(null==c||c<0),p=i[0].className,u=t.G.getNum(p.match(/\bco\d+\b/gi).toString()),m=parseInt(i.css("top"))||0;i.css("zIndex",++l),t.data(t("#woo-holder")[0],"zindex",l),c?a(0,0,0,o,i,u,m):function(e,n,i,o,s,r,d,l){if(void 0===t.data(o[0],"comment")){var c=t('<li class="re-comt"><span>评论</span><form action="/napi/comment/create/"><div class="pb8"><textarea class="txa" name="content" placeholder="说些什么吧..."></textarea><a class="submit-comment" href="#">发送</a><a class="cancel-comment" href="javascript:;">取消</a></div><input type="hidden" name="_type" value=""/><input type="hidden" value="'+n+'" name="comment_message_id"></form></li>');s.after(c),t.fn.at&&c.find("textarea").at({pageMembers:r.find("li p a:first-child")}),c.find("a.submit-comment").click((function(e){e.stopPropagation(),e.preventDefault();var a=t(this),n=a.closest("form"),i=n.find("textarea");t.trim(i.val())?a.hasClass("abtn-no")||(a.addClass("abtn-no"),t.ajax({url:"/napi/comment/create/",data:n.paramForm(),mysuccess:function(e,a){var n=t(".dt-avatar").attr("src"),s=t(['<li class="comment-item" data-commentid="'+e.data.id+'"><span class="delete-comment">删除</span><a href="/myhome/" target="_blank"><img src="',n,'" width="28" height="28"></a><p><a href="/myhome/" target="_blank">我</a><br/><span class="content">',e.data.content.replace(/<br\s*\/?>/i," ").replace(/@[\u2E80-\u9FFF\d\w]{1,20}/gi,""),"</span></p></li>"].join(""));c.before(s.css("display","none")),i.val("");var p=r.find(".comment-wrap"),u=r.find(".blog-comment"),m=u.find("i"),h=parseInt(m.text())||0;p.removeClass("dn"),u.removeClass("dn"),m.text(++h),r.find(".comment-item").eq(0).css("border","none").data("commentid",e.data.id),r.find(".re-comt").css("border-top","1px solid #e0e0e0"),s.slideDown(200,(function(){var e=1==r.find(".comment-item").length?u.outerHeight(!0):0;t.Woo.resetCol(s.outerHeight(!0)+e,d,l),f.stop().clearQueue().animate({height:0},200).queue((function(){t.Woo.resetCol(-104,d,l),t.data(o[0],"comment",-1),f.find("textarea").blur(),f.addClass("dn")}))}))},myerror:function(){this.errormsg()}}).always((function(){a.removeClass("abtn-no")}))):alert("请输入内容！")}))}var p=t(window),u=p.height(),m=p.scrollTop(),f=r.find(".re-comt"),h=f.offset().top+104-(u+m),g=104;if(h>0){var v=t.browser.webkit;t(v?"body":"html").animate({scrollTop:"+="+h},400,(function(){}))}g=r.find(".comment-item").length>0?104:118,r.find(".comment-wrap").removeClass("dn"),f.removeClass("dn"),r.find(".comment-item").length>0?f.css("border-top","1px solid #e0e0e0"):f.css("border-top","none"),f.stop().clearQueue().animate({height:104},200).queue((function(){t.Woo.resetCol(g,d,l),t.data(o[0],"comment",1),f.find("textarea").focus()})),t.data(o[0],"comment",0),f.find(".cancel-comment").off("click").on("click",(function(e){a(t(e.target),0,0,o,r,d,l)}))}(0,d,0,o,s,i,u,m)}})):(this.attr("title","登录才能评论，点击下就可以登录啦"),t(document).on("click",this.selector,(function(t){t.stopPropagation(),t.preventDefault(),r.PopOut.login()}))),this},t.fn.SGlike=function(e){e=e||{};t.G.getUSERID()?t(document).on("click",this.selector,(function(e){e.stopPropagation(),e.preventDefault();var a,n=t(this),i=(a=(a=n.data("favorite"))||n.closest(".collbtn").data("favorite")).id,o=(a.owner,a.likeid),s=a.type;n.hasClass("re-zan")?function(e,a){e.hasClass("no-sub")||(e.data("like")&&(a=e.data("like").likeid),a&&(e.addClass("no-sub"),t.ajax({url:"/napi/unlike/",data:"like_id="+a,mysuccess:function(a,n){e.removeClass("re-zan");var i=e.closest(".woo"),o=i.find(".d2"),s=i.find(".d2 span"),r=e.closest(".action").find("em"),d=(e.parent(".d"),i.find(".mbpho .icon-like")),l=s.html(),c=0,p=i[0].className;t.G.getNum(p.match(/\bco\d+\b/gi).toString()),parseInt(i.css("top"));((c=parseInt(l)>1?parseInt(l)-1:0)?s.html(c):s.html(c)&&o.addClass("dn"))&&e.removeClass("z-done").text("点赞"),d.removeClass("active"),r.length&&r.each((function(){t(this).html(parseInt(r.html())-1<0?0:parseInt(r.html())-1)}))},myerror:function(){this.errormsg()}}).always((function(){e.removeClass("no-sub")}))))}(n,o):function(e,a,n){e.hasClass("no-sub")||(e.addClass("no-sub"),n=n||1,t.ajax({url:"/napi/like/",data:"object_id="+a+"&category="+n,mysuccess:function(a,n){e.addClass("re-zan");var i=e.closest(".woo"),o=i.find(".d2"),s=i.find(".d2 span"),r=e.closest(".action").find("em"),d=o.parent(".d"),l=i.find(".mbpho .icon-like"),c=s.html(),p=0,u=i[0].className,m=t.G.getNum(u.match(/\bco\d+\b/gi).toString()),f=parseInt(i.css("top"))||0;e.data("like")?e.data("like").likeid=a.data.liked_id:e.data("like",{likeid:a.data.liked_id+""}),p=c?parseInt(c)+1:1,o.length&&s.html(p)&&o.removeClass("dn")&&e.addClass("z-done").text("已赞"),l.addClass("active"),d.hasClass("dn")&&(d.removeClass("dn"),t.Woo.resetCol(24,m,f)),r.length&&r.each((function(){t(this).html(parseInt(r.html())+1)}))},myerror:function(){this.errormsg()}}).always((function(){e.removeClass("no-sub")})))}(n,i,s)})):(this.attr("title")||this.attr("title","登录之后才能赞哦！"),t(document).on("click",this.selector,(function(t){t.stopPropagation(),t.preventDefault(),r.PopOut.login()})))}}(jQuery)},91:function(t,e,a){"use strict";!function(t){t.fn.videoPc=function(e){t.extend(m,e);var a,n,i,o,s,r,d,l,c=this,p=(t(window),navigator.userAgent.toLowerCase()),u=(p.indexOf("iphone")>-1||p.indexOf("ipad"),!1),m={src:null,poster:null,width:750,height:750,preload:"none",autoplay:"",loop:"",isPosterShow:!0,isPosterFull:!1,isFullscreenOpen:!1,onFullscreenChange:null,onEnded:null,onClickPlay:null,onStartPlay:null,onResizeVideo:null,bgm:null,bgmVolume:0,nodownload:!0},f=t.extend(m,e);function h(t,e){if("string"==typeof t&&t.indexOf(":")>-1){for(var a=t.split(":"),n=0;n<a.length;n++)a[n]=Math.floor(a[n])||0,n>0&&a[n]<10&&(a[n]="0"+a[n]);return a.join(":")}var i=parseInt(t)||0;if(!e&&i>=3600){var o,s,r=Math.floor(i/3600),d=i%3600;return(o=Math.floor(d/60))<10&&(o="0"+o),(s=d%60)<10&&(s="0"+s),r+":"+o+":"+s}return(o=Math.floor(i/60))<10&&(o="0"+o),(s=i%60)<10&&(s="0"+s),o+":"+s}return console.log("newOpts",f),{init:function(t){this.renderVideo(t),o=c.find("video"),(s=o.get(0)).controls=!1,this.initBtns()},renderVideo:function(t){if(t.src){var e='<video style="'+(t.width?"width:"+t.width+"px":"")+";"+(t.height?"height:"+t.height+"px":"")+'" '+(t.isFullscreenOpen?"":'webkit-playsinline="false" playsinline="false"')+" \n                    "+(t.loop?"loop":"")+" "+(t.autoplay?"autoplay":"")+" preload="+t.preload+" src="+t.src+" poster="+t.poster+" "+(t.nodownload?'controlsList="nodownload"':"")+"></video>",a='<div class="controller"><div class="toolbar"><span class="ctime">00:00</span><div class="bar-container"><div class="proc-bar"><em class="hasloads"></em><div class="current"><span class="vernier"></span></div></div></div><span class="ttime">'+(t.duration||"00:00")+'</span><span class="volume"></span><span class="fullscreen"></span></div></div>';if(c.append(e+'<div class="status"><div class="play"><span></span></div><div class="loading"><span></span></div><div class="pause"><span></span></div><div class="replay"><span></span></div></div>'+a),!t.duration&&t.preload){var n=c.find("video")[0];n.addEventListener("loadedmetadata",(function(){var t=Math.floor(n.duration);c.find(".ttime").text(h(t))}))}}else c.append("没有内容").css("background-color","#fff")},initBtns:function(){a=c.find(".status"),c.find(".toolbar"),n=c.find(".bar-container"),i=c.find(".current"),r=c.find(".vernier"),l=c.find(".volume"),d=c.find(".fullscreen");var e=a.find(".play"),p=a.find(".pause"),m=a.find(".replay"),f=n.width(),g=0;a.on("click",(function(t){console.log("videoElement",s.paused),1==s.paused?s.play():s.pause()})),o.on("play",(function(){m.hide(),a.removeClass("paused"),e.show(),setTimeout((function(){a.addClass("now-playing"),setTimeout((function(){e.hide()}),400)}),0)})),o.on("ended",(function(){m.show()})),o.on("pause",(function(t){a.removeClass("now-playing"),p.show(),setTimeout((function(){a.addClass("paused"),setTimeout((function(){p.hide()}),400)}),0)})),o.on("seeking",(function(t){})),n.on("click",(function(t){t.stopPropagation();var e=n.offset().left;t.clientX>e&&t.clientX<e+f&&(s.currentTime=(t.clientX-e)/f*s.duration,s.currentTime<=s.duration&&i.css({width:s.currentTime/s.duration*100+"%"}),s.play())})),l.on("click",(function(t){t.preventDefault(),t.stopPropagation(),s.muted=!s.muted,l.toggleClass("mute")})),d.on("click",(function(t){var e;(e=s).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.oRequestFullscreen?e.oRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullScreen()})),o.on("timeupdate",(function(){var t=h(Math.floor(s.currentTime));c.find(".ctime").text(t);var e=s.currentTime/s.duration*100;i.css({width:e+"%"})})),r.on("mousedown",(function(e){u=!0,g=e.clientX,s.pause(),t("body").on("mouseup",(function(){t("body").off("mousemove").off("mouseup").off("mousedown"),!0===s.paused&&s.play(),u=!1})),t("body").on("mousemove",(function(t){!1!==u&&(t.clientX-g<f&&(s.currentTime=s.currentTime+(t.clientX-g)/f*s.duration,s.currentTime<=s.duration&&i.css({width:s.currentTime/s.duration*100+"%"})),g=t.clientX)}))})),t("body").on("keydown",(function(t){32===t.keyCode&&(t.preventDefault(),t.stopPropagation(),1==s.paused?s.play():s.pause())}))}}.init(f),this}}(a(0))}},[366]);